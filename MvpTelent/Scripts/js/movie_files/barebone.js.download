/* VimeoPlayer - v3.20.13 - 2020-06-17 - https://player.vimeo.com/NOTICE.txt */
!function(t){"use strict";if(function(){for(var t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n){var i=t[n];window.requestAnimationFrame=window[i+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i+"CancelAnimationFrame"]||window[i+"CancelRequestAnimationFrame"]}!/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)&&window.requestAnimationFrame&&window.cancelAnimationFrame||(window.requestAnimationFrame=function(t){return setTimeout(t,0)},window.cancelAnimationFrame=clearTimeout)}(),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),"undefined"!=typeof DOMTokenList&&!function(){var t=document.createElement("div");return t.classList.toggle("test-class",!1),!t.classList.contains("test-class")}()){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,i){!0!==i?!1!==i?n.call(this,t):this.remove(t):this.add(t)}}"function"!=typeof Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1;i<arguments.length;i++){var e=arguments[i];if(null!=e)for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r])}return n}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){for(var n=Object(this),i=n.length>>>0,e=arguments[1],r=0;r<i;){var o=n[r];if(t.call(e,o,r,n))return o;r++}}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){for(var n=Object(this),i=n.length>>>0,e=arguments[1],r=0;r<i;){var o=n[r];if(t.call(e,o,r,n))return r;r++}return-1}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,n){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),e=i.length>>>0;if(0===e)return!1;var r=0|n,o=Math.max(r>=0?r:e-Math.abs(r),0);function u(t,n){return t===n||"number"==typeof t&&"number"==typeof n&&isNaN(t)&&isNaN(n)}for(;o<e;){if(u(i[o],t))return!0;o++}return!1}}),String.prototype.includes||(String.prototype.includes=function(t,n){return"number"!=typeof n&&(n=0),!(n+t.length>this.length)&&-1!==this.indexOf(t,n)}),Object.values||(Object.values=function(t){return Object.keys(t).map((function(n){return t[n]}))});var i={MANIFEST:"manifest",SEGMENT:"segment"},e={method:"GET",async:!0,retry:0,throwHttpErrors:!0,headers:{},hooks:{beforeRequest:[],beforeRetry:[],afterResponse:[]},validateStatus:function(t){return t>=200&&t<300},retryStatus:function(t){return[408,413,429].includes(t)||t>=500&&t<600}},r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(t,n){return t(n={exports:{}},n.exports),n.exports}var u=o((function(t,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.6+9869a4bc
 */
t.exports=function(){function t(t){return"function"==typeof t}var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},i=0,e=void 0,o=void 0,u=function(t,n){v[i]=t,v[i+1]=n,2===(i+=2)&&(o?o(l):p())},s="undefined"!=typeof window?window:void 0,a=s||{},c=a.MutationObserver||a.WebKitMutationObserver,h="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var t=setTimeout;return function(){return t(l,1)}}var v=new Array(1e3);function l(){for(var t=0;t<i;t+=2)(0,v[t])(v[t+1]),v[t]=void 0,v[t+1]=void 0;i=0}var p=void 0;function w(t,n){var i=this,e=new this.constructor(b);void 0===e[y]&&D(e);var r=i.t;if(r){var o=arguments[r-1];u((function(){return M(r,e,o,i.i)}))}else R(i,e,t,n);return e}function m(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var n=new this(b);return T(n,t),n}p=h?function(){return process.nextTick(l)}:c?function(){var t=0,n=new c(l),i=document.createTextNode("");return n.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}():f?function(){var t=new MessageChannel;return t.port1.onmessage=l,function(){return t.port2.postMessage(0)}}():void 0===s?function(){try{var t=Function("return this")().require("vertx");return void 0!==(e=t.runOnLoop||t.runOnContext)?function(){e(l)}:d()}catch(t){return d()}}():d();var y=Math.random().toString(36).substring(2);function b(){}var g={error:null};function E(t){try{return t.then}catch(t){return g.error=t,g}}function _(n,i,e){i.constructor===n.constructor&&e===w&&i.constructor.resolve===m?function(t,n){1===n.t?A(t,n.i):2===n.t?S(t,n.i):R(n,void 0,(function(n){return T(t,n)}),(function(n){return S(t,n)}))}(n,i):e===g?(S(n,g.error),g.error=null):void 0===e?A(n,i):t(e)?function(t,n,i){u((function(t){var e=!1,r=function(i,r,o,u){try{i.call(r,(function(i){e||(e=!0,n!==i?T(t,i):A(t,i))}),(function(n){e||(e=!0,S(t,n))}))}catch(t){return t}}(i,n,0,0,t.u);!e&&r&&(e=!0,S(t,r))}),t)}(n,i,e):A(n,i)}function T(t,n){t===n?S(t,new TypeError("You cannot resolve a promise with itself")):function(t){var n=typeof t;return null!==t&&("object"===n||"function"===n)}(n)?_(t,n,E(n)):A(t,n)}function k(t){t.h&&t.h(t.i),O(t)}function A(t,n){void 0===t.t&&(t.i=n,t.t=1,0!==t.l.length&&u(O,t))}function S(t,n){void 0===t.t&&(t.t=2,t.i=n,u(k,t))}function R(t,n,i,e){var r=t.l,o=r.length;t.h=null,r[o]=n,r[o+1]=i,r[o+2]=e,0===o&&t.t&&u(O,t)}function O(t){var n=t.l,i=t.t;if(0!==n.length){for(var e=void 0,r=void 0,o=t.i,u=0;u<n.length;u+=3)e=n[u],r=n[u+i],e?M(i,e,r,o):r(o);t.l.length=0}}function M(n,i,e,r){var o=t(e),u=void 0,s=void 0,a=void 0,c=void 0;if(o){if((u=function(t,n){try{return t(n)}catch(t){return g.error=t,g}}(e,r))===g?(c=!0,s=u.error,u.error=null):a=!0,i===u)return void S(i,new TypeError("A promises callback cannot return that same promise."))}else u=r,a=!0;void 0!==i.t||(o&&a?T(i,u):c?S(i,s):1===n?A(i,u):2===n&&S(i,u))}var I=0;function D(t){t[y]=I++,t.t=void 0,t.i=void 0,t.l=[]}var j=function(){function t(t,i){this.m=t,this.promise=new t(b),this.promise[y]||D(this.promise),n(i)?(this.length=i.length,this.g=i.length,this.i=new Array(this.length),0===this.length?A(this.promise,this.i):(this.length=this.length||0,this._(i),0===this.g&&A(this.promise,this.i))):S(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._=function(t){for(var n=0;void 0===this.t&&n<t.length;n++)this.T(t[n],n)},t.prototype.T=function(t,n){var i=this.m,e=i.resolve;if(e===m){var r=E(t);if(r===w&&void 0!==t.t)this.k(t.t,n,t.i);else if("function"!=typeof r)this.g--,this.i[n]=t;else if(i===N){var o=new i(b);_(o,t,r),this.A(o,n)}else this.A(new i((function(n){return n(t)})),n)}else this.A(e(t),n)},t.prototype.k=function(t,n,i){var e=this.promise;void 0===e.t&&(this.g--,2===t?S(e,i):this.i[n]=i),0===this.g&&A(e,this.i)},t.prototype.A=function(t,n){var i=this;R(t,void 0,(function(t){return i.k(1,n,t)}),(function(t){return i.k(2,n,t)}))},t}(),N=function(){function n(t){this[y]=I++,this.i=this.t=void 0,this.l=[],b!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof n?function(t,n){try{n((function(n){T(t,n)}),(function(n){S(t,n)}))}catch(n){S(t,n)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return n.prototype.catch=function(t){return this.then(null,t)},n.prototype.finally=function(n){var i=this.constructor;return t(n)?this.then((function(t){return i.resolve(n()).then((function(){return t}))}),(function(t){return i.resolve(n()).then((function(){throw t}))})):this.then(n,n)},n}();return N.prototype.then=w,N.all=function(t){return new j(this,t).promise},N.race=function(t){var i=this;return n(t)?new i((function(n,e){for(var r=t.length,o=0;o<r;o++)i.resolve(t[o]).then(n,e)})):new i((function(t,n){return n(new TypeError("You must pass an array to race."))}))},N.resolve=m,N.reject=function(t){var n=new this(b);return S(n,t),n},N.S=function(t){o=t},N.R=function(t){u=t},N.O=u,N.polyfill=function(){var t=void 0;if(void 0!==r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var i=null;try{i=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===i&&!n.cast)return}t.Promise=N},N.Promise=N,N}()})),s=window.Promise||u;s.allSettled||(s.allSettled=function(t){return s.all(t.map((function(t){return t.then((function(t){return{status:"fulfilled",value:t}})).catch((function(t){return{status:"rejected",reason:t}}))})))});var a,c,h,f,d={object:!0,symbol:!0},v=function(t){return null!=t},l=Object.keys,p=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}()?Object.keys:function(t){return l(v(t)?Object(t):t)},w=function(t){if(!v(t))throw new TypeError("Cannot use null or undefined");return t},m=Math.max,y=function(){var t,n=Object.assign;return"function"==typeof n&&(n(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}()?Object.assign:function(t,n){var i,e,r,o=m(arguments.length,2);for(t=Object(w(t)),r=function(e){try{t[e]=n[e]}catch(t){i||(i=t)}},e=1;e<o;++e)n=arguments[e],p(n).forEach(r);if(void 0!==i)throw i;return t},b=Array.prototype.forEach,g=Object.create,E=function(t,n){var i;for(i in t)n[i]=t[i]},_=function(t){var n=g(null);return b.call(arguments,(function(t){v(t)&&E(Object(t),n)})),n},T=function(t){return"function"==typeof t},k="razdwatrzy",A=String.prototype.indexOf,S="function"==typeof k.contains&&!0===k.contains("dwa")&&!1===k.contains("foo")?String.prototype.contains:function(t){return A.call(this,t,arguments[1])>-1},R=o((function(t){(t.exports=function(t,n){var i,e,r,o,u;return arguments.length<2||"string"!=typeof t?(o=n,n=t,t=null):o=arguments[2],null==t?(i=r=!0,e=!1):(i=S.call(t,"c"),e=S.call(t,"e"),r=S.call(t,"w")),u={value:n,configurable:i,enumerable:e,writable:r},o?y(_(o),u):u}).gs=function(t,n,i){var e,r,o,u;return"string"!=typeof t?(o=i,i=n,n=t,t=null):o=arguments[3],null==n?n=void 0:T(n)?null==i?i=void 0:T(i)||(o=i,i=void 0):(o=n,n=i=void 0),null==t?(e=!0,r=!1):(e=S.call(t,"c"),r=S.call(t,"e")),u={get:n,set:i,configurable:e,enumerable:r},o?y(_(o),u):u}})),O=function(t){if(!function(t){return!!t&&("symbol"==typeof t||!!t.constructor&&"Symbol"===t.constructor.name&&"Symbol"===t[t.constructor.toStringTag])}(t))throw new TypeError(t+" is not a symbol");return t},M=Object.create,I=Object.defineProperties,D=Object.defineProperty,j=Object.prototype,N=M(null);if("function"==typeof Symbol){a=Symbol;try{String(a()),f=!0}catch(t){}}var P=function(){var t=M(null);return function(n){for(var i,e,r=0;t[n+(r||"")];)++r;return t[n+=r||""]=!0,D(j,i="@@"+n,R.gs(null,(function(t){e||(e=!0,D(this,i,R(t)),e=!1)}))),i}}();h=function(t){if(this instanceof h)throw new TypeError("TypeError: Symbol is not a constructor");return c(t)};var C=c=function t(n){var i;if(this instanceof t)throw new TypeError("TypeError: Symbol is not a constructor");return f?a(n):(i=M(h.prototype),n=void 0===n?"":String(n),I(i,{M:R("",n),I:R("",P(n))}))};I(c,{for:R((function(t){return N[t]?N[t]:N[t]=c(String(t))})),keyFor:R((function(t){var n;for(n in O(t),N)if(N[n]===t)return n})),hasInstance:R("",a&&a.hasInstance||c("hasInstance")),isConcatSpreadable:R("",a&&a.isConcatSpreadable||c("isConcatSpreadable")),iterator:R("",a&&a.iterator||c("iterator")),match:R("",a&&a.match||c("match")),replace:R("",a&&a.replace||c("replace")),search:R("",a&&a.search||c("search")),species:R("",a&&a.species||c("species")),split:R("",a&&a.split||c("split")),toPrimitive:R("",a&&a.toPrimitive||c("toPrimitive")),toStringTag:R("",a&&a.toStringTag||c("toStringTag")),unscopables:R("",a&&a.unscopables||c("unscopables"))}),I(h.prototype,{constructor:R(c),toString:R("",(function(){return this.I}))}),I(c.prototype,{toString:R((function(){return"Symbol ("+O(this).M+")"})),valueOf:R((function(){return O(this)}))}),D(c.prototype,c.toPrimitive,R("",(function(){var t=O(this);return"symbol"==typeof t?t:t.toString()}))),D(c.prototype,c.toStringTag,R("c","Symbol")),D(h.prototype,c.toStringTag,R("c",c.prototype[c.toStringTag])),D(h.prototype,c.toPrimitive,R("c",c.prototype[c.toPrimitive]));var x=function(){var t;if("function"!=typeof Symbol)return!1;t=Symbol("test symbol");try{String(t)}catch(t){return!1}return!!d[typeof Symbol.iterator]&&!!d[typeof Symbol.toPrimitive]&&!!d[typeof Symbol.toStringTag]}()?Symbol:C,L=window.Map||function(){var t,n,i,e=function(){n=[],i=[]},r=function(i){return-1<(t=n.indexOf(i))};return e(),{get size(){return n.length},has:r,clear:e,get:function(t){return i[n.indexOf(t)]},keys:function(){return n.slice()},values:function(){return i.slice()},entries:function(){return n.map((function(t,n){return[t,i[n]]}))},delete:function(e){return r(e)&&n.splice(t,1)&&!!i.splice(t,1)},forEach:function(t,e){var r=this;i.forEach((function(i,o){return t.call(e,i,n[o],r)}))},set:function(e,o){return r(e)?i[t]=o:i[n.push(e)-1]=o,this}}},U=window.WeakMap||function(){var t=Object.defineProperty,n=Date.now()%1e9,i=function(){this.name="__st"+(1e9*Math.random()>>>0)+n+++"__"};return i.prototype.set=function(n,i){if("object"!==B(n)&&"function"!=typeof n)throw new TypeError("Invalid value used as weak map key");var e=n[this.name];return e&&e[0]===n?e[1]=i:t(n,this.name,{value:[n,i],writable:!0}),this},i.prototype.get=function(t){var n;return(n=t[this.name])&&n[0]===t?n[1]:void 0},i.prototype.delete=function(t){var n=t[this.name];return!(!n||n[0]!==t||(n[0]=n[1]=void 0,0))},i.prototype.has=function(t){var n=t[this.name];return!!n&&n[0]===t},i}(),F=window.Array.from,H=[1];"function"==typeof F&&F(H)===H&&(F=!1);var V=F||function(t){return[].slice.call(t,0)};function B(t){return(B="function"==typeof x&&"symbol"==typeof x.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof x&&t.constructor===x&&t!==x.prototype?"symbol":typeof t})(t)}function $(t,n){for(var i=0;i<n.length;i++){var e=n[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function W(t,n,i){return n&&$(t.prototype,n),i&&$(t,i),t}function q(t,n,i){return n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}function G(t,n){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.push.apply(i,e)}return i}function Y(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?G(Object(i),!0).forEach((function(n){q(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):G(Object(i)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}))}return t}function K(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n}function z(t){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function X(t,n){return(X=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function J(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Q(t,n,i){return(Q=J()?Reflect.construct:function(t,n,i){var e=[null];e.push.apply(e,n);var r=new(Function.bind.apply(t,e));return i&&X(r,i.prototype),r}).apply(null,arguments)}function Z(t){var n="function"==typeof L?new L:void 0;return(Z=function(t){if(null===t||!function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,i)}function i(){return Q(t,arguments,z(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),X(i,t)})(t)}function tt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nt(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if(x.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var i=[],e=!0,r=!1,o=void 0;try{for(var u,s=t[x.iterator]();!(e=(u=s.next()).done)&&(i.push(u.value),!n||i.length!==n);e=!0);}catch(t){r=!0,o=t}finally{try{e||null==s.return||s.return()}finally{if(r)throw o}}return i}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function it(t){return function(t){if(Array.isArray(t)){for(var n=0,i=new Array(t.length);n<t.length;n++)i[n]=t[n];return i}}(t)||function(t){if(x.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return V(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function et(t){return function(n){for(var i=arguments.length,e=new Array(i>1?i-1:0),r=1;r<i;r++)e[r-1]=arguments[r];return e.forEach((function(i){for(var e in i){var r=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(n,e,Object.assign(r,t))}})),n}}var rt=et({enumerable:!1,configurable:!0,writeable:!1}),ot=et({enumerable:!1,configurable:!1,writeable:!1}),ut=et({enumerable:!0,configurable:!0,writeable:!1}),st={defer:!0,async:!0};function at(t,n){n=Object.assign(st,n);var i=window.vpimport__=window.vpimport__||{cache:{}};if(i.cache[t])return i.cache[t].D;var e=new s((function(e,r){var o=document.getElementsByTagName("head")[0],u=document.createElement("script");u.src=""+t,u.defer=n.defer,u.async=n.async,u.onreadystatechange=u.onload=function(){var n=Object.keys(i).filter((function(t){return"cache"!==t}))[0];i.cache[t].j=i[n],delete i[n],e(i.cache[t].j),o.removeChild(u)},u.onerror=function(n){r(n),delete i.cache[t],o.removeChild(u)},o.appendChild(u)}));return i.cache[t]={D:e},e}function ct(t){for(var n=function(t){return t&&"object"===B(t)},i=arguments.length,e=new Array(i>1?i-1:0),r=1;r<i;r++)e[r-1]=arguments[r];return e.reduce((function(t,i){return Object.keys(i||{}).forEach((function(e){var r=t[e],o=i[e];r&&void 0===o||(Array.isArray(o)?t[e]=(r||[]).concat(o):n(o)?t[e]=ct({},r,o):t[e]=o)})),t}),t)}function ht(){var t,n,i=new s((function(i,e){t=i,n=e}));return i.resolve=t,i.reject=n,i}function ft(t,n){for(var i=t,e=0;e<n.length;e++)if(n.start(e)<=t&&n.end(e)>=t){i=n.end(e);break}return i-t}function dt(t){return"string"!=typeof t?{}:t.replace("?","").split("&").reduce((function(t,n){if(n.length>0){var i=nt(n.split("="),2),e=i[0],r=i[1];t[e]=decodeURIComponent(r)}return t}),{})}function vt(t,n){var i=function(t){if("object"!==B(t))return"";var n=[];for(var i in t)t.hasOwnProperty(i)&&n.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return n.length?n.join("&"):""}(n);return"".concat(t).concat(i?"?".concat(i):"")}function lt(t,n){var i=this;this.headers={},ct(this,n),this.ok=2==(this.status/100|0),this.body=t,this.text=function(){return s.resolve(t)},this.json=function(){return s.resolve(JSON.parse(t))},this.blob=function(){return s.resolve(new Blob([t]))},this.arrayBuffer=function(){return s.resolve(t)},this.clone=function(){return new lt(t,i)}}var pt=function(t){function n(){var n;return(n=t.call(this,"The operation was aborted.")||this).name="AbortError",n}return K(n,t),n}(Z(Error)),wt=function(t){function n(n){var i;return(i=t.call(this,n.statusText)||this).name="HTTPError",i.response=n,i}return K(n,t),n}(Z(Error)),mt=function(t){function n(){var n;return(n=t.call(this,"A network error occurred.")||this).name="NetworkError",n}return K(n,t),n}(Z(Error)),yt=function(t){function n(n){var i;return(i=t.call(this,"Request timed out.")||this).name="TimeoutError",i.timeoutMs=n,i}return K(n,t),n}(Z(Error));function bt(){}function gt(t,n,i){if(!t.s){if(i instanceof Et){if(!i.s)return void(i.o=gt.bind(null,t,n));1&n&&(n=i.s),i=i.v}if(i&&i.then)return void i.then(gt.bind(null,t,n),gt.bind(null,t,2));t.s=n,t.v=i;var e=t.o;e&&e(t)}}var Et=function(){function t(){}return t.prototype.then=function(n,i){var e=new t,r=this.s;if(r){var o=1&r?n:i;if(o){try{gt(e,1,o(this.v))}catch(t){gt(e,2,t)}return e}return this}return this.o=function(t){try{var r=t.v;1&t.s?gt(e,1,n?n(r):r):i?gt(e,1,i(r)):gt(e,2,r)}catch(t){gt(e,2,t)}},e},t}();function _t(t){return t instanceof Et&&1&t.s}function Tt(t){var n=function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return s.resolve(t.apply(this,n))}catch(t){return s.reject(t)}}}((function(e){return function(t,n){try{var i=t()}catch(t){return n(t)}return i&&i.then?i.then(void 0,n):i}(e,(function(r){var o=!1;i++;var u=function(n){if(!t.retryAbortErrors&&n instanceof pt)return 0;if(n instanceof yt)return 0;if(i>=t.retry)return 0;if(n instanceof wt){if(!t.retryStatus(n.response.status))return 0;var e=n.response.headers["retry-after"];if(e&&t.retryStatus(n.response.status)){var r=Number(e);return isNaN(r)?r=Date.parse(e)-Date.now():r*=1e3,r}if(413===n.response.status)return 0}return.3*Math.pow(2,i-1)*1e3}(r);return function(a,c){var h=function(){if(0!==u&&i>0)return function(t,n,i){return t&&t.then||(t=s.resolve(t)),n?t.then(n):t}(function(t){return new s((function(n,i){return setTimeout(n,t)}))}(u),(function(){var u=t.hooks.beforeRetry||[];return function(t,n){return t&&t.then?t.then(n):n()}(function(t,n,i){var e,r,o=-1;return function i(u){try{for(;++o<t.length;)if((u=n(o))&&u.then){if(!_t(u))return void u.then(i,r||(r=gt.bind(null,e=new Et,2)));u=u.v}e?gt(e,1,u):e=u}catch(t){gt(e||(e=new Et),2,t)}}(),e}(u,(function(n){return function(t,n){return t&&t.then?t.then(bt):s.resolve()}((0,u[n])(t,r,i))})),(function(){return o=!0,n(e)}))}))}();return h&&h.then?h.then(c):c(h)}(0,(function(n){if(o)return n;if(t.throwHttpErrors)throw r}))}))})),i=0;return n}function kt(t,n,i){return i?n?n(t):t:(t&&t.then||(t=s.resolve(t)),n?t.then(n):t)}function At(t,n,i){if(!t.s){if(i instanceof St){if(!i.s)return void(i.o=At.bind(null,t,n));1&n&&(n=i.s),i=i.v}if(i&&i.then)return void i.then(At.bind(null,t,n),At.bind(null,t,2));t.s=n,t.v=i;var e=t.o;e&&e(t)}}var St=function(){function t(){}return t.prototype.then=function(n,i){var e=new t,r=this.s;if(r){var o=1&r?n:i;if(o){try{At(e,1,o(this.v))}catch(t){At(e,2,t)}return e}return this}return this.o=function(t){try{var r=t.v;1&t.s?At(e,1,n?n(r):r):i?At(e,1,i(r)):At(e,2,r)}catch(t){At(e,2,t)}},e},t}();function Rt(t){return t instanceof St&&1&t.s}function Ot(t,n,i){var e,r,o=-1;return function u(s){try{for(;++o<t.length&&(!i||!i());)if((s=n(o))&&s.then){if(!Rt(s))return void s.then(u,r||(r=At.bind(null,e=new St,2)));s=s.v}e?At(e,1,s):e=s}catch(t){At(e||(e=new St),2,t)}}(),e}function Mt(t,n){return t&&t.then?t.then(n):n(t)}function It(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return s.resolve(t.apply(this,n))}catch(t){return s.reject(t)}}}var Dt=["get","post","put","patch","head","delete"],jt={json:"application/json",text:"text/plain",arrayBuffer:"*/*",blob:"*/*"},Nt=["get"];function Pt(t,n){var i=It((function(){var t=!1,i=!1,e=n.hooks.beforeRequest||[];return Mt(Ot(e,(function(r){return kt((0,e[r])(n),(function(e){return e instanceof Ct?(n=e,void(i=!0)):e instanceof lt?(t=!0,s.resolve(e).then(xt(n))):void 0}))}),(function(){return i||t})),(function(i){return t?i:function(t){var n=t.url,i=t.method,e=t.body,r=t.onDownloadProgress;return new s((function(o,u){var s=new XMLHttpRequest;for(var a in s.open(i.toUpperCase(),n,t.async),t.timeout&&(s.timeout=t.timeout),s.onload=function(){if(0!==s.status||s.responseURL&&0===s.responseURL.indexOf("file:")){var t={};s.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(n,i,e){t[i]=t[i]?"".concat(t[i],",").concat(e):e})),o(new lt(s.response,{headers:t,statusText:s.statusText,status:s.status,url:s.responseURL}))}},s.onabort=function(){u(new pt)},s.onerror=function(){u(new mt)},s.ontimeout=function(){u(new yt(t.timeout))},"function"==typeof r&&s.addEventListener("progress",r),t.headers)s.setRequestHeader(a,t.headers[a]);t.withCredentials&&(s.withCredentials=!0),t.responseType&&(s.responseType=t.responseType),t.abort=s.abort.bind(s),s.send(e||null)}))}(n).then(xt(n))}))})),e=n=new Ct(t,n),r=e.method,o=e.json,u=e.jwt,a=e.searchParams;if(o&&(n.headers["Content-Type"]=jt.json,n.body=JSON.stringify(o)),u&&(n.headers.Authorization="jwt ".concat(u)),a){var c=nt(n.url.split("?"),2),h=c[0],f=c[1];n.url=vt(h,Y({},dt(f),{},a))}var d=-1!==Nt.indexOf(r.toLowerCase())?Tt(n)(i):i(),v=function(t){d[t]=It((function(){return n.headers["Content-Type"]=jt[t],kt(d,(function(n){return n.clone()[t]()}))}))};for(var l in jt)v(l);return function t(n,i){var e=n.then.bind(n);return Object.assign(n,{abort:i,then:function(){return t(e.apply(void 0,arguments),i)}})}(d,(function(){return n.abort()}))}function Ct(t,n){ct(this,e,t="string"==typeof t?{url:t}:t,n)}function xt(t){var n=t.validateStatus,i=t.throwHttpErrors,e=t.hooks;return It((function(r){var o=e.afterResponse||[];return Mt(Ot(o,(function(n){return kt((0,o[n])(t,r.clone()),(function(t){t instanceof lt&&(r=t)}))})),(function(){if(!n||n(r.status))return r;if(i)throw new wt(r);return r}))}))}Dt.forEach((function(t){return Pt[t]=function(n,i){return Pt(n,Y({method:t},i))},Pt[t]}));var Lt=Pt.get,Ut=Pt.post,Ft=Pt.put,Ht=Pt.patch,Vt=Pt.head,Bt={ARRAY_BUFFER:"arraybuffer"},$t=Object.freeze({__proto__:null,ContentTypes:i,defaults:e,requestMethods:Dt,responseTypes:jt,retryMethods:Nt,request:Pt,Request:Ct,get:Lt,post:Ut,put:Ft,patch:Ht,head:Vt,Response:lt,ResponseTypes:Bt,AbortError:pt,HTTPError:wt,NetworkError:mt,TimeoutError:yt}),Wt=o((function(t,n){t.exports=function(t){var n={};return(t=t||{}).prependOn=function(n,i){return t.on(n,i,!0)},t.eventNames=function(){return Object.keys(n)},t.on=function(i,e,r){for(var o=0,u=(i=[].concat(i)).length;o<u;o++){var s=i[o];if(!s)throw new Error("Tried to listen for an undefined event.");n[s]||(n[s]=[]),r?n[s].unshift(e):n[s].push(e)}return t},t.once=function(n,i,e){function r(){i.apply(t.off(n,r),arguments)}return r.handler=i,t.on(n,r,e)},t.off=function(i,e){if(!i)return n={},t;for(var r=0,o=(i=[].concat(i)).length;r<o;r++){var u=i[r];if(!u)throw new Error("Tried to remove an undefined event.");if(u in n)if(e){var s=n[u].indexOf(e);if(-1===s)for(var a=0,c=n[u].length;a<c;a++)if(n[u][a].handler===e){s=r;break}if(-1===s)return t;n[u].splice(s,1)}else delete n[u]}return t},t.fire=function(i){if(!i)throw new Error("Tried to fire an undefined event.");if(i in n)for(var e=n[i].slice(0),r=0,o=e.length;r<o;r++)if(e[r].apply(t,e.slice.call(arguments,1)),t.N){delete t.N;break}return t},t.halt=function(){return t.N=!0,t},t}}));function qt(t,n,i){switch(i.length){case 0:return t.call(n);case 1:return t.call(n,i[0]);case 2:return t.call(n,i[0],i[1]);case 3:return t.call(n,i[0],i[1],i[2])}return t.apply(n,i)}function Gt(t){return t}var Yt=Math.max;function Kt(t){return function(){return t}}var zt="object"==("undefined"==typeof global?"undefined":B(global))&&global&&global.Object===Object&&global,Xt="object"==("undefined"==typeof self?"undefined":B(self))&&self&&self.Object===Object&&self,Jt=zt||Xt||Function("return this")(),Qt=Jt.Symbol,Zt=Object.prototype,tn=Zt.hasOwnProperty,nn=Zt.toString,en=Qt?Qt.toStringTag:void 0,rn=Object.prototype.toString,on=Qt?Qt.toStringTag:void 0;function un(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":on&&on in Object(t)?function(t){var n=tn.call(t,en),i=t[en];try{t[en]=void 0;var e=!0}catch(t){}var r=nn.call(t);return e&&(n?t[en]=i:delete t[en]),r}(t):function(t){return rn.call(t)}(t)}function sn(t){var n=B(t);return null!=t&&("object"==n||"function"==n)}function an(t){if(!sn(t))return!1;var n=un(t);return"[object Function]"==n||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n}var cn=Jt["P"],hn=function(){var t=/[^.]+$/.exec(cn&&cn.keys&&cn.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),fn=Function.prototype.toString;function dn(t){if(null!=t){try{return fn.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var vn=/^\[object .+?Constructor\]$/,ln=Function.prototype,pn=Object.prototype,wn=ln.toString,mn=pn.hasOwnProperty,yn=RegExp("^"+wn.call(mn).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function bn(t,n){var i=function(t,n){return null==t?void 0:t[n]}(t,n);return function(t){return!(!sn(t)||function(t){return!!hn&&hn in t}(t))&&(an(t)?yn:vn).test(dn(t))}(i)?i:void 0}var gn=function(){try{var t=bn(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),En=gn?function(t,n){return gn(t,"toString",{configurable:!0,enumerable:!1,value:Kt(n),writable:!0})}:Gt,_n=Date.now,Tn=function(t){var n=0,i=0;return function(){var e=_n(),r=16-(e-i);if(i=e,r>0){if(++n>=800)return arguments[0]}else n=0;return t.apply(void 0,arguments)}}(En);function kn(t,n){return Tn(function(t,n,i){return n=Yt(void 0===n?t.length-1:n,0),function(){for(var e=arguments,r=-1,o=Yt(e.length-n,0),u=Array(o);++r<o;)u[r]=e[n+r];r=-1;for(var s=Array(n+1);++r<n;)s[r]=e[r];return s[n]=i(u),qt(t,this,s)}}(t,n,Gt),t+"")}function An(t,n){return t===n||t!=t&&n!=n}function Sn(t,n){for(var i=t.length;i--;)if(An(t[i][0],n))return i;return-1}var Rn=Array.prototype.splice;function On(t){var n=-1,i=null==t?0:t.length;for(this.clear();++n<i;){var e=t[n];this.set(e[0],e[1])}}On.prototype.clear=function(){this.C=[],this.size=0},On.prototype.delete=function(t){var n=this.C,i=Sn(n,t);return!(i<0||(i==n.length-1?n.pop():Rn.call(n,i,1),--this.size,0))},On.prototype.get=function(t){var n=this.C,i=Sn(n,t);return i<0?void 0:n[i][1]},On.prototype.has=function(t){return Sn(this.C,t)>-1},On.prototype.set=function(t,n){var i=this.C,e=Sn(i,t);return e<0?(++this.size,i.push([t,n])):i[e][1]=n,this};var Mn=bn(Jt,"Map"),In=bn(Object,"create"),Dn=Object.prototype.hasOwnProperty,jn=Object.prototype.hasOwnProperty;function Nn(t){var n=-1,i=null==t?0:t.length;for(this.clear();++n<i;){var e=t[n];this.set(e[0],e[1])}}function Pn(t,n){var i=t.C;return function(t){var n=B(t);return"string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t}(n)?i["string"==typeof n?"string":"hash"]:i.map}function Cn(t){var n=-1,i=null==t?0:t.length;for(this.clear();++n<i;){var e=t[n];this.set(e[0],e[1])}}function xn(t){var n=this.C=new On(t);this.size=n.size}function Ln(t,n,i){"__proto__"==n&&gn?gn(t,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[n]=i}function Un(t,n,i){(void 0===i||An(t[n],i))&&(void 0!==i||n in t)||Ln(t,n,i)}Nn.prototype.clear=function(){this.C=In?In(null):{},this.size=0},Nn.prototype.delete=function(t){var n=this.has(t)&&delete this.C[t];return this.size-=n?1:0,n},Nn.prototype.get=function(t){var n=this.C;if(In){var i=n[t];return"__lodash_hash_undefined__"===i?void 0:i}return Dn.call(n,t)?n[t]:void 0},Nn.prototype.has=function(t){var n=this.C;return In?void 0!==n[t]:jn.call(n,t)},Nn.prototype.set=function(t,n){var i=this.C;return this.size+=this.has(t)?0:1,i[t]=In&&void 0===n?"__lodash_hash_undefined__":n,this},Cn.prototype.clear=function(){this.size=0,this.C={hash:new Nn,map:new(Mn||On),string:new Nn}},Cn.prototype.delete=function(t){var n=Pn(this,t).delete(t);return this.size-=n?1:0,n},Cn.prototype.get=function(t){return Pn(this,t).get(t)},Cn.prototype.has=function(t){return Pn(this,t).has(t)},Cn.prototype.set=function(t,n){var i=Pn(this,t),e=i.size;return i.set(t,n),this.size+=i.size==e?0:1,this},xn.prototype.clear=function(){this.C=new On,this.size=0},xn.prototype.delete=function(t){var n=this.C,i=n.delete(t);return this.size=n.size,i},xn.prototype.get=function(t){return this.C.get(t)},xn.prototype.has=function(t){return this.C.has(t)},xn.prototype.set=function(t,n){var i=this.C;if(i instanceof On){var e=i.C;if(!Mn||e.length<199)return e.push([t,n]),this.size=++i.size,this;i=this.C=new Cn(e)}return i.set(t,n),this.size=i.size,this};var Fn=function(t,n,i){for(var e=-1,r=Object(t),o=i(t),u=o.length;u--;){var s=o[++e];if(!1===n(r[s],s,r))break}return t},Hn="object"==(void 0===t?"undefined":B(t))&&t&&!t.nodeType&&t,Vn=Hn&&"object"==("undefined"==typeof module?"undefined":B(module))&&module&&!module.nodeType&&module,Bn=Vn&&Vn.exports===Hn?Jt.Buffer:void 0,$n=Bn?Bn.allocUnsafe:void 0;function Wn(t,n){if(n)return t.slice();var i=t.length,e=$n?$n(i):new t.constructor(i);return t.copy(e),e}var qn=Jt.Uint8Array;function Gn(t){var n=new t.constructor(t.byteLength);return new qn(n).set(new qn(t)),n}function Yn(t,n){var i=n?Gn(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}function Kn(t,n){var i=-1,e=t.length;for(n||(n=Array(e));++i<e;)n[i]=t[i];return n}var zn=Object.create,Xn=function(){function t(){}return function(n){if(!sn(n))return{};if(zn)return zn(n);t.prototype=n;var i=new t;return t.prototype=void 0,i}}();function Jn(t,n){return function(i){return t(n(i))}}var Qn=Jn(Object.getPrototypeOf,Object),Zn=Object.prototype;function ti(t){var n=t&&t.constructor;return t===("function"==typeof n&&n.prototype||Zn)}function ni(t){return"function"!=typeof t.constructor||ti(t)?{}:Xn(Qn(t))}function ii(t){return null!=t&&"object"==B(t)}function ei(t){return ii(t)&&"[object Arguments]"==un(t)}var ri=Object.prototype,oi=ri.hasOwnProperty,ui=ri.propertyIsEnumerable,si=ei(function(){return arguments}())?ei:function(t){return ii(t)&&oi.call(t,"callee")&&!ui.call(t,"callee")},ai=Array.isArray;function ci(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function hi(t){return null!=t&&ci(t.length)&&!an(t)}var fi="object"==(void 0===t?"undefined":B(t))&&t&&!t.nodeType&&t,di=fi&&"object"==("undefined"==typeof module?"undefined":B(module))&&module&&!module.nodeType&&module,vi=di&&di.exports===fi?Jt.Buffer:void 0,li=(vi?vi.isBuffer:void 0)||function(){return!1},pi=Function.prototype,wi=Object.prototype,mi=pi.toString,yi=wi.hasOwnProperty,bi=mi.call(Object),gi={};function Ei(t){return function(n){return t(n)}}gi["[object Float32Array]"]=gi["[object Float64Array]"]=gi["[object Int8Array]"]=gi["[object Int16Array]"]=gi["[object Int32Array]"]=gi["[object Uint8Array]"]=gi["[object Uint8ClampedArray]"]=gi["[object Uint16Array]"]=gi["[object Uint32Array]"]=!0,gi["[object Arguments]"]=gi["[object Array]"]=gi["[object ArrayBuffer]"]=gi["[object Boolean]"]=gi["[object DataView]"]=gi["[object Date]"]=gi["[object Error]"]=gi["[object Function]"]=gi["[object Map]"]=gi["[object Number]"]=gi["[object Object]"]=gi["[object RegExp]"]=gi["[object Set]"]=gi["[object String]"]=gi["[object WeakMap]"]=!1;var _i="object"==(void 0===t?"undefined":B(t))&&t&&!t.nodeType&&t,Ti=_i&&"object"==("undefined"==typeof module?"undefined":B(module))&&module&&!module.nodeType&&module,ki=Ti&&Ti.exports===_i&&zt.process,Ai=function(){try{return Ti&&Ti.require&&Ti.require("util").types||ki&&ki.binding&&ki.binding("util")}catch(t){}}(),Si=Ai&&Ai.isTypedArray,Ri=Si?Ei(Si):function(t){return ii(t)&&ci(t.length)&&!!gi[un(t)]};function Oi(t,n){if(("constructor"!==n||"function"!=typeof t[n])&&"__proto__"!=n)return t[n]}var Mi=Object.prototype.hasOwnProperty;function Ii(t,n,i){var e=t[n];Mi.call(t,n)&&An(e,i)&&(void 0!==i||n in t)||Ln(t,n,i)}function Di(t,n,i,e){var r=!i;i||(i={});for(var o=-1,u=n.length;++o<u;){var s=n[o],a=e?e(i[s],t[s],s,i,t):void 0;void 0===a&&(a=t[s]),r?Ln(i,s,a):Ii(i,s,a)}return i}var ji=/^(?:0|[1-9]\d*)$/;function Ni(t,n){var i=B(t);return!!(n=null==n?9007199254740991:n)&&("number"==i||"symbol"!=i&&ji.test(t))&&t>-1&&t%1==0&&t<n}var Pi=Object.prototype.hasOwnProperty;function Ci(t,n){var i=ai(t),e=!i&&si(t),r=!i&&!e&&li(t),o=!i&&!e&&!r&&Ri(t),u=i||e||r||o,s=u?function(t,n){for(var i=-1,e=Array(t);++i<t;)e[i]=n(i);return e}(t.length,String):[],a=s.length;for(var c in t)!n&&!Pi.call(t,c)||u&&("length"==c||r&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Ni(c,a))||s.push(c);return s}var xi=Object.prototype.hasOwnProperty;function Li(t){return hi(t)?Ci(t,!0):function(t){if(!sn(t))return function(t){var n=[];if(null!=t)for(var i in Object(t))n.push(i);return n}(t);var n=ti(t),i=[];for(var e in t)("constructor"!=e||!n&&xi.call(t,e))&&i.push(e);return i}(t)}function Ui(t,n,i,e,r){t!==n&&Fn(n,(function(o,u){if(r||(r=new xn),sn(o))!function(t,n,i,e,r,o,u){var s=Oi(t,i),a=Oi(n,i),c=u.get(a);if(c)Un(t,i,c);else{var h=o?o(s,a,i+"",t,n,u):void 0,f=void 0===h;if(f){var d=ai(a),v=!d&&li(a),l=!d&&!v&&Ri(a);h=a,d||v||l?ai(s)?h=s:function(t){return ii(t)&&hi(t)}(s)?h=Kn(s):v?(f=!1,h=Wn(a,!0)):l?(f=!1,h=Yn(a,!0)):h=[]:function(t){if(!ii(t)||"[object Object]"!=un(t))return!1;var n=Qn(t);if(null===n)return!0;var i=yi.call(n,"constructor")&&n.constructor;return"function"==typeof i&&i instanceof i&&mi.call(i)==bi}(a)||si(a)?(h=s,si(s)?h=function(t){return Di(t,Li(t))}(s):sn(s)&&!an(s)||(h=ni(a))):f=!1}f&&(u.set(a,h),r(h,a,e,o,u),u.delete(a)),Un(t,i,h)}}(t,n,u,i,Ui,e,r);else{var s=e?e(Oi(t,u),o,u+"",t,n,r):void 0;void 0===s&&(s=o),Un(t,u,s)}}),Li)}function Fi(t,n,i,e,r,o){return sn(t)&&sn(n)&&(o.set(n,t),Ui(t,n,void 0,Fi,o),o.delete(n)),t}function Hi(t){return kn((function(n,i){var e=-1,r=i.length,o=r>1?i[r-1]:void 0,u=r>2?i[2]:void 0;for(o=t.length>3&&"function"==typeof o?(r--,o):void 0,u&&function(t,n,i){if(!sn(i))return!1;var e=B(n);return!!("number"==e?hi(i)&&Ni(n,i.length):"string"==e&&n in i)&&An(i[n],t)}(i[0],i[1],u)&&(o=r<3?void 0:o,r=1),n=Object(n);++e<r;){var s=i[e];s&&t(n,s,e,o)}return n}))}var Vi=Hi((function(t,n,i,e){Ui(t,n,i,e)})),Bi=kn((function(t){return t.push(void 0,Fi),qt(Vi,void 0,t)})),$i=function(){function t(t){this.L=!1,this.U=!1,this.F=t,Wt(this)}W(t,null,[{key:"displayName",get:function(){return"ExternalDisplay"}},{key:"supported",get:function(){return!1}},{key:"supportedVideoTypes",get:function(){return[]}}]);var n=t.prototype;return n.showPicker=function(){},n.getFile=function(){var t=this.constructor.displayName.replace("ExternalDisplay","");if(this.F.externalDisplayFiles[t])return this.F.externalDisplayFiles[t];var n=this.constructor.supportedVideoTypes,i=this.F.files.filter((function(t){return-1!==n.indexOf(t.mime)})).sort((function(t,i){return t.mime===i.mime?t.priority-i.priority:n.indexOf(t.mime)-n.indexOf(i.mime)}));if(!i.length)throw new Error("No files available for ".concat(this.constructor.displayName," external display."));return i[0]},W(t,[{key:"active",get:function(){return this.U}},{key:"available",get:function(){return this.L}},{key:"element",get:function(){return document.createElement("div")}}]),t}(),Wi={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",WEBKIT_BEGIN_FULLSCREEN:"webkitbeginfullscreen",WEBKIT_END_FULLSCREEN:"webkitendfullscreen",WEBKIT_PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},qi={AVAILABLE:"externaldisplayavailable",UNAVAILABLE:"externaldisplayunavailable",ACTIVATED:"externaldisplayactivated",DEACTIVATED:"externaldisplaydeactivated"},Gi={AIRPLAY_AVAILABLE:"available",AIRPLAY_UNAVAILABLE:"unavailable",AIRPLAY_ACTIVATED:"activated",AIRPLAY_DEACTIVATED:"deactivated"},Yi={SCANNER_CHANGE:"scannerchange",SCANNER_ERROR:"scannererror",FILE_ERROR:"fileerror",FILE_SRC_UPDATE:"filesrcupdate",DOWNLOAD_START:"downloadstart",DOWNLOAD_END:"downloadend",DOWNLOAD_ERROR:"downloaderror",DOWNLOAD_TIMEOUT:"downloadtimeout",DRM_AUTH_FAILURE:"drmauthfailure",DRM_AUTH_SUCCESS:"drmauthsuccess",DRM_FAILURE:"drmfailure",DRM_OUTPUT_RESTRICTED:"drmoutputrestricted",EME_UNSUPPORTED:"emeunsupported",CURRENT_FILE_CHANGE:"currentfilechange",MEDIA_URL_EXPIRED:"mediaurlexpired",MEDIA_URL_BAD_REQUEST:"mediaurlbadrequest",STREAM_CHANGE:"streamchange",STREAM_CHANGE_START:"streamchangestart",STREAM_BUFFER_START:"streambufferstart",STREAM_BUFFER_END:"streambufferend",DROPPED_FRAMES:"droppedframes",BANDWIDTH:"bandwidth",STREAM_TARGET_CHANGE:"streamtargetchange",PRESENTATION_MODE_CHANGE:"presentationmodechange",CUE_POINT:"cuepoint",BUFFER_OCCUPANCY:"bufferoccupancy",MANIFEST_TIMEOUT:"manifesttimeout",MANIFEST_LOADED:"manifestloaded",STREAMS_LOADED:"streamsloaded",TEXT_SRC_UPDATE:"texttracksrcupdate",TEXT_TRACKS_AVAILABLE:"texttracksavailable",AV_DURATION_MISMATCH:"avdurationmismatch",BUFFER_STARTED:"bufferstarted",BUFFER_ENDED:"bufferended",QUOTA_EXCEEDED_ERROR:"quotaexceedederror",CHAPTER_CUES_UPDATED:"chaptercuesupdated",APPEND_BUFFER_END:"appendbufferend"},Ki={STREAM_ONLINE:"livestreamonline",STREAM_OFFLINE:"livestreamoffline"},zi={CAMERA_UPDATE:"cameraupdate",MOTION_START:"motionstart",MOTION_END:"motionend",SPATIAL_UNSUPPORTED:"spatialunsupported",WEBVR_ENTER:"entervr",WEBVR_EXIT:"exitvr",WEBVR_HARDWARE_AVAILABLE:"webvrhardwareavailable"},Xi={MEDIASESSION_PLAY:"mediasessionplay",MEDIASESSION_PAUSE:"mediasessionpause",MEDIASESSION_SEEK_FORWARD:"mediasessionseekforward",MEDIASESSION_SEEK_BACKWARD:"mediasessionseekbackward"},Ji={BRAIN_ML_MODEL_ERR:"brainmlmodelerr",BRAIN_ML_MODEL_NET_ERR:"brainmlmodelresperr",BRAIN_ML_MODEL_TIMEOUT:"brainmlmodeltimeout",BRAIN_ML_SWITCH_TO_SKYFIRE:"brainmlmodelswitchtoskyfire",BRAIN_ML_MODEL_INPUTS:"brainmlmodelinputs"},Qi=Object.assign({},Wi,qi,Gi,Yi,zi,Ki,Xi,Ji),AirPlayExternalDisplay=function(t){function AirPlayExternalDisplay(n){var i;return(i=t.call(this,n)||this).H=document.createElement("video"),i.H.setAttribute("data-airplay",""),i.H.setAttribute("x-webkit-airplay","allow"),i.addVideoEventListeners(),i}K(AirPlayExternalDisplay,t),W(AirPlayExternalDisplay,null,[{key:"displayName",get:function(){return"AirPlayExternalDisplay"}},{key:"supported",get:function(){return"WebKitPlaybackTargetAvailabilityEvent"in window}},{key:"supportedVideoTypes",get:function(){return["application/vnd.apple.mpegurl","video/mp4"]}}]);var n=AirPlayExternalDisplay.prototype;return n.addVideoEventListeners=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.H;n.addEventListener(Wi.LOADED_METADATA,(function(n){t.fire(Wi.LOADED_METADATA,n)})),n.addEventListener("webkitplaybacktargetavailabilitychanged",(function(n){switch(n.availability){case"available":t.L||(t.L=!0,t.fire(Gi.AIRPLAY_AVAILABLE));break;case"not-available":t.L&&(t.L=!1,t.fire(Gi.AIRPLAY_UNAVAILABLE))}})),n.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",(function(n){if(n.target.webkitCurrentPlaybackTargetIsWireless)return t.U=!0,void t.fire(Gi.AIRPLAY_ACTIVATED);t.U=!1,t.fire(Gi.AIRPLAY_DEACTIVATED)}))},n.showPicker=function(){var t=this;this.H.webkitShowPlaybackTargetPicker(),this.loadMetadata().then((function(){return t.H.webkitShowPlaybackTargetPicker()})).catch((function(){}))},n.loadMetadata=function(){var t=this;return this.H.readyState>=1?s.resolve():new s((function(n,i){t.H.addEventListener(Wi.LOADED_METADATA,(function(){n()})),t.H.src=t.getFile().src}))},W(AirPlayExternalDisplay,[{key:"element",get:function(){return this.H},set:function(t){if(!(t instanceof HTMLVideoElement))throw new TypeError("The element for AirPlay must be a <video>.");t!==this.H&&(this.addVideoEventListeners(t),this.H=t,this.H.setAttribute("x-webkit-airplay","allow"))}}]),AirPlayExternalDisplay}($i),Zi=navigator.userAgent.toLowerCase();function te(t){t=t.toLowerCase();var n=new RegExp(t).test(Zi);return"safari"===t?n&&new RegExp("version").test(Zi):n}function ne(t){var n=document.createElement("div"),i=t.charAt(0).toUpperCase()+t.slice(1),e=(t+" "+["Webkit","Moz","O","ms"].join(i+" ")+i).split(" ");for(var r in e){var o=e[r];if(void 0!==n.style[o])return o}return t}var ie=!!te("android")&&(parseFloat(Zi.replace(/^.* android (\d+)\.(\d+).*$/,"$1.$2"))||!0),ee=window.devicePixelRatio||1,re=!(!te("windows phone")&&!te("iemobile"))&&(parseFloat(Zi.replace(/^.* windows phone (os )?(\d+)\.(\d+).*$/,"$2.$3"))||!0),oe=!!te("msie")&&parseFloat(Zi.replace(/^.*msie (\d+).*$/,"$1")),ue=!!te("trident")&&parseFloat(Zi.replace(/^.*trident\/(\d+)\.(\d+).*$/,"$1.$2"))+4,se=!!(te("ipad;")||te("iphone;")||te("ipod touch;"))&&parseFloat(Zi.replace(/^.* os (\d+)_(\d+).*$/,"$1.$2")),ae=te("opera")||te("opr");function ce(){if(!te("safari"))return[];var t=Zi.split(" ").find((function(t){return/version\//.test(t)}));return t?t.replace("version/","").split(".").map((function(t){return parseInt(t,10)})):[]}var he=te("safari")&&te("apple")&&!te("chrome")&&!te("android")&&ce()[0]>=11,fe={airPlay:"WebKitPlaybackTargetAvailabilityEvent"in window,android:ie,hasAutoplayPolicy:ie||se||he||function(){if(!te("chrome"))return[];var t=Zi.split(" ").find((function(t){return se?/CriOS\//.test(t):/chrome\//.test(t)}));return t?t.replace("chrome/","").split(".").map((function(t){return parseInt(t,10)})):[]}()[0]>=66,iOS:se,mobileAndroid:ie&&te("mobile"),browser:{bb10:te("bb10"),chrome:te("chrome"),firefox:te("firefox"),ie:oe||ue,edge:te("edge"),opera:ae,safari:te("safari")&&te("apple")&&!te("chrome")&&!te("android")},devicePixelRatio:ee,iPhone:te("iphone;")||te("ipod touch;")||te("ipod;"),iPad:te("ipad;"),iPadNonRetina:te("ipad;")&&ee<2,mac:te("mac os"),pointerEvents:window.navigator.pointerEnabled||window.navigator.msPointerEnabled||!1,svg:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||te("windows phone")||window.navigator.maxTouchPoints>1||window.navigator.msMaxTouchPoints||!1,transformProperty:ne("transform"),transitionProperty:ne("transition"),webp:function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))&&0===t.toDataURL("image/webp").indexOf("data:image/webp")}(),windowsPhone:re},de=/mac os x 10_13/.test(Zi),ve=fe.iOS&&fe.iOS>=11,le=fe.iPhone&&812===window.screen.availHeight&&375===window.screen.availWidth,pe=fe.iPhone&&896===window.screen.availHeight&&414===window.screen.availWidth,we=fe.iPad&&1112===window.screen.availWidth&&834===window.screen.availHeight,me=fe.iPad&&834===window.screen.availWidth&&1194===window.screen.availHeight,ye=fe.iPad&&1024===window.screen.availWidth&&1366===window.screen.availHeight,be=le||pe||we||me||ye;function ge(){return!!(he&&de||he&&ve)||"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported('video/mp4; codecs="hvc1"')}function Ee(){return!(fe.iOS||fe.iPad||fe.browser.ie)&&(!te("safari")||ce()[0]>11||11===ce()[0]&&(ce()[2]>1||ce()[1]>0))}fe.hevc=ge(),fe.hdr=he&&ve&&be,fe.vp9hdr=(window.matchMedia("(color-gamut: p3)").matches||window.matchMedia("(color-gamut: rec2020)").matches)&&screen.colorDepth>=48&&(MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.01"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.01"')),fe.av1="undefined"!=typeof MediaSource&&MediaSource.isTypeSupported('video/mp4; codecs="av01.0.31M.08.0.110.01.01.01.0"'),fe.webvr=!!(window.navigator&&"getVRDisplays"in window.navigator),fe.webxr=!!(window.navigator&&"xr"in window.navigator&&"supportsSession"in window.navigator.xr),fe.spatialPlayback=Ee(),fe.spatialHEVC=!fe.browser.safari&&Ee()&&ge(),fe.stereoscopic=fe.spatialPlayback&&fe.mobileAndroid;var _e=/Firefox/.test(navigator.userAgent),Te=/i(Phone|Pad|Pod touch);/.test(navigator.userAgent),ke=/Android/.test(navigator.userAgent),Ae={firefox:_e,iOS:Te,android:ke,androidMobile:ke&&/mobile/.test(navigator.userAgent.toLowerCase()),chrome:function(){var t=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\./);return!!t&&{major:t[1],minor:t[2]}}()};function Se(t,n){var i,e=0;return q(i={},x.iterator,(function(){return this})),q(i,"next",(function(){return e<t.length?{done:!1,value:n?[t[e],n[e++]]:t[e++]}:{done:!0}})),i}var Re=function(t){for(var n=0,i=this.length;n<i;n++)if(this[n].id==="".concat(t))return this[n];return null};function Oe(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.item=function(t){return this[t]},t.getTrackById=Re,t}function Me(){return void 0!==window.performance&&"function"==typeof window.performance.now?window.performance.now():Date.now()}function Ie(t){return Me()-t}function De(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(t){return(t^(16*Math.random()>>t)/4).toString(16)}))}function je(t){for(var n=window.atob(t),i=n.length,e=new Uint8Array(i),r=0;r<i;r++)e[r]=n.charCodeAt(r);return e}function Ne(t){return je(t).buffer}function Pe(t,n,i,e){var r=0,o=0,u=t,s=n,a=i/e;return u/s>=a?(o=s,r=(a*s).toFixed(2)):(r=u,o=(u/a).toFixed(2)),{width:r,height:o,left:Math.max((u-r)/2,0),top:Math.max((s-o)/2,0)}}function Ce(t){var n=[document.fullscreenElement,document.webkitFullscreenElement,document.webkitCurrentFullScreenElement,document.mozFullScreenElement,document.msFullscreenElement].find((function(t){return void 0!==t}));return void 0!==n?!!n:t.webkitDisplayingFullscreen}function xe(t,n){return["".concat(t,';codecs="').concat(n,'"'),"".concat(t,';codecs="').concat("avc1.42E01E,mp4a.40.2",'"')].find(MediaSource.isTypeSupported)||t}function Le(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t=parseFloat(t),isNaN(t))return 0;var i=Math.pow(10,n);return Math.round(t*i)/i}function Ue(t,n){return t&&t.tests&&t.tests[n]?t.tests[n]:null}function Fe(t){return t&&"ML"===t.displayName}var TelecineError=function(t,n){this.name=t,this.message=n,Object.freeze(this)},He=new U,Ve=function(){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=parseFloat(t);if(isNaN(i))throw new TypeError("Time must be a number.");if(i<0)throw new TypeError("Time must be a positive number.");this.time=t,this.data=n,this.id=De();try{var e="undefined"==typeof VTTCue?TextTrackCue:VTTCue;this.vttCue=new e(t,t+.25,JSON.stringify(n)),this.vttCue.id=this.id}catch(t){throw new TelecineError("CuePointsNotSupported","Cue points are not supported in this browser.")}He.set(this.vttCue,this),Object.freeze(this)}return t.fromVTTCue=function(n){if(He.has(n))return He.get(n);var i={};try{i=JSON.parse(n.text)}catch(t){}return new t(n.startTime,i)},t}();function Be(t,n,i){var e;try{document.removeChild({})}catch(r){e=Object.create(Object.getPrototypeOf(r),{name:{value:n,configurable:!0,writable:!0},code:{value:t,configurable:!0,writable:!0},message:{value:i,configurable:!0,writable:!0},toString:{value:function(){return"".concat(n,": DOM Exception ").concat(t)},configurable:!0,writable:!0}})}return Object.freeze(e)}var $e=function(t,n){if(!t||void 0===t[n])throw Be(1,"INDEX_SIZE_ERR");return t[n]};function We(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object.freeze(q({get length(){return t.length},start:function(n){return $e(t,n)},end:function(t){return $e(n,t)}},x.iterator,(function(){return Se(t,n)})))}We.from=function(t){if(!(t instanceof TimeRanges))throw new TypeError("Can only create a TelecineTimeRange from a TimeRanges object.");for(var n=[],i=[],e=0,r=t.length;e<r;e++)n.push(t.start(e)),i.push(t.end(e));return We(n,i)};var qe=document.createElement("video"),Ge={"application/vnd.apple.mpegurl":"application/vnd.apple.mpegurl","video/mp4":'video/mp4; codecs="avc1.64001E"',"video/webm":'video/webm; codecs="vp8, vorbis"',"video/x-flv":'video/x-flv; codecs="vp6"'},Ye=function(){var t="undefined"==typeof TextTrack?{}:TextTrack;return{disabled:"DISABLED"in t?t.DISABLED:"disabled",hidden:"HIDDEN"in t?t.HIDDEN:"hidden",showing:"SHOWING"in t?t.SHOWING:"showing"}}(),Ke=function(){var t=document.createElement("track");return"track"in t&&"oncuechange"in t.track}(),ze=new U,Xe=function(){function t(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.V=t,this.B=i,this.$=null,this.W=null,this.q=[],Wt(this),this.on("play",(function(){return n.G()}));var e=t.querySelector("video");e||((e=document.createElement("video")).preload="none",this.V.appendChild(e)),e.setAttribute("tabindex","-1"),this.F=e,i.playRequest&&(this.Y=i.playRequest,this.Y.video=e),i.htmlScanner&&i.htmlScanner.controls&&(this.F.controls=!0),this.K=this.handleVideoEvent.bind(this),this.addVideoEventListeners(),this.X="none",this.J=!1,this.Z=!1,this.tt=-1}W(t,null,[{key:"displayName",get:function(){return"HTMLScanner"}},{key:"supported",get:function(){return t.supportedVideoTypes.length>0}},{key:"supportedVideoTypes",get:function(){var t=[];if("function"!=typeof qe.canPlayType)return t;for(var n in Ge){var i=Ge[n];fe.android&&"application/vnd.apple.mpegurl"===n||(fe.android&&!fe.mobileAndroid&&"video/mp4"===n&&fe.android instanceof String?parseInt(fe.android.split(".")[0],10)>3&&t.push(n):qe.canPlayType(i).replace(/^no$/,"")&&t.push(n))}return t}},{key:"supportedAudioTypes",get:function(){return[]}},{key:"supportedExternalDisplays",get:function(){return[AirPlayExternalDisplay]}},{key:"supportsSettingVolume",get:function(){if(fe.android)return!1;var t=qe.volume;return qe.volume=.5*t,qe.volume!==t}},{key:"supportsTextTracks",get:function(){return void 0!==qe.textTracks&&qe.textTracks instanceof TextTrackList}},{key:"supportsPlaybackRate",get:function(){if(fe.android&&Ae.chrome&&Ae.chrome.major<52)return!1;var t=qe.playbackRate;qe.playbackRate=.5*t;var n=t!==qe.playbackRate;return qe.playbackRate=t,n}}]);var n=t.prototype;return n.deactivate=function(){this.$&&(this.$.off("filesrcupdate"),this.$.off("texttracksrcupdate")),this.removeVideoEventListeners(),this.removeSnapshot(),this.F.style.display="none"},n.reactivate=function(){this.addVideoEventListeners(),this.F.style.display=""},n.addVideoEventListeners=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.F;Object.keys(Wi).forEach((function(i){var e=Wi[i];n.addEventListener(e,t.K)}))},n.removeVideoEventListeners=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.F;Object.keys(Wi).forEach((function(i){var e=Wi[i];n.removeEventListener(e,t.K)}))},n.play=function(t){var n=this;return this.Y.start(t).catch((function(t){throw n.nt(t),t}))},n.nt=function(t){this.fire(Wi.ERROR,new TelecineError(t.name,t.message))},n.pause=function(){this.Y.cancel(),this.F.pause()},n.onpause=function(){},n.ontimeupdate=function(){this.tt=this.currentTime},n.addTextTrack=function(t){var n,i,e=this;t.src?((n=document.createElement("track")).kind=t.kind,n.src=t.src,n.id="telecine-track-".concat(t.id),n.srclang=t.language,n.label=t.label,this.F.appendChild(n),i=n.track):(i=this.F.addTextTrack(t.kind,t.label,t.language),this.it=this.it||{},this.it["telecine-track-".concat(t.id)]=i),i.addEventListener("cuechange",(function(){return t.dispatchEvent("cuechange")})),this.F.addEventListener("timeupdate",(function(){Ce(e.F)&&(t.mode=i.mode)}));var r=function(){var n=Ae.iOS&&Ce(e.F);!t.et||n?t.mode=i.mode:i.mode=Ye[t.mode]},o=[];if(n?n.addEventListener("load",r):r(),["loadeddata","seeking"].forEach((function(t){e.F.addEventListener(t,r),o.push([t,r])})),t.et&&(i.mode=Ye[t.mode]),!Ke){var u=[],s=function(){if(i&&"disabled"!==Ye[i.mode]){if(u.length!==i.activeCues.length)return t.dispatchEvent("cuechange"),void(u=V(i.activeCues));for(var n=0,e=i.activeCues.length;n<e;n++)if(i.activeCues[n].startTime!==u[n].startTime)return t.dispatchEvent("cuechange"),void(u=V(i.activeCues))}};this.F.addEventListener("timeupdate",s),o.push(["timeupdate",s])}return ze.set(t,o),i},n.removeTextTrack=function(t){var n=this,i=this.F.querySelector("#telecine-track-".concat(t.id));i&&this.F.removeChild(i);var e=ze.get(t);Array.isArray(e)&&e.forEach((function(t){var i=nt(t,2),e=i[0],r=i[1];n.F.removeEventListener(e,r)}))},n.getCuesForTrack=function(t){var n=this.getTrackById("telecine-track-".concat(t.id));return n?V(n.cues):[]},n.getActiveCuesForTrack=function(t){var n=this.getTrackById("telecine-track-".concat(t.id));return n?V(n.activeCues):[]},n.setModeForTrack=function(t,n){var i=this.getTrackById("telecine-track-".concat(t.id));return i&&i.mode!==Ye[n]&&(i.mode=Ye[n],Ke||"disabled"===n||t.dispatchEvent("cuechange")),this},n.setSrcForTrack=function(t,n){var i=this.F.querySelector("#telecine-track-".concat(t.id));return i&&null===i.track.cues&&(i.src=n),this},n.rt=function(t,n){var i,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.ot||(this.ot=this.F.addTextTrack("chapters"),this.ot.mode="hidden");var r=t.timecode,o=e?e.timecode:n,u=window.VTTCue||window.TextTrackCue;try{i=new u(r,o,t.title)}catch(t){throw new TelecineError("ChaptersNotSupported","Chapters are not supported in this browser.")}i.size=(o-r)/n,i.id=r,this.ot.addCue(i)},n.addChapter=function(t,n){var i=this.video.chapters,e={timecode:t,title:n};i.push(e),i.sort((function(t,n){return t.timecode-n.timecode}));var r=i[i.indexOf(e)+1];this.rt(e,this.video.duration,r),this.ut(this.ot,this.video.duration)},n.removeChapter=function(t){try{this.ot.removeCue(t)}catch(t){throw new TelecineError("ChaptersNotSupported","Chapters are not supported in this browser.")}var n=this.video.chapters.find((function(n){return n.timecode===t.timecode}));this.video.chapters.splice(n,1),this.ut(this.ot,this.video.duration)},n.ut=function(t,n){for(var i=0;i<t.cues.length;i++){var e=t.cues[i],r=t.cues[i+1],o=r?r.startTime:n;e.endTime=o,e.size=(o-e.startTime)/n}this.fire(Yi.CHAPTER_CUES_UPDATED)},n.addChapters=function(t,n){var i=this;0!==t.length&&n&&t.every((function(t){return void 0!==t.timecode&&t.timecode>=0&&t.timecode<n&&void 0!==t.title}))&&t.sort((function(t,n){return t.timecode-n.timecode})).forEach((function(e,r){return i.rt(e,n,t[r+1])}))},n.addCuePoint=function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.st||(this.st=this.F.addTextTrack("metadata"),this.st.mode="hidden",this.st.addEventListener("cuechange",(function(t){V(t.target.activeCues).forEach((function(t){n.fire(Yi.CUE_POINT,Ve.fromVTTCue(t))}))})),this.F.addEventListener("canplay",(function(t){n.st.mode="hidden"}))),t=parseFloat(t),isNaN(t))throw new TypeError("Time must be a number.");if(t<0||t>=this.duration)throw new TypeError("Time must be a positive number less than the duration of the video.");var e=new Ve(t,i);return this.st.addCue(e.vttCue),e},n.removeCuePoint=function(t){if(!t)throw new TelecineError("InvalidCuePoint","The specified cue point is not valid.");return this.st.removeCue(t.vttCue),!0},n.removeAllCuePoints=function(){var t=this;return this.st&&this.st.length&&V(this.st.cues).forEach((function(n){t.st.removeCue(n)})),!0},n.onerror=function(){if(!this.F.error)return!1;switch(this.F.error.code){case this.F.error.MEDIA_ERR_SRC_NOT_SUPPORTED:return this.at("MediaSrcNotSupportedError","The media was not suitable."),this.ct(),!1;case this.F.error.MEDIA_ERR_DECODE:return-1!==this.tt&&fe.iOS?(this.F.load(),this.currentTime=this.tt,this.tt=-1,!1):(this.at("MediaDecodeError","The media could not be decoded."),this.ct(),!1);case this.F.error.MEDIA_ERR_NETWORK:return this.at("MediaNetworkError","A network error ocurred while fetching the media."),!1;case this.F.error.MEDIA_ERR_ABORTED:return this.at("MediaAbortedError","The user agent aborted the fetching of the media."),!1;default:return this.at("MediaUnknownError","An unknown error occurred."),!1}},n.at=function(t,n){this.fire(Wi.ERROR,new TelecineError(t,n))},n.onended=function(){if(this.F.paused||this.F.pause(),this.currentTime<this.F.duration)return!1},n.onwaiting=function(){return!1},n.onwebkitbeginfullscreen=function(){this.Z=!0},n.onwebkitendfullscreen=function(){this.Z=!1},n.onwebkitpresentationmodechanged=function(){switch(this.F.webkitPresentationMode){case"picture-in-picture":this.F.controls=!0;break;case"inline":this.B.htmlScanner&&this.B.htmlScanner.controls||(this.F.controls=!1)}this.fire(Yi.PRESENTATION_MODE_CHANGE,this.F.webkitPresentationMode)},n.shouldHandleVideoEvent=function(t){return!0},n.handleVideoEvent=function(t){t.target===this.F&&!1!==this.shouldHandleVideoEvent(t)&&("function"==typeof this["on".concat(t.type)]&&!1===this["on".concat(t.type)](t)||this.fire(t.type))},n.swapVideo=function(t,n){var i=t.paused;this.removeVideoEventListeners(t),t.parentElement.replaceChild(n,t),t.pause(),n.currentTime=t.currentTime,i||n.play(),this.addVideoEventListeners(n),this.F=n},n.onexternaldisplayactivated=function(t){this.J||(this.F!==t.element&&(this.ht=this.F,this.swapVideo(this.F,t.element)),this.J=!0)},n.onexternaldisplaydeactivated=function(t){this.J&&(this.ht&&(this.swapVideo(t.element,this.ht),this.ht=null),this.J=!1)},n.setVideoSrc=function(t){this.F.src=t},n.canSeekTo=function(t){var n=this.duration;if(n&&t>n&&(t=n),this.F.seekable.length>0)for(var i=0,e=this.F.seekable.length;i<e;i++)if(this.F.seekable.start(i)<=t&&this.F.seekable.end(i)>=t)return!0;return!1},n.seekToTime=function(t){var n=this;return this.canSeekTo(t)?(this.F.currentTime=t,s.resolve(this.F.currentTime)):new s((function(i,e){var r=function e(){n.canSeekTo(t)&&(Object.keys(Wi).forEach((function(t){var i=Wi[t];n.F.removeEventListener(i,e)})),n.F.currentTime=t,i(n.F.currentTime))};Object.keys(Wi).forEach((function(t){var i=Wi[t];n.F.addEventListener(i,r)}))}))},n.takeSnapshot=function(){var t=this.V.querySelector("[telecine-snapshot]");t||((t=document.createElement("canvas")).setAttribute("telecine-snapshot",""),this.V.appendChild(t)),t.setAttribute("width","".concat(this.V.clientWidth,"px")),t.setAttribute("height","".concat(this.V.clientHeight,"px")),t.style.display="";var n=Pe(this.F.clientWidth,this.F.clientHeight,this.F.videoWidth,this.F.videoHeight),i=n.width,e=n.height,r=n.left,o=n.top;t.style.cssText="position:absolute;width:".concat(i,"px;height:").concat(e,"px;left:").concat(r,"px;top:").concat(o,"px");var u=t.getContext("2d");t.width>0&&t.height>0&&u.drawImage(this.F,0,0,t.width,t.height)},n.removeSnapshot=function(){var t=this.V.querySelector("[telecine-snapshot]");t&&(t.style.display="none")},n.getTrackById=function(t){if(this.it&&this.it[t])return this.it[t];if("function"==typeof this.F.textTracks.getTrackById)return this.F.textTracks.getTrackById(t);var n=document.getElementById(t);return n?n.track:null},n.initDrm=function(){var t=this.$.drmHandler;t&&t.init(this)},n.showExternalDisplayPicker=function(t){if(!this.q.length)throw new TelecineError("ExternalDisplayUnvailable","No external displays are available.");if(t){var n=this.q.filter((function(n){return n.constructor.displayName.replace("ExternalDisplay","")===t}))[0];if(!n)throw new TelecineError("InvalidExternalDisplay","The specified external display is not available.");n.showPicker()}else this.q[0].showPicker()},n.ft=function(){return this.dt.length<1?null:this.dt.slice(0).sort((function(t,n){return t.priority-n.priority}))[0]},n.vt=function(){var t=this.ft();t?this.currentFile=t:this.fire(Yi.SCANNER_ERROR,{reason:"all files failed"})},n.ct=function(){var t=this.dt.indexOf(this.W);this.dt.splice(t,1),this.vt()},n.G=function(){var t=this;if("mediaSession"in navigator){var n={title:this.$.title,artist:this.$.subtitle,artwork:[]};this.$.metadata.thumbnail&&n.artwork.push({src:this.$.metadata.thumbnail}),navigator.mediaSession.metadata=new MediaMetadata(n),"function"==typeof navigator.mediaSession.setActionHandler&&(navigator.mediaSession.setActionHandler("play",(function(){t.play().then((function(){return t.fire(Xi.MEDIASESSION_PLAY)})).catch(t.nt.bind(t))})),navigator.mediaSession.setActionHandler("pause",(function(){t.pause(),t.fire(Xi.MEDIASESSION_PAUSE)})),navigator.mediaSession.setActionHandler("seekforward",(function(){t.currentTime=Math.min(t.duration,t.currentTime+10),t.fire(Xi.MEDIASESSION_SEEK_FORWARD)})),navigator.mediaSession.setActionHandler("seekbackward",(function(){t.currentTime=Math.max(0,t.currentTime-10),t.fire(Xi.MEDIASESSION_SEEK_BACKWARD)})))}},W(t,[{key:"chaptersTrack",get:function(){return this.ot}},{key:"manifest",get:function(){return this.lt}},{key:"buffered",get:function(){return We.from(this.F.buffered)}},{key:"cuePoints",get:function(){return this.st?V(this.st.cues).map((function(t){return Ve.fromVTTCue(t)})):[]}},{key:"currentFile",get:function(){return this.W},set:function(n){var i=this,e=!this.F.paused,r=this.currentTime,o=!this.W||n.video.id!==this.W.video.id;if(o||this.takeSnapshot(),this.W=n,o&&(this.F.preload=this.X),this.constructor===t&&this.F.readyState>0&&(this.F.currentTime=0),(Ae.iOS||fe.android)&&this.W.video.title){var u=this.W.video.title;this.W.video.subtitle&&(u="".concat(u," ").concat(this.W.video.subtitle)),this.F.setAttribute("title",u)}else this.F.removeAttribute("title");this.setVideoSrc(this.W.src,o),this.fire(Yi.CURRENT_FILE_CHANGE,n),Ae.iOS&&!o&&this.play().catch(this.nt.bind(this)),this.constructor!==t||o?e&&this.play().catch(this.nt.bind(this)):(this.seekToTime(r).then((function(t){return e&&i.play().catch(i.nt.bind(i)),t})).catch((function(){})),this.once("canplay",(function(){return i.removeSnapshot()})),this.once("playing",(function(){return i.removeSnapshot()})))}},{key:"currentTime",get:function(){return this.F.currentTime},set:function(t){this.seekToTime(t)}},{key:"duration",get:function(){return this.F.duration}},{key:"ended",get:function(){return this.F.ended}},{key:"externalDisplayAvailable",get:function(){return this.q.some((function(t){return t.available}))}},{key:"externalDisplayActive",get:function(){return this.q.some((function(t){return t.active}))}},{key:"loop",get:function(){return this.F.loop},set:function(t){this.F.loop=t}},{key:"isLowerProfileAvailable",get:function(){return null}},{key:"muted",get:function(){return this.F.muted},set:function(t){this.F.muted=t}},{key:"playsinline",get:function(){return this.F.playsinline},set:function(t){this.F.playsinline=t,t?this.F.setAttribute("playsinline",""):this.F.removeAttribute("playsinline")}},{key:"paused",get:function(){return this.F.paused}},{key:"defaultPlaybackRate",get:function(){return this.F.defaultPlaybackRate},set:function(t){this.F.defaultPlaybackRate=t}},{key:"playbackRate",get:function(){return this.F.playbackRate},set:function(t){this.F.playbackRate=t}},{key:"played",get:function(){return this.F.played}},{key:"seekable",get:function(){return this.F.seekable}},{key:"seeking",get:function(){return this.F.seeking}},{key:"preload",get:function(){return this.X},set:function(t){this.F.preload=t,this.X=t}},{key:"presentationMode",get:function(){return this.F.webkitPresentationMode?this.F.webkitPresentationMode:"inline"},set:function(t){if(-1===this.supportedPresentationModes.indexOf(t))throw new TelecineError("InvalidPresentationMode","The “".concat(t,"” presentation mode is not supported."));"function"==typeof this.F.webkitSetPresentationMode&&this.F.webkitSetPresentationMode(t)}},{key:"supportedPresentationModes",get:function(){var t=["inline"];return"function"==typeof this.F.webkitSupportsPresentationMode&&this.F.webkitSupportsPresentationMode("picture-in-picture")&&t.push("picture-in-picture"),t}},{key:"video",get:function(){return this.$},set:function(t){var n=this;if(this.reactivate(),this.$!==t){if(this.$&&(this.$.off("filesrcupdate"),this.$.off("texttracksrcupdate")),this.removeAllCuePoints(),this.$=t,this.dt=t.files.filter((function(t){return-1!==n.constructor.supportedVideoTypes.indexOf(t.mime)})),this.$.on("filesrcupdate",(function(t){t===n.W&&n.vt()})),this.$.on("texttracksrcupdate",(function(t){n.video.currentScanner&&n.video.currentScanner.setSrcForTrack(t,t.src)})),this.B.externalDisplays&&this.B.externalDisplays.length){this.q=[];var i=this.constructor.supportedExternalDisplays;Array.isArray(i)||(i=[]);var e=i.map((function(t){return t.displayName}));this.B.externalDisplays.filter((function(t){return t.supported&&-1!==e.indexOf(t.displayName)})).forEach((function(i){var e=new i(t),r=i.displayName.replace("ExternalDisplay","");e.on(Wi.LOADED_METADATA,(function(t){return n.fire(Wi.LOADED_METADATA,t)})),e.on("available",(function(){return n.fire(qi.AVAILABLE,{type:r})})),e.on("unavailable",(function(){return n.fire(qi.UNAVAILABLE,{type:r})})),e.on("activated",(function(){"function"==typeof n.onexternaldisplayactivated&&n.onexternaldisplayactivated(e),n.fire(qi.ACTIVATED,{type:r})})),e.on("deactivated",(function(){"function"==typeof n.onexternaldisplaydeactivated&&n.onexternaldisplaydeactivated(e),n.fire(qi.DEACTIVATED,{type:r})})),n.q.push(e)}))}this.vt(),Ae.iOS&&this.q.forEach((function(t){"AirPlay"===t.constructor.displayName&&(t.element=n.F)})),this.initDrm()}}},{key:"videoElement",get:function(){return this.F}},{key:"videoWidth",get:function(){return this.F.videoWidth}},{key:"videoHeight",get:function(){return this.F.videoHeight}},{key:"volume",get:function(){return this.F.volume},set:function(t){this.F.volume=t}},{key:"readyState",get:function(){return this.F.readyState}}]),t}(),Je={};try{Je.Set=Set}catch(t){!function(t,n){var i=n(e.prototype,{size:{configurable:!0,get:function(){return this.pt.length}}});function e(t){n(this,{pt:{value:[]}}),t&&t.forEach(this.add,this)}function r(n,i){return-1<(t=n.pt.indexOf(i))}function o(t){return[t,t]}i.add=function(t){return r(this,t)||this.pt.push(t),this},i.clear=function(){var t=this.pt.length;this.pt.splice(0,t)},i.delete=function(n){return r(this,n)&&!!this.pt.splice(t,1)},i.entries=function(){return this.pt.map(o)},i.forEach=function(t,n){this.pt.forEach((function(i,e){t.call(n,i,i,this)}),this)},i.has=function(t){return r(this,t)},i.keys=i.values=function(){return this.pt.slice(0)},Je.Set=e}(0,Object.defineProperties)}var Qe=Je.Set;function Ze(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===t.length)return 0;for(var i=0,e=0,r=0;r<t.length;r++){var o=n[r]||1;e+=o,i+=t[r]*o}return i/e}function tr(t){if(0===t.length)return 0;for(var n=0,i=0;i<t.length;i++)n+=1/t[i];return t.length/n}function nr(t,n){if(t.sort(),0===t.length)return 0;if(n<=0)return t[0];if(n>=1)return t[t.length-1];var i=t.length*n,e=Math.floor(i),r=e+1,o=i%1;return r>=t.length?t[e]:t[e]*(1-o)+t[r]*o}function ir(t){t.sort((function(t,n){return t-n}));var n=Math.floor(t.length/2);return t.length%2?t[n]:(t[n-1]+t[n])/2}function er(){return"undefined"!=typeof performance?performance.now():Date.now()}function rr(){}var or=[],ur=[],sr=[];function ar(t,n,i){return i?n?n(t):t:(t&&t.then||(t=s.resolve(t)),n?t.then(n):t)}var cr=[],hr=function(){function t(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.retryCount,i=void 0===n?3:n,e=t.parallel,r=void 0===e?1:e,o=t.includeWithSpeeds,u=void 0===o||o,s=t.timeout,a=void 0===s?0:s,c=t.retryAbortErrors,h=void 0===c||c;this.wt=[],this.yt=new Qe,this.bt=new U,this.gt=i,this.Et=!1,this._t=!1,this.Tt=r,this.kt=u,this.At=a,this.St=h,this.Rt()}t.getPercentileSpeed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8,i=or.slice(-t);return nr(i,n)},t.getAverageSpeed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=or.slice(-t);return Ze(i,n)},t.getHarmonicAverageSpeed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=or.slice(-t);return tr(n)},t.getVolatilityScaler=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=or.slice(-t);if(n.length<3)return null;var i=Ze(n,[]),e=Math.min.apply(Math,it(n));return e/i},t.getMedianSpeed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=or.slice(-t);return ir(n)},t.getResponseSpeeds=function(){return or},t.getProgressSpeeds=function(){return cr},t.getFailedSegments=function(){return ur},t.getSuccessfulSegments=function(){return sr};var n=t.prototype;return n.add=function(t,n){var i=this;return new s((function(e,r){var o=i.Ot(t,e,r);i.Mt(o,n),i.Et&&!i._t&&i.It()}))},n.start=function(){this.Et||(this.Et=!0,this.It())},n.stop=function(){this.Et=!1},n.abort=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this.wt.filter((function(t){return!n||n===t.stream}));i.forEach((function(n){n.reject("Stream manually aborted"),t.fire("downloadabort",n.identifier)})),this.wt=this.wt.filter((function(t){return n&&n!==t.stream})),this.yt.forEach((function(t){n&&n!==t.stream||t.request.abort()}))},n.Dt=function(t){for(var n=0;n<this.wt.length&&!(this.wt[n].priority>t.priority);n++);this.wt.splice(n,0,t)},n.Rt=function(){var t=this;this.jt=new U,Wt(this),window.addEventListener("online",(function(){t.start(),t.Nt&&(t.Nt.resolve(),t.Nt=null)})),window.addEventListener("offline",(function(){t.stop(),t.abort(),t.Nt=new ht}))},n.Mt=function(t,n){t.hasOwnProperty("priority")?this.Dt(t):this.wt[n?"unshift":"push"](t)},n.It=function(){if(this.Et){this._t=!0;for(var t=this.Tt-this.yt.size,n=0;n<t;n++)this.Pt()}},n.Ot=function(t,n,i){var e=t;return t.id&&(e=t.id),Y({},t,{identifier:e,resolve:n,reject:i})},n.Ct=function(){0!==this.yt.size||0!==this.wt.length?this.yt.size<this.Tt&&this.It():this._t=!1},n.Pt=function(){if(0!==this.wt.length){var t=this.wt.shift(),n=t.url,e=t.byteRange,r=t.isInitSegmentRequest,o=t.identifier,u=t.timeout,s={stream:t.stream,data:{url:n,isInitSegmentRequest:r,requestSendTime:er(),uuid:([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(t){return(t^16*Math.random()>>t/4).toString(16)}))}},a=this.At,c=parseInt(u,10);c>=0&&(a=c);var h={url:n,type:i.SEGMENT,responseType:Bt.ARRAY_BUFFER,retry:this.gt,hooks:{beforeRetry:[this.xt.bind(this)]},onDownloadProgress:this.Lt(o,s),headers:e&&{Range:"bytes=".concat(e)},retryAbortErrors:this.St,timeout:a};this.fire("downloadstart",o),s.request=Pt(h).then(this.Ut(s,t)).catch(this.Ft(s,t)),this.yt.add(s)}else this._t=!1},n.xt=function(){try{var t=this;return function(n){var i=function(){if(t.Nt)return function(t,n){return t&&t.then?t.then(rr):s.resolve()}(t.Nt)}();if(i&&i.then)return i.then(rr)}()}catch(t){return s.reject(t)}},n.Lt=function(t,n){var i=this,e=0,r=0,o=er();return function(u){if(u.lengthComputable){var s=8*(u.loaded-r),a=er(),c=a-o,h={startTime:o,length:c,bitrate:s/(c/1e3),index:e};e>0&&(cr.length>=100&&cr.shift(),cr.push(h)),o=a,r=u.loaded,e+=1,i.jt.set(n,{bytesTotal:u.total,bytesLoaded:u.loaded,percent:u.loaded/u.total,identifier:t}),i.fire("progress",t)}}},n.Ut=function(t,n){var i=this,e=er(),r=n.identifier,o=n.resolve;return function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return s.resolve(t.apply(this,n))}catch(t){return s.reject(t)}}}((function(u){return ar(u.arrayBuffer(),(function(s){return t.data.duration=er()-t.data.requestSendTime,i.yt.delete(t),i.jt.delete(t),i.Ht(n,e,s.byteLength),i.fire("downloadend",r,{request:t,response:u}),sr.push({url:t.data.url,status:200,duration:t.data.duration}),ar(i.Vt(t,s),(function(t){o(s=t),i.Ct()}))}))}))},n.Ht=function(t,n,i){var e=t.includeWithBandwidthChecks,r=(er()-n)/1e3;if(i>8e3){var o=8*i/r;or.length>100&&or.shift(),this.kt&&e&&or.push(o)}},n.Vt=function(t,n){return t.data.url&&t.data.url.match(".ts$")?this.Bt(t,n):s.resolve(new Uint8Array(n))},n.Bt=function(t,n){try{var i=this;return function(t,n){var e=function(){if(!i.$t)return ar(at("module/mux-mp4.js"),(function(t){i.$t=new t({keepOriginalTimestamps:!0})}))}();return e&&e.then?e.then(n):n()}(0,(function(){return new s((function(e){i.$t.on("data",(function(n){i.$t.off("data");var r=new Uint8Array(n.initSegment.byteLength+n.data.byteLength);r.set(n.initSegment,0),r.set(n.data,n.initSegment.byteLength),e(t.data.isInitSegmentRequest?n.initSegment:r)})),i.$t.push(new Uint8Array(n)),i.$t.flush()}))}))}catch(t){return s.reject(t)}},n.Ft=function(t,n){var i=this,e=n.identifier,r=n.reject,o=n.size;return function(n){var u=er()-t.data.requestSendTime;if(t.data.duration=u,n instanceof pt)ur.push({url:t.data.url,status:"abort",duration:u}),i.fire("downloadabort",e);else if(n instanceof wt)ur.push({url:t.data.url,status:n.response.status,duration:u}),i.fire("downloaderror",e,n.response.status);else if(n instanceof yt){if(ur.push({url:t.data.url,status:"timeout",duration:u}),o>0&&n.timeoutMs>0){var s=8*o/(n.timeoutMs/1e3);s*=.5,or.push(s)}i.fire("downloadtimeout",e,"timeout")}i.jt.delete(t),i.yt.delete(t),r(n),i.Ct()}},W(t,[{key:"parallel",get:function(){return this.Tt},set:function(t){this.Tt=t}},{key:"pendingFetches",get:function(){var t=this,n=[];return this.yt.forEach((function(i){if(t.jt.get(i)){var e=t.jt.get(i);e.elapsedTime=er()-i.data.requestSendTime,n.push(e)}})),n}}]),t}(),fr=function(){function t(t){Wt(this),this.Wt=t,this.qt=null,this.Gt=null,this.Yt=!1,this.Kt=!0,this.zt=null,this.Xt=[],this.Jt=[],this.Qt=!1,this.Zt=null,this.tn=!1,this.nn=void 0,this.in=!1,this.rn=!0,this.un={},this.sn=this.an.bind(this),this.Wt.on("durationset",this.cn.bind(this))}var n=t.prototype;return n.addStream=function(t){var n=this;t.on("segmentadd",(function(){return n.hn()}));var i=this.Jt.push(t)-1;t.index=i,null===this.Gt&&(this.fn(i),this.Yt=!0)},n.streamIndexAtTime=function(t){return this.un[void 0]?{stream:this.activeStreamIndex}:this.un[Math.floor(t/6)]},n.switchTo=function(t){var n=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=t;"object"===B(t)&&(e=t.index);var r=this.Gt!==e,o=r;if(!r&&this.Yt&&(r=!0),r){this.Yt=!1;var u=this.Gt,a=this.Jt[u];this.fire("streamchangestart",u,e),a&&o&&i&&a.abort(),this.dn=e,this.fn(e)}return this.hn(),new s((function(t){r?n.vn=function(){n.dn===e&&(n.vn=null,t(),n.fire("streamchange",e))}:t()}))},n.isTimeInBuffer=function(t){for(var n=0;n<this.qt.buffered.length;n++){var i=this.qt.buffered.start(n),e=this.qt.buffered.end(n);if(i<=t&&e>=t)return!0}return!1},n.hasAppendedFinalSegment=function(){return void 0!==this.nn&&this.isTimeInBuffer(this.nn)},n.clear=function(){this.Jt.forEach((function(t){return t.clear()}))},n.remove=function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.Wt.ln.duration;return new s((function(e,r){n.Xt.push([t,i,e]),n.hn()}))},n.removeEventListeners=function(){this.qt&&this.qt.removeEventListener("updateend",this.sn)},n.cn=function(){var t=this.Wt.ln.duration,n=Math.floor(t/6);n+=6%t>1?1:0;for(var i=0;i<n;i++)this.un[i]={stream:null,segment:i,type:"video"}},n.pn=function(){this.qt.addEventListener("updateend",this.sn)},n.fn=function(t){this.Kt=!0,this.Gt=t,this.Wt.wn.streamIndex=t},n.an=function(){this.mn(),this.yn(),this.hn()},n.mn=function(){if(this.tn&&this.endTime)return this.tn=!1,this.nn=this.endTime,void this.Wt.checkEndOfStream();!this.activeStream.hasNextSegment()&&this.nn>0&&"open"===this.Wt.ln.readyState&&this.Wt.checkEndOfStream()},n.yn=function(){this.zt&&(this.fire("appendbufferend",this.zt),this.zt=null,this.vn&&this.vn())},n.hn=function(){if(this.qt){if(this.activeStream&&"closed"!==this.Wt.ln.readyState&&!this.qt.updating)if(this.Xt.length)this.bn();else if(!this.Qt&&!this.in)return this.Kt?(this.Kt=!1,void this.gn()):void this.En()}else this.on("sourcebufferattach",this.hn)},n.bn=function(){var t=this,n=nt(this.Xt.shift(),3),i=n[0],e=n[1],r=n[2];this.qt.addEventListener("updateend",(function n(i){t.qt.removeEventListener("updateend",n),r(),clearTimeout(t.Zt),t.Zt=setTimeout((function(){t.Qt=!1,t.hn()}),5e3)})),this.qt.remove(i,e)},n.gn=function(){var t=this;this.in=!0,this.activeStream.getInitSegment().then((function(n){return t.zt=null,t.qt.appendBuffer(n),t.in=!1,n})).catch((function(n){t.Kt=!0,t.in=!1}))},n.En=function(){var t=this.activeStream.getNextSegment();if(null!==t){var n=this.activeStream.getIdForSegment(t);this.activeStream.isFinal(t)&&(this.tn=!0),this.zt=n,this.fire("appendbufferstart",n);try{this.qt.appendBuffer(t),this.un[n.segment]=n,this.rn&&(this.rn=!1,this.fire("initialbufferstart"))}catch(n){if("QuotaExceededError"===n.name){if(this.Qt=!0,this.fire("quotaexceedederror",this.qt.buffered),this.Wt.F.currentTime>6){var i=this.Wt.F.currentTime-6;this.Wt.removeBuffer(0,i)}this.activeStream._n.unshift(t)}}}},W(t,[{key:"streams",get:function(){return this.Jt}},{key:"activeStreamIndex",get:function(){return this.Gt}},{key:"activeStream",get:function(){return this.Jt[this.Gt]}},{key:"sourceBuffer",get:function(){return this.qt},set:function(t){this.qt=t,this.pn(),this.fire("sourcebufferattach")}},{key:"endTime",get:function(){var t=this.qt.buffered;if(t.length>0)return t.end(t.length-1)}}]),t}(),dr=function(){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new hr;Wt(this),this._n=[],this.Tn=t,this.Kt=!0,this.kn=NaN,this.An=n,this.Sn=i,this.Sn.start(),this.Rn=new U,this.On={}}t.isValidSegmentUrl=function(t){return"string"==typeof t||"string"==typeof t.url&&"string"==typeof t.byteRange};var n=t.prototype;return n.getIdForSegment=function(n){return t.isValidSegmentUrl(n)?this.On[n]:this.Rn.get(n).id},n.isFinal=function(t){return this.Rn.get(t).final},n.addSegment=function(n){var i=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.identifier,o=void 0===r?null:r,u=e.isFinalSegment,a=void 0!==u&&u,c=e.loadOnly,h=void 0!==c&&c,f=e.priority,d=void 0===f?0:f,v=e.includeWithBandwidthChecks,l=void 0===v||v,p=e.timeout,w=void 0===p?null:p,m=e.size,y=void 0===m?null:m;return this.Kt&&this.getInitSegment(),t.isValidSegmentUrl(n)?(this.On[n]=o||n,this.fire("queued",this.getIdForSegment(n)),this.Sn.add({url:n.url||n,byteRange:n.byteRange,id:this.getIdForSegment(n),stream:this,includeWithBandwidthChecks:l,isInitSegmentRequest:!1,priority:d,timeout:w,size:y}).then((function(t){i.Rn.set(t,{id:o||n,final:a}),i._n.push(t),i.fire("bufferqueueadd",i.getIdForSegment(n)),h||i.fire("segmentadd")}))):(this.Rn.set(n,{id:o,final:a}),this._n.push(n),this.fire("bufferqueueadd",o),s.resolve())},n.clear=function(){this._n=[]},n.abort=function(){var t=this;this.getInitSegment().then((function(){t.Sn.abort(t)})).catch((function(t){}))},n.hasNextSegment=function(){return this._n.length>0},n.getNextSegment=function(){return 0===this._n.length?null:this._n.shift()},n.getInitSegment=function(){var n=this;this.Kt=!1;var i=this.Tn.url||this.Tn;return t.isValidSegmentUrl(i)?this.Sn.add({url:i,byteRange:this.Tn.byteRange,id:null,stream:this,isInitSegmentRequest:!0}).then((function(t){return n.Tn=t,n.Tn})):s.resolve(this.Tn)},W(t,[{key:"codec",get:function(){return this.An},set:function(t){this.An=t}},{key:"index",get:function(){return this.kn},set:function(t){this.kn=t}},{key:"pendingFetches",get:function(){return this.Sn.pendingFetches}}]),t}(),vr=function(){function t(t){this.F=t,this.Et=!1,this.Mn=null,this.In={},this.Dn={},this.jn=0,this.Nn=0,this.Pn="default",this.bound={startCheckingDroppedFrames:this.Cn.bind(this),stopCheckingDroppedFrames:this.xn.bind(this)}}var n=t.prototype;return n.start=function(){return this.Cn(),this},n.stop=function(){return this.xn(),this},n.destroy=function(){this.xn(),this.Ln()},n.getDroppedFrameRate=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"average",e=this.In[n];if(!e)return 0;if(e.length<t)return 0;var r=e.slice(-t);return"median"===i?ir(r):Ze(r)},n.getDroppedFrameTotal=function(){return{dropped:this.Un(),total:this.Fn()}},n.pn=function(){this.F.addEventListener("playing",this.bound.startCheckingDroppedFrames),this.F.addEventListener("pause",this.bound.stopCheckingDroppedFrames),this.F.addEventListener("ended",this.bound.stopCheckingDroppedFrames)},n.Ln=function(){this.F.removeEventListener("playing",this.bound.startCheckingDroppedFrames),this.F.removeEventListener("pause",this.bound.stopCheckingDroppedFrames),this.F.removeEventListener("ended",this.bound.stopCheckingDroppedFrames)},n.Cn=function(){this.Et=!0,this.Hn()},n.xn=function(){this.Et=!1},n.Hn=function(){var t=this;if(this.Et&&null!==this.Pn){clearTimeout(this.Mn);var n=this.Un(),i=n-this.jn;this.jn=n;var e=this.Vn(),r=e-this.Nn;this.Nn=e,this.In[this.Pn]||(this.In[this.Pn]=[]),this.Dn[this.Pn]||(this.Dn[this.Pn]=[]),this.In[this.Pn].length>100&&this.In[this.Pn].shift(),this.Dn[this.Pn].length>100&&this.Dn[this.Pn].shift(),this.In[this.Pn].push(i),this.Dn[this.Pn].push(r),this.Mn=setTimeout((function(){t.Hn()}),1e3)}},n.Un=function(){return"function"==typeof this.F.getVideoPlaybackQuality?this.F.getVideoPlaybackQuality().droppedVideoFrames:this.F.webkitDroppedFrameCount||0},n.Fn=function(){return"function"==typeof this.F.getVideoPlaybackQuality?this.F.getVideoPlaybackQuality().totalVideoFrames:this.F.webkitDecodedFrameCount||0},n.Vn=function(){if("function"==typeof this.F.getVideoPlaybackQuality){var t=this.F.getVideoPlaybackQuality();return t.totalVideoFrames-t.droppedVideoFrames-t.corruptedVideoFrames}return this.F.webkitDecodedFrameCount||0},W(t,[{key:"streamIndex",get:function(){return this.Pn},set:function(t){this.Pn=t}}]),t}(),lr=function(){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.F=t,this.B=n,Wt(this);var i=this.B,e=i.fetcherTimeout,r=void 0===e?0:e,o=i.fetcherRetryAbortErrors,u=void 0===o||o;this.wn=new vr(t),this.ln=new MediaSource,this.Sn=new hr({parallel:1,timeout:r,retryAbortErrors:u}),this.Bn={},this.$n=[],this.Wn=null,this.qn=this.Gn.bind(this),this.pn()}var n=t.prototype;return n.switchTo=function(t){return 1===this.$n.length&&this.video.switchTo(t)},n.getCurrentSpeed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.type,i=void 0===n?"average":n,e=t.howMany,r=void 0===e?10:e,o=t.weights,u=void 0===o?[]:o,s=t.percentile,a=void 0===s?null:s;return"harmonicAverage"===i?hr.getHarmonicAverageSpeed(r):"average"===i?hr.getAverageSpeed(r,u):"median"===i?hr.getMedianSpeed(r):hr.getPercentileSpeed(r,a)},n.getVolatilityScaler=function(t){return hr.getVolatilityScaler(t)},n.getResponseSpeeds=function(){return hr.getResponseSpeeds()},n.getFailedSegments=function(){return hr.getFailedSegments()},n.getSuccessfulSegments=function(){return hr.getSuccessfulSegments()},n.getDroppedFrameRate=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeStreamIndex,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"average";return this.wn.getDroppedFrameRate(t,n,i)},n.getDroppedFrameTotal=function(){return this.wn.getDroppedFrameTotal()},n.clear=function(){this.$n.forEach((function(t){return t.clear()}))},n.streamIndexAtTime=function(t,n){return this.Bn[n].streamIndexAtTime(t)?this.Bn[n].streamIndexAtTime(t).stream:null},n.removeBuffer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.F.duration;if(t>=(n=n||0))return s.resolve();var i=this.$n.map((function(i){return i.remove(t,n)}));return s.all(i)},n.addStream=function(t,n){var i=this,e=this.Yn(t);if(!this.Bn[e]){var r=new fr(this,e);this.Bn[e]=r,this.$n.push(r),this.readyPromise.then((function(){var n;try{n=i.ln.addSourceBuffer(t)}catch(t){if(22!==t.code)return void i.fire("srcnotsupported",t);n=i.Bn[e]}i.B.duration&&(n.appendWindowEnd=i.B.duration+.1),r.sourceBuffer=n})).catch((function(t){})),["appendbufferstart","appendbufferend","streamchange","streamchangestart","initialbufferstart","quotaexceedederror"].forEach((function(t){r.on(t,(function(n){i.fire(t,n)}))}))}var o=new dr(n,t,this.Sn);return["queued","bufferqueueadd"].forEach((function(t){o.on(t,(function(n){i.fire(t,n)}))})),this.Bn[e].addStream(o),o},n.checkEndOfStream=function(){var t=this;this.$n.every((function(t){return t.hasAppendedFinalSegment()}))&&this.F.addEventListener("timeupdate",(function n(){t.F.removeEventListener("timeupdate",n),t.$n.every((function(n){return n.isTimeInBuffer(t.F.currentTime)}))&&t.endOfStream()}))},n.abortFetches=function(){this.Sn.abort()},n.endOfStream=function(){"open"===this.ln.readyState&&(this.Kn()||(this.ln.endOfStream(),this.fire("endofstream")))},n.destroy=function(){this.clear(),this.zn(),this.off(),this.wn.destroy(),this.Sn.abort(),this.F.src&&(this.F.removeAttribute("src"),this.F.load())},n.pn=function(){var t=this;this.readyPromise=new s((function(n,i){t.Wn=n,t.ln.addEventListener("sourceopen",t.qn)})),["downloadstart","downloadend","downloadabort","downloaderror","downloadtimeout","progress"].forEach((function(n){t.Sn.on(n,(function(){for(var i=arguments.length,e=new Array(i),r=0;r<i;r++)e[r]=arguments[r];t.fire.apply(t,[n].concat(e))}))}))},n.Kn=function(){for(var t=0;t<this.ln.sourceBuffers.length;t++)if(this.ln.sourceBuffers[t].updating)return!0;return!1},n.Gn=function(){URL.revokeObjectURL(this.F.src),this.ln.removeEventListener("sourceopen",this.qn),this.B.duration&&(this.ln.duration=this.B.duration,this.fire("durationset")),this.Wn()},n.zn=function(){this.$n.forEach((function(t){return t.removeEventListeners()}))},n.Yn=function(t){return 0===t.indexOf("audio")?"audio":"video"},W(t,[{key:"mediaSource",get:function(){return this.ln}},{key:"pendingFetches",get:function(){return this.Sn.pendingFetches}},{key:"streams",get:function(){return 1===this.$n.length&&this.video.streams}},{key:"activeStreamIndex",get:function(){return 1===this.$n.length&&this.video.activeStreamIndex}},{key:"video",get:function(){return!!this.Bn.video&&this.Bn.video}},{key:"audio",get:function(){return!!this.Bn.audio&&this.Bn.audio}}]),t}(),pr=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n)||this).B=e,i.blacklisted=[],i.whitelisted=[],i.MAX_LOADABLE_SEGMENTS_AUTO=3,i.MAX_LOADABLE_SEGMENTS_LOCKED=15,i.SEGMENT_DURATION=6,i}K(n,t),W(n,[{key:"displayName",get:function(){return"MediaSource"}}]);var i=n.prototype;return i.isTimeInBuffer=function(t,n,i){return this.Xn(t,t,n,i,1)},i.getDistanceFromBuffer=function(t,n){for(var i=t,e=0;e<n.length;e++)if(n.start(e)<=t&&n.end(e)>=t){i=n.end(e);break}return i-t},i.blacklist=function(t){this.blacklisted[t]=1},i.lock=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.whitelisted=t},i.filterStreams=function(t,n,i){for(var e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=[],u=!1,s=0;s<t.length;s++)if(e&&e[0]===t[s].width&&e[1]===t[s].height)o.push(t[s]);else{if(u)break;if(!(this.blacklisted[s]&&-1===this.whitelisted.indexOf(s)||this.whitelisted.length&&-1===this.whitelisted.indexOf(s)))if(this.whitelisted.length)o.push(t[s]);else{var a=this.Jn(n,i,t[s].width,t[s].height,r),c=1e3/(window.devicePixelRatio||1),h=i<c?1.75:1;a>=h&&(u=!0),o.push(t[s]),e=[t[s].width,t[s].height]}}return o},i.getCurrentSpeed=function(){var t="average",n=3,i=[1,2,5];return this.B.tests&&this.B.tests.harmonic_average&&this.B.tests.harmonic_average.group&&(t="harmonicAverage",n=this.Qn(),i=[]),this.scanner.sorcerer.getCurrentSpeed({type:t,howMany:n,weights:i})},i.getAudioIndexFromVideo=function(t,n,i){if(0===n.length)return!1;if(!t[i])return 0;for(var e=0;e<n.length;e++){if(n[e].bitrate<8e4&&t[i].bitrate<5e5)return e;if(n[e].bitrate>144e3&&t[i].bitrate>1e6)return e}return 0},i.Zn=function(t,n,i,e){var r=i/e,o=t-n*r,u=n-t/r,s=t-o,a=n-u;return o>0&&(a=n),u>0&&(s=t),[s,a]},i.Jn=function(t,n,i,e){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=this.Zn(t,n,i,e),u=i*e;r&&(u*=r);var s=window.devicePixelRatio||1,a=o[0]*o[1]*s*s;return u/a},i.Qn=function(){var t=Ue(this.B,"lookahead_count");return t&&t.group&&t.data.count?t.data.count:t&&t.data.segment_lookahead_count?t.data.segment_lookahead_count:this.MAX_LOADABLE_SEGMENTS_AUTO},i.ti=function(t,n,i){var e=i&&i.bitrate>11e6;return 1===this.whitelisted.length?e?30:this.MAX_LOADABLE_SEGMENTS_LOCKED*this.SEGMENT_DURATION:this.Qn()*this.SEGMENT_DURATION},i.Xn=function(t,n,i,e){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!i)return!1;n=Math.min(n,e);for(var o=0;o<i.length;o++){var u=Le(i.start(o))-r,s=Le(i.end(o))+r;if(u<=t&&s>=n)return!0}return!1},i.ni=function(t){return t.video.length>0&&t.audio.length>0},i.ii=function(t,n,i,e){var r=1;return this.ni(e)&&(r=.05),this.Xn(t.start,t.end,n,i,r)},n}(function(){function t(t){this.scanner=t}W(t,[{key:"displayName",get:function(){return"Brain"}}]);var n=t.prototype;return n.shouldPowerUp=function(t,n){return!1},n.shouldPowerDown=function(t,n){return!1},n.canPowerUp=function(t,n){return 1!==t.length&&n<t.length-1},n.canPowerDown=function(t,n){return 1!==t.length&&n>0},n.filterStreams=function(t){return t},t}()),wr=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).BANDWIDTH_UPSWITCH_THRESHOLD=.85,i.BANDWIDTH_DOWNSWITCH_THRESHOLD=.9,i}K(n,t),W(n,[{key:"displayName",get:function(){return"Skyfire"}}]);var i=n.prototype;return i.shouldPowerUp=function(t,n,i){i&&this.B.startingBandwidthThreshold&&(this.BANDWIDTH_UPSWITCH_THRESHOLD=this.B.startingBandwidthThreshold);var e=t.indexOf(n);if(-1===e&&(e=0),!this.canPowerUp(t,e))return s.resolve(!1);var r=this.getCurrentSpeed();if(!r)return s.resolve(!1);var o=this.ei(r,this.BANDWIDTH_UPSWITCH_THRESHOLD,t);if(o===e)return s.resolve(!1);var u=Ue(this.B,"upswitch_health");return u&&u.group&&!i&&o>e&&ft(this.scanner.currentTime,this.scanner.F.buffered)<1.5*this.SEGMENT_DURATION?s.resolve(!1):s.resolve(o)},i.shouldPowerDown=function(t,n){var i=t.indexOf(n);if(-1===i){var e=this.isTimeInBuffer(this.scanner.F.duration,this.scanner.F.buffered,this.scanner.F.duration);return this.whitelisted.length||this.blacklisted.length||!e?s.resolve(t.length-1):s.resolve(!1)}if(!this.canPowerDown(t,i))return s.resolve(!1);var r=this.getCurrentSpeed();if(!r)return s.resolve(!1);if(this.hasTooManyDroppedFrames(i,n,this.B.droppedFrameSwitchPercent))return s.resolve(i-1);var o=this.ei(r,this.BANDWIDTH_DOWNSWITCH_THRESHOLD,t);return o===i?s.resolve(!1):s.resolve(o)},i.hasTooManyDroppedFrames=function(t,n,i){return this.scanner.sorcerer.getDroppedFrameRate(10,t,"median")/n.framerate*100>=i&&(this.blacklist(t),!0)},i.getTimeEstimateToLoad=function(t,n){if(null===n)return 3;var i=n.segments[t],e=i.end-i.start,r=this.getCurrentSpeed();return e*(n.bitrate+n.audioBitrate)/r*1.3},i.canPlayFromTimeInStream=function(t,n){if(!this.isTimeInBuffer(t,this.scanner.F.buffered,this.scanner.F.duration))return!1;if(!n)return!1;var i=this.getSegmentsToLoad(!1,"video",n);if(0===i.length)return!0;var e=ft(t,this.scanner.F.buffered);return this.getTimeEstimateToLoad(i[0],n)<e},i.getSegmentsToLoad=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video",i=arguments.length>2?arguments[2]:void 0,e=this.scanner.F,r=this.scanner.currentTime,o=[],u=this.ti(r,e.duration,i),s=r+u,a=this.scanner.sorcerer[n].activeStreamIndex,c=this.scanner.Jt[n][a];if(!c)return o;var h=this.scanner.sorcerer[n].sourceBuffer,f=null;h&&(f=h.buffered);for(var d=0;d<c.segments.length;d++){var v=c.segments[d];if(!(v.end<r||v.start>s)){var l=r>=v.start&&r<v.end,p=this.ii(v,f,this.scanner.F.duration,this.scanner.Jt);!t&&p||t&&p&&l||(l?o.push(d):s>=v.start&&o.push(d))}}return o},i.ei=function(t,n,i){for(var e=0,r=e;r<i.length;r++)t*n>i[r].bitrate+i[r].audioBitrate&&(e=r);return e},n}(pr),mr=function(t){function n(n){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,r)||this).ri=r.tests.ml_brain.data.mimir_url,i.oi=r.tests.ml_brain.data.geolocation,i.ui={},i.si=null,i.ai=[],i.ci=[],i.hi=[],i.fi=[],i.di=[],i.vi=[],i.li=[],i.pi=null,i.wi=null,i.mi=null,i.yi=!1,i.bi=!1,i.gi=0,i.Ei=[],i.scanner.on(Yi.DOWNLOAD_START,i._i.bind(tt(i))),i.scanner.on(Yi.DOWNLOAD_END,i.Ti.bind(tt(i))),i.scanner.on(Yi.APPEND_BUFFER_END,i.ki.bind(tt(i))),e.hooks.beforeRequest.push(i.Ai),e.hooks.afterResponse.push(i.Si),i}K(n,t),W(n,[{key:"displayName",get:function(){return"ML"}}]);var i=n.prototype;return i._i=function(t){var n=t.identifier;"video"===n.type&&(this.wi={index:n.segment,streamIndex:n.stream,complete:null}),"audio"===n.type&&(this.mi={index:n.segment,streamIndex:n.stream,complete:null})},i.Ri=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video";return"video"===n?null!==this.wi&&this.wi.index===t.segment&&this.wi.streamIndex===t.stream:"audio"===n&&null!==this.mi&&this.mi.index===t.segment},i.Oi=function(){return null!==this.wi||null!==this.mi},i.Ti=function(t){var n=t.identifier,i=t.data,e=i.request,r=i.response,o=e.data.duration/1e3,u=r.body.byteLength;"video"===n.type&&this.Ri(n,"video")&&(this.wi.complete={downloadTime:o,byteLength:u,uuid:e.data.uuid},this.bi||(this.Mi(n.stream,n.segment-1,o,u),this.bi=!0)),"audio"===n.type&&this.Ri(n,"audio")&&(this.mi.complete={downloadTime:o,byteLength:u,uuid:e.data.uuid})},i.ki=function(t){var n=this,i=t.identifier,e=function(t,e,r){n.Mi(i.stream,i.segment-1,t,e,r),n.wi=null,n.mi=null};if(this.ni(this.scanner.Jt)){if(this.Ri(i,"video")&&this.Ri(i,"audio")&&null!==this.wi.complete&&null!==this.mi.complete){var r=this.wi.complete,o=this.mi.complete;e(r.downloadTime+o.downloadTime,r.byteLength+o.byteLength,r.uuid)}}else if(this.Ri(i,"video")&&null!==this.wi.complete){var u=this.wi.complete;e(u.downloadTime,u.byteLength,u.uuid)}},i.Mi=function(t,n,i,e,r){var o=this.scanner.Jt.video[t],u=this.scanner.sorcerer.video.sourceBuffer;u&&o&&(this.ai.push(this.getTotalBufferDuration()),this.fi.push(ft(this.scanner.currentTime,u.buffered)),this.di.push(t),this.ci.push(i),this.hi.push(e),this.vi.push(o.segments.length-n),this.li.push(r))},i.handleScrubEnd=function(t){var n=this.ci.length,i=n?this.ci[n-1]:0,e=this.hi.length,r=e?this.hi[e-1]:0,o=this.scanner.Jt.video[t],u=this.Ii(o),s=u?u.index:this.vi[this.vi.length-1],a=this.li.length?this.li[this.li.length-1]:"";this.Mi(t,s,i,r,a)},i.shouldPowerUp=function(t,n,i){var e=t.indexOf(n);if(-1===e&&(e=0),1===this.whitelisted.length)return this.whitelisted[0]>e?s.resolve(0):s.resolve(!1);if(1===this.scanner.Jt.video.length)return s.resolve(!1);if(!this.canPowerUp(t,e))return s.resolve(!1);if(this.scrubInProgress)return s.resolve(!1);var r=this.Ii(n);if(null===r)return s.resolve(!1);var o={index:r.index,streamIndex:r.streamIndex},u=r.index;if(null!==this.si&&this.si.index===o.index&&this.si.streamIndex===o.streamIndex)return s.resolve(!1);if(!(u in this.ui))return this.Di(o,t,n).then((function(t){return t>e&&t})).catch(console.error);var a=this.ui[u];return a>e?s.resolve(a):s.resolve(!1)},i.shouldPowerDown=function(t,n){var i=t.indexOf(n);if(-1===i){var e=this.isTimeInBuffer(this.scanner.F.duration,this.scanner.F.buffered,this.scanner.F.duration);return this.whitelisted.length||this.blacklisted.length||!e?s.resolve(t.length-1):s.resolve(!1)}if(1===this.whitelisted.length)return this.whitelisted[0]<i?s.resolve(0):s.resolve(!1);if(1===this.scanner.Jt.video.length)return s.resolve(!1);if(!this.canPowerDown(t,i))return s.resolve(!1);if(this.scrubInProgress)return s.resolve(!1);var r=this.Ii(n);if(null===r)return s.resolve(!1);var o={index:r.index,streamIndex:r.streamIndex},u=r.index;if(null!==this.si&&this.si.index===o.index&&this.si.streamIndex===o.streamIndex)return s.resolve(!1);if(!(u in this.ui))return this.Di(o,t,n).then((function(t){return t<i&&t})).catch(console.error);var a=this.ui[u];return a<i?s.resolve(a):s.resolve(!1)},i.getTotalBufferDuration=function(){var t=this.scanner.sorcerer.video.sourceBuffer,n=0;if(!t)return n;for(var i=0;i<t.buffered.length;i++){var e=t.buffered.start(i);n+=t.buffered.end(i)-e}return n},i.canPlayFromTimeInStream=function(t,n){return!!this.isTimeInBuffer(t,this.scanner.F.buffered,this.scanner.F.duration)&&!!n},i.ji=function(t){var n=t.slice(0);if(n.length<8){for(var i=8-n.length,e=0;e<i;e++)n.unshift(0);return n}return n.slice(n.length-8,n.length)},i.Ni=function(t,n){for(var i=this,e={240:1,360:2,480:3,540:3,720:4,1080:5,1440:6,2160:7},r={240:0,360:1,480:2,540:2,720:3,1080:4,1440:5,2160:6},o=[0,0,0,0,0,0,0,0],u=[0,0,0,0,0,0,0,0],s=0;s<n.length;s++){var a=n[s],c=parseInt(a.quality,10);c in e&&(o[e[c]]=1);var h=this.getAudioIndexFromVideo(n,this.Ei,s),f=null;!1!==h&&(f=this.Ei[h]);for(var d=0;d<a.segments.length;d++)if(d===t&&c in r){var v=a.segments[d].size,l=f?f.segments[d].size:0;u[r[c]]=v+l}}var p=this.di.map((function(t){return parseInt(i.scanner.Jt.video[t].quality,10)}));return{availableQualities:o,nextChunkSizes:u,lastBufferSizes:this.ji(this.ai),lastChunkDownloadTimes:this.ji(this.ci),lastChunkSizes:this.ji(this.hi),lastChunkQualities:this.ji(p),numRemainingChunks:this.ji(this.vi),lastPlaybackHeads:this.ji(this.fi),geolocation:[[this.oi]]}},i.Pi=function(t,n){for(var i=-1,e=-1,r=0;r<t.length;r++)t[r]>e&&(e=t[r],i=r);for(var o=[],u=0;u<n.length;u++)1===n[u]&&o.push(u);return{1:240,2:360,3:540,4:720,5:1080,6:1440,7:2160}[o[i]]},i.Ci=function(t,n){for(var i=0;i<n.length;i++){var e=parseInt(n[i].quality,10);if(e===t)return i;if(480===e&&540===t)return i}return 0},i.Ai=function(t){t.startTime=Me()},i.Si=function(t,n){return n.duration=Ie(t.startTime),n},i.Di=function(t,n,i){var e=this,r=this.Ni(t.index,n);return this.si=t,Pt.post(this.ri,{json:{inputs:r},timeout:2e3}).then((function(i){var o=JSON.parse(i.body),u=e.Pi(o.outputs[0],r.availableQualities),s=e.Ci(u,n);if(e.ui[t.index]=s,e.li.length&&e.pi){var a=e.li[e.li.length-1];e.scanner.fire(Ji.BRAIN_ML_MODEL_INPUTS,Y({chunkRequestID:a,duration:i.duration,geolocation:e.oi},e.pi))}return e.pi=r,e.si=null,s})).catch((function(n){if(n instanceof wt){var i={status:n.response.status,resp:n.response.body,url:e.ri};e.scanner.fire(Ji.BRAIN_ML_MODEL_ERR,i),e.gi++}if(n instanceof yt){var r={url:e.ri};e.scanner.fire(Ji.BRAIN_ML_MODEL_TIMEOUT,r),e.gi++}if(n instanceof mt){var o={url:e.ri};e.scanner.fire(Ji.BRAIN_ML_MODEL_NET_ERR,o),e.gi++}e.gi>=2&&e.scanner.resetBrain(!0);var u=t.streamIndex;return e.ui[t.index]=u,e.si=null,u}))},i.Ii=function(t){var n=this.scanner.sorcerer.video.sourceBuffer,i=null;if(n&&(i=n.buffered),null===i)return null;for(var e=this.xi(t),r=0;r<e.length;r++){var o=e[r].segment;if(!this.ii(o,i,this.scanner.F.duration,this.scanner.Jt))return e[r]}return null},i.xi=function(t){var n=this.scanner.F,i=this.scanner.currentTime,e=i+this.ti(i,n.duration,t),r=[],o=this.scanner.sorcerer.video.activeStreamIndex,u=this.scanner.Jt.video[o];if(!u)return r;for(var s=0;s<u.segments.length;s++){var a=u.segments[s];a.end<i||a.start>e||(i>=a.start&&i<a.end||e>=a.start)&&r.push({segment:a,index:s,streamIndex:o})}return r},i.Li=function(t,n){var i=this;Object.keys(this.ui).filter((function(n){return-1===t.indexOf(parseInt(n,10))})).forEach((function(t){var e=i.ui[t],r=i.scanner.Jt.video[e].segments[t];i.ii(r,n,i.scanner.F.duration,i.scanner.Jt)||delete i.ui[t]}))},i.getSegmentsToLoad=function(t,n,i){var e=this.xi(i),r=this.scanner.sorcerer[n].sourceBuffer,o=null;r&&(o=r.buffered),this.Li(e.map((function(t){return t.index})),o);for(var u=[],s=0;s<e.length;s++){var a=e[s].segment,c=e[s].index,h=this.ii(a,o,this.scanner.F.duration,this.scanner.Jt),f=c in this.ui;h||!f&&1!==this.whitelisted.length&&1!==this.scanner.Jt.video.length||u.push(c)}return u},W(n,[{key:"audioStreams",set:function(t){this.Ei=t}},{key:"scrubInProgress",set:function(t){this.yi=t},get:function(){return this.yi}}]),n}(pr),yr=function(){function t(t,n){this.F=t,this.Ui=n}var n=t.prototype;return n.start=function(){return clearInterval(this.Fi),this.Fi=setInterval(this.Hi.bind(this),200),this.Hi()},n.stop=function(){clearInterval(this.Fi)},n.Hi=function(){var t=this.F.buffered,n=this.F.currentTime,i=this.Vi(t,n);if(0===this.F.readyState)return!1;if(this.F.seeking)return!1;if(this.F.paused)return!1;var e=this.F.duration;if(n>=e)return this.F.currentTime=e-.1,!0;if(t.length<=i)return!1;var r=t.start(i);return!(r>=e)&&(0===i&&(this.stop(),this.Bi("audio",r),this.Bi("video",r),this.F.currentTime=r,!0))},n.Vi=function(t,n){if(!t||!t.length)return null;for(var i=0;i<t.length;i++){var e=t.start(i),r=t.end(i);if(e>n&&(0===i||r-n<=.1))break}return i>=0?i:null},n.Bi=function(t,n){var i=this.Ui(0,t);i&&i.segments&&i.segments[0]&&(i.segments[0].start=n)},t}(),br=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).reset(),i.manifestLoadDurations=[],e.mediaSourceScanner&&(i.$i=e.mediaSourceScanner.maxPreloadStreamIndex),i}K(n,t),W(n,null,[{key:"displayName",get:function(){return"MediaSourceScanner"}},{key:"supported",get:function(){return"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported}},{key:"supportedVideoTypes",get:function(){return["application/vnd.vimeo.dash+json","video/vnd.mpeg.dash.mpd"]}}]);var e=n.prototype;return e.deactivate=function(){t.prototype.deactivate.call(this),this.sorcerer&&this.sorcerer.destroy(),this.reset()},e.reset=function(){this.Wi=new Qe,this.qi={},this.Gi=new yr(this.F,this.Ui.bind(this)),this.resetBrain(),this.Yi=!1,this.Ki=!1,this.lt=null,this.Jt={},this.Jt.audio=[],this.Jt.video=[],this.Ei=[],this.zi=null,this.Xi=null,this.Ji=null,this.Qi=null,this.Zi=null,this.te=null,this.ne=!1,this.ee=null,this.re=!1,this.oe=!1,this.ue=null,this.se=null,this.ae=!1,this.ce=[],this.he={},this.fe=0,this.de=null,clearInterval(this.ve),clearTimeout(this.le)},e.resetBrain=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.B.mediaSourceScanner||{};if(n.tests=this.B.tests,t){var i=Fe(this.pe);return this.pe=new wr(this,n),void(i&&this.fire(Ji.BRAIN_ML_SWITCH_TO_SKYFIRE))}this.pe=new wr(this,n);var e=Ue(n,"ml_brain");e&&e.group&&e.data.use_model&&(this.pe=new mr(this,n))},e.preloadStream=function(){var t=this;if(this.ue)return this.ue;var n=0,i=1;this.Jt.audio.length&&(i=2);var e=this.sorcerer.video.activeStreamIndex;this.ce.length&&(e=this.ce[0]);var r=0,o=this.pe.getSegmentsToLoad(!1,"video",e);o.length>0&&(r=o[0]);var u=function(){},a=function(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n&&(e=t.sorcerer.video.activeStreamIndex),t.de=e,t.we(!0)},c=function(e){(n+=1)<i||(e.segment===r&&0===t.ce.length?t.me(!0).then((function(i){if(!1!==i&&i>e.stream){if(t.sorcerer.video.switchTo(i,!1),t.Jt.audio.length){var r=t.pe.getAudioIndexFromVideo(t.Jt.video,t.Jt.audio,i);t.sorcerer.audio.switchTo(r,!1)}return n=0,void a(!0)}u()})).catch(console.error):u())};return this.ue=new s((function(n,i){u=function(){var i=t.Ui(e).segments[0].end,r=t.ye(!0);if(t.currentTime>=r&&(t.currentTime=r),t.currentTime>i&&(t.sorcerer.clear(),t.Wi=new Qe),t.sorcerer.video.switchTo(e,!1),t.Jt.audio.length){var o=t.pe.getAudioIndexFromVideo(t.Jt.video,t.Jt.audio,e);t.sorcerer.audio.switchTo(o,!1)}t.sorcerer.off("bufferqueueadd",c),t.de=null,t.Yi=!0,n()},t.sorcerer.on("bufferqueueadd",c),a()})),this.ue},e.loadManifest=function(t){var n=this,e=Date.now();return fe.browser.ie&&t&&-1!==t.indexOf("archive_playlist")?(setTimeout((function(){n.at("MediaUnknownError","An unknown error occurred.")}),250),new s((function(){}))):Pt({url:t,timeout:1e4,type:i.MANIFEST}).then((function(i){return i.url&&i.url!==t&&-1!==i.url.indexOf("live-archive")&&(n.Xi=i.url.split("/").slice(0,-2).join("/")),n.manifestLoadDurations.push({url:t,status:i.status,duration:Date.now()-e}),n.fire(Yi.MANIFEST_LOADED),i.text()})).then(function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return s.resolve(t.apply(this,n))}catch(t){return s.reject(t)}}}((function(n){var i;return function(e,r){var o=function(){if(-1!==t.indexOf(".mpd"))return function(t,n,i){return t&&t.then||(t=s.resolve(t)),n?t.then(n):t}(at("module/media-manifest.js"),(function(e){var r=e.parseMPD;i=r(n,t)}));i=JSON.parse(n)}();return o&&o.then?o.then(r):r()}(0,(function(){return i}))}))).catch((function(i){if(n.manifestLoadDurations.push({url:t,status:i.response&&i.response.status,duration:Date.now()-e}),n.reset(),i instanceof wt&&410===i.response.status)return n.fire(Yi.MEDIA_URL_EXPIRED),new s((function(){}));throw i instanceof wt&&400===i.response.status?n.fire(Yi.MEDIA_URL_BAD_REQUEST,i.response.url):i instanceof yt&&n.fire(Yi.MANIFEST_TIMEOUT),i}))},e.setVideoSrc=function(t,n){var i=this,e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e&&!n&&this.zi){if(("metadata"===this.X||"none"===this.X&&!this.paused)&&!this.Yi)return void this.zi.then((function(){var n=i.paused;i.setVideoSrc(t,n,!1)})).catch(console.error);if("auto"===this.X)return void this.zi.then((function(){i.setVideoSrc(t,!1,!1)})).catch(console.error)}n&&this.reset(),n||!this.paused||this.sorcerer||(n=!0);var r=this.be;n&&(r=this.Rt);var o=t.split("/");o.pop();var u="".concat(o.join("/"),"/");this.ne=!n,this.zi=this.ge(t,this.X).then(this.loadManifest.bind(this)).then((function(t){return"string"==typeof i.Xi&&-1!==i.Xi.indexOf("live-archive")?t:(i.Xi=u,t)})).then(r.bind(this)),n&&"auto"===this.X&&(this.zi=this.Ee(this.zi,this.preloadStream.bind(this),!1)),this.zi=this._e(this.zi)},e.getBitrateAtTime=function(t,n){if(!this.sorcerer)return 0;var i=this.sorcerer.streamIndexAtTime(t,n);return this.Jt[n][i]?this.Jt[n][i].bitrate:0},e.lockStreamIndexes=function(){var t=this,n=this.ce.map((function(n){return t.Jt.video.indexOf(t.Jt.video[n])})),i=!this.paused;if(i&&(this.Te=!0,this.F.pause()),this.he.video=!1,this.pe.lock(n),this.Ki||"auto"===this.X){var e=Math.max(this.currentTime-7,0),r=Math.min(this.currentTime+7,this.F.duration);this.sorcerer.removeBuffer(e,r).then((function(){!t.Ki&&"auto"===t.X||t.ended?t.ke():(t.seekToTime(t.currentTime),i&&t.paused&&(t.Ae=!0,t.F.play()))})).catch(console.error)}},e.seekToTime=function(t){var n=this;if(t===this.currentTime)return s.resolve();var i=null===this.Qi;if(i||(this.Se&&(this.Se(),this.Se=null),this.Re=null,this.Qi=null,this.Zi=null),this.Qi=t,this.Oe(),this.Yi)for(var e in this.Jt)if(this.Jt[e].length>0){var r=this.sorcerer[e].activeStreamIndex;this.sorcerer[e].streams[r].abort()}return this.Re=this.Me(t),s.all([this.zi,this.se]).then((function(){n.ke()})).catch(console.error),this.Ie&&0===t&&this.fire(Wi.SEEKING),i||this.play().catch(this.nt.bind(this)),this.zi.then((function(){return n.Re})).catch((function(t){}))},e.takeSnapshot=function(){},e.initDrm=function(){},e.onstalled=function(){return!1},e.onseeked=function(t){this.Ki&&this.we()},e.onended=function(n){return t.prototype.onended.call(this,n),!0},e.onseeking=function(t){this.Ki},e.Oe=function(){var t=this;this.De(),clearTimeout(this.je),this.je=setTimeout((function(){t.Ne()}),200)},e.De=function(){this.Pe||(this.Pe=!0,Fe(this.pe)&&(this.pe.scrubInProgress=!0))},e.Ne=function(){if(this.Pe=!1,Fe(this.pe)){this.pe.scrubInProgress=!1;var t=this.sorcerer.video.activeStreamIndex;this.pe.handleScrubEnd(t),this.ke()}},e.ontimeupdate=function(n){if(!this.sorcerer)return!1;if(t.prototype.ontimeupdate.call(this),this.Gi.stop(),0===this.currentTime)return this.Ki;if(this.Qi)return!1;this.Ki||(this.Ki=!0),this.oe&&this.currentTime>=this.oe&&(this.sorcerer.removeBuffer(0,this.oe-2),this.oe=!1);var i=this.sorcerer.getDroppedFrameTotal();this.fire(Yi.DROPPED_FRAMES,i);var e=this.sorcerer.getResponseSpeeds(),r=this.Jt.video[this.sorcerer.video.activeStreamIndex],o=this.B.tests&&this.B.tests.download_bitrate;if((!o||!o.group)&&r&&this.pe.getCurrentSpeed){var u={speed:this.pe.getCurrentSpeed(),bitrate:r.bitrate,speeds:e};this.fire(Yi.BANDWIDTH,u)}var s=this.F.buffered.length;if(!s)return!0;var a=this.F.buffered.end(s-1);return Math.ceil(a)===Math.ceil(this.F.duration)||(Math.abs(this.currentTime-a)<.2?!this.ae&&(this.fire(Yi.STREAM_BUFFER_START,{hasLowerStreamIndex:this.sorcerer.video.activeStreamIndex>0}),this.ae=!0,!1):void 0)},e.Ce=function(){return!!this.ended||Math.ceil(this.currentTime)===Math.ceil(this.F.duration)},e.xe=function(){return!!this.sorcerer&&!this.Ce()&&(null!==this.de?(this.Le(),!0):0!==this.currentTime||this.Yi?(this.ke(),!0):this.Ki)},e.onprogress=function(){this.pe.canPlayFromTimeInStream(this.currentTime,this.Ui())&&this.ae&&(this.fire(Yi.STREAM_BUFFER_END),this.ae=!1)},e.onwaiting=function(){return!this.Gi.start()},e.onerror=function(){return!!this.F.error&&(this.F.error.code===this.F.error.MEDIA_ERR_DECODE?(this.fire(Yi.SCANNER_ERROR,{reason:"encountered media decode error"}),!1):t.prototype.onerror.call(this))},e.pause=function(){t.prototype.pause.call(this)},e.play=function(){var n=this;return this.we(),t.prototype.play.call(this,(function(){return n.te&&n.te(),n.ne||n.Yi||"auto"===n.X||(n.zi=n.Ee(n.zi,n.preloadStream.bind(n))),n.zi.then((function(){return s.resolve(n.Re)}))}))},e.onpause=function(){return this.Te?(this.Te=!1,!1):(t.prototype.onpause.call(this),!0)},e.onplay=function(){return!this.Ae||(this.Ae=!1,!1)},e.Ee=function(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],e=t.then(n);return i&&(e=this._e(e)),e},e._e=function(t){var n=this;return t.catch((function(t){return n.fire(Yi.FILE_ERROR,{reason:t}),new s((function(t,n){}))}))},e.Ue=function(){this.Yi&&this.Jt.video[this.sorcerer.video.activeStreamIndex].bitrate/1e3>12e3&&(this.se=this.sorcerer.removeBuffer())},e.ge=function(t,n){var i=this;return new s((function(e,r){"none"!==n||i.ne&&!i.paused?e(t):i.te=function(){e(t),i.te=null}}))},e.Me=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.Qi;return new s((function(i,e){var r=t.Ki&&0===n,o=t.pe.canPlayFromTimeInStream(n,t.Ui());r||o?i(n):(t.Ue(),t.Zi=i)})).then((function(n){t.Qi=null,t.Re=null;var i=new s((function(n,i){t.Se=i,t.F.addEventListener("seeked",(function i(){n(t.F.currentTime),t.F.removeEventListener("seeked",i)}))}));return t.F.currentTime=n,i}))},e.Fe=function(t,n){"auto"!==t&&"auto"===n&&(this.zi=this.Ee(this.zi,this.preloadStream.bind(this))),t!==n&&"none"!==n&&this.te&&this.te()},e.He=function(t){var n=t.audio.reduce((function(t,n){return t+n.duration}),0),i=t.video.reduce((function(t,n){return t+n.duration}),0),e=n/t.audio.length,r=i/t.video.length;return e+4<r?r-e:0},e.Ve=function(t){return t.video.every((function(t){return t.segments.every((function(t){return"size"in t}))}))},e.be=function(t){var n=this;return new s((function(i,e){if(n.lt=t,n.Jt.video=n.Be(t.video),t.audio){var r=n.He(t);if(r>0)return n.fire(Yi.AV_DURATION_MISMATCH,r),n.fire(Yi.SCANNER_ERROR,{reason:"Encountered A/V duration mismatch"}),void e();n.Jt.audio=n.Be(t.audio)}for(var o=0;o<n.Jt.video.length;o++){var u=0;if(t.audio){var s=n.pe.getAudioIndexFromVideo(n.Jt.video,n.Jt.audio,o),a=n.Jt.audio[s];a&&(u=a.bitrate)}n.Jt.video[o].audioBitrate=u}Fe(n.pe)&&n.Jt.audio.length>0&&(n.pe.audioStreams=n.Jt.audio),n.$e(n.Jt.video,n.Jt.audio,n.lt.key_info),n.Ve(t)||n.resetBrain(!0),n.fire(Yi.STREAMS_LOADED,n.Jt),i()}))},e.We=function(t,n){this.sorcerer&&this.sorcerer.destroy(),this.sorcerer=new lr(t,n),this.F.src=URL.createObjectURL(this.sorcerer.mediaSource),this.successfulSegments=this.sorcerer.getSuccessfulSegments(),this.failedSegments=this.sorcerer.getFailedSegments(),this.we()},e.we=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.qe(500),clearTimeout(this.le),this.le=setTimeout((function(){t.qe(5e3)}),6e4),n&&this.xe()},e.qe=function(t){var n=this;clearInterval(this.ve),this.ve=setInterval((function(){n.xe()}),t)},e.ye=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t?1/0:0;for(var i in this.Jt)this.Jt[i].length&&(n=Math[t?"min":"max"](n,this.Jt[i][0].duration));return n},e.Rt=function(t){var n=this;return this.be(t).then((function(){var i=n.video&&n.video.metadata.percentShown?n.video.metadata.percentShown:null,e=n.pe.filterStreams(n.Jt.video,n.F.clientWidth,n.F.clientHeight,i).length-1,r=n.Jt.video[0];n.ce.length&&(r=n.Jt.video[n.ce[0]]),void 0!==n.$i&&e<=n.Jt.video.indexOf(t.video[n.$i])&&(r=n.Jt.video[e]),n.We(n.F,{duration:n.ye(),fetcherTimeout:8e3,fetcherRetryAbortErrors:!1}),n.sorcerer.on("srcnotsupported",(function(){n.fire(Yi.SCANNER_ERROR,{reason:"this codec is not supported for mediasource playback"})}));var o=n.Jt.video.indexOf(r),u=function(t){n.Jt[t].forEach((function(i,e){var r=n.Ge(e,"init",t);n.Ye(e,t)&&n.Jt[t][e].init_segment_range&&(r={url:r,byteRange:n.Ke(e,"init",t)}),n.sorcerer.addStream("".concat(i.mime_type,'; codecs="').concat(n.Jt[t][e].codecs,'"'),r)}))};for(var s in n.Jt)u(s);n.sorcerer.video.switchTo(o),n.sorcerer.on("queued",n.ze.bind(n)),n.sorcerer.on("downloadabort",n.Xe.bind(n)),n.sorcerer.on("appendbufferend",n.ki.bind(n)),n.sorcerer.on("downloadstart",n._i.bind(n)),n.sorcerer.on("downloadend",n.Ti.bind(n)),n.sorcerer.on("downloaderror",n.Je.bind(n)),n.sorcerer.on("downloadtimeout",n.Qe.bind(n)),n.sorcerer.on("quotaexceedederror",n.Ze.bind(n)),n.sorcerer.video.on("streamchange",n.tr.bind(n)),n.sorcerer.video.on("streamchangestart",n.nr.bind(n)),n.sorcerer.mediaSource.addEventListener("sourceended",(function(){n.fire(Wi.PROGRESS)}))}))},e.Be=function(t){var n=t.slice(0);return n.sort((function(t,n){var i=t.width*t.height*t.bitrate,e=n.width*n.height*n.bitrate;return t.width===n.width&&t.height===n.height?t.framerate-n.framerate:i-e})),n},e.Ye=function(t,n){return!!this.Jt[n][t].segments[0].range},e.Ke=function(t,n,i){return"init"===n?this.Jt[i][t].init_segment_range:this.Jt[i][t].segments[n].range},e.ir=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"video",e="init"===n;if(e)return 0;var r=this.Jt[i][t].segments[n].start;return r},e.Ge=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"video",e="init"===n;if(e&&!this.Jt[i][t].init_segment_range&&-1===this.Jt[i][t].init_segment.indexOf(".")){var r=this.Jt[i][t].init_segment;return Ne(r)}var o=this.Xi,u=this.lt.base_url&&-1!==this.lt.base_url.indexOf("//");return u&&(o=this.lt.base_url),this.lt.base_url&&!u&&(o+=this.lt.base_url),this.Jt[i][t].base_url&&(o+=this.Jt[i][t].base_url),this.Ye(t,i)?o:"init"===n?o+=this.Jt[i][t].init_segment:(this.Jt[i][t].segments[n].url&&(o+=this.Jt[i][t].segments[n].url),o)},e.er=function(t,n,i){return"".concat(t,":").concat(n,":").concat(i)},e.rr=function(t,n,i){return n===this.Jt[i][t].segments.length-1},e.or=function(t,n){var i=[],e=this.qi[t];if(!e)return i;for(var r=0;r<e.length;r++)this.Wi.has(this.er(e[r],t,n))&&i.push(e[r]);return i},e.Ui=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video";return void 0!==this.sorcerer&&(t=this.sorcerer[n].activeStreamIndex),this.Jt[n][t]},e.me=function(t,n){var i=this,e=this.Jt.video,r=this.video&&this.video.metadata.percentShown?this.video.metadata.percentShown:null;if(0===(e=this.pe.filterStreams(e,this.F.clientWidth,this.F.clientHeight,r)).length)return s.resolve(!1);if(this.he.video&&!Fe(this.pe))return s.resolve(!1);var o=e[e.length-1];if(o.id!==this.Ji){this.Ji=o.id;var u={index:this.Jt.video.indexOf(o),streams:this.Jt.video};this.fire(Yi.STREAM_TARGET_CHANGE,u)}var a=this.Ui();return this.pe.shouldPowerUp(e,a,t).then((function(t){return!1===t?i.pe.shouldPowerDown(e,a).then((function(t){return!1===t?t:i.Jt.video.indexOf(e[t])})):i.Jt.video.indexOf(e[t])}))},e.ur=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video";this.me(!1,n).then((function(i){"audio"===n&&(!1===i&&(i=t.sorcerer.video.activeStreamIndex),i=t.pe.getAudioIndexFromVideo(t.Jt.video,t.Jt.audio,i),t.sorcerer.audio.activeStreamIndex===i&&(i=!1));var e=!1;!1!==i&&(e=i>t.sorcerer[n].activeStreamIndex,t.he[n]=!0,t.sorcerer[n].switchTo(i).then((function(){t.he[n]=!1})).catch(console.error));for(var r=e,o=t.pe.getSegmentsToLoad(r,n,t.Ui()),u=t.sorcerer[n].activeStreamIndex,s=function(i){var e=t.Ge(u,o[i],n),r=t.or(o[i],n);if(r.length>1)return"continue";if(1===r.length&&u<=r[0])return"continue";var s=t.rr(u,o[i],n),a={stream:u,segment:o[i],type:n},c=t.sorcerer[n].streams[u],h=e;t.Ye(u,n)&&(h={url:h,byteRange:t.Ke(u,o[i],n)});var f=t.ir(u,o[i],n),d="video"===n,v=null;0===u&&"video"===n&&(v=16e3);var l=null;try{l=t.Jt[n][u].segments[o[i]].size}catch(t){}c.addSegment(h,{identifier:a,isFinalSegment:s,priority:f,includeWithBandwidthChecks:d,timeout:v,size:l}).catch((function(t){if(!(t instanceof pt))throw t}))},a=0;a<o.length;a++)s(a)})).catch(console.error)},e.Le=function(){var t=this,n=function(n){if(0===t.Jt[n].length)return"continue";var i=0,e=t.pe.getSegmentsToLoad(!1,n,t.Ui());e.length>0&&(i=e[0]);var r=t.de;"audio"===n&&(r=t.pe.getAudioIndexFromVideo(t.Jt.video,t.Jt.audio,t.de));var o=t.er(r,i,n);if(t.Wi.has(o))return"continue";var u=t.Ge(r,i,n),s=t.rr(r,i,n),a=t.sorcerer[n].streams[r],c={stream:r,segment:i,type:n},h=u;t.Ye(r,n)&&(h={url:h,byteRange:t.Ke(r,i,n)}),a.addSegment(h,{identifier:c,isFinalSegment:s,loadOnly:!0,priority:0}).catch((function(t){if(!(t instanceof pt))throw t}))};for(var i in this.Jt)n(i)},e.ke=function(){var t=this;return this.zi&&this.zi.then((function(){for(var n in t.Jt)t.Jt[n].length>0&&t.ur(n)}))},e.ze=function(t){this.Wi.add(this.er(t.stream,t.segment,t.type)),this.qi[t.segment]||(this.qi[t.segment]=[]),-1===this.qi[t.segment].indexOf(t.stream)&&this.qi[t.segment].push(t.stream)},e.sr=function(t){var n=this;(this.qi[t.segment]||[]).forEach((function(i){n.Wi.delete(n.er(i,t.segment,t.type))}))},e.Xe=function(t){this.qi[t.segment]&&this.sr(t)},e.ki=function(t){this.fire(Yi.APPEND_BUFFER_END,{identifier:t}),this.we(),this.re&&t.stream===this.ee&&(this.re=!1,this.oe=this.Jt.video[t.stream].segments[t.segment].start),this.qi[t.segment]&&this.sr(t);var n=this.pe.canPlayFromTimeInStream(this.Qi,this.Ui());null!==this.Qi&&this.Zi&&n&&(this.Zi(this.Qi),this.Zi=null)},e._i=function(t){this.fire(Yi.DOWNLOAD_START,{identifier:t})},e.Ti=function(t,n){this.fire(Yi.DOWNLOAD_END,{identifier:t,data:n})},e.Je=function(t,n){this.sr(t);var i=Yi.DOWNLOAD_ERROR;410===n&&(i=Yi.MEDIA_URL_EXPIRED),this.fire(i,{identifier:t,status:n})},e.Qe=function(t,n){this.fire(Yi.DOWNLOAD_TIMEOUT,{identifier:t,data:n}),this.qi[t.segment]&&this.sr(t),"video"===t.type?this.he.video=!1:"audio"===t.type&&(this.he.audio=!1)},e.Ze=function(t){this.fire(Yi.QUOTA_EXCEEDED_ERROR,{buffered:t})},e.nr=function(t,n){var i={previousStreamIndex:this.lt.video.indexOf(this.Jt.video[t]),index:this.lt.video.indexOf(this.Jt.video[n]),streams:this.lt.video};this.fire(Yi.STREAM_CHANGE_START,i)},e.tr=function(t){t>this.ee&&this.currentTime>0&&(this.re=!0),this.ee=t;var n={index:this.lt.video.indexOf(this.Jt.video[t]),streams:this.lt.video};this.fire(Yi.STREAM_CHANGE,n)},e.$e=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.$.drmHandler){var e={audio:n.map((function(t){return"".concat(t.mime_type,';codecs="').concat(t.codecs,'"')})),video:t.map((function(t){return"".concat(t.mime_type,';codecs="').concat(t.codecs,'"')}))};this.$.drmHandler.init(this,e,i)}},W(n,[{key:"preload",get:function(){return this.X},set:function(t){this.Fe(this.X,t),this.X=t}},{key:"videoElement",get:function(){return this.F}},{key:"videoWidth",get:function(){var t=this.Ui();return t?t.width:this.F.videoWidth}},{key:"videoHeight",get:function(){var t=this.Ui();return t?t.height:this.F.videoHeight}},{key:"restrictedStreamIndexes",get:function(){return this.ce},set:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.ce.join(",")!==n.join(",")&&(this.ce=n,this.zi.then((function(){return t.lockStreamIndexes()})).catch(console.error))}},{key:"currentTime",get:function(){return null!==this.Qi?this.Qi:this.F.currentTime},set:function(t){(this.Ki||0!==t)&&this.seekToTime(t)}},{key:"downloadSpeed",get:function(){return this.fe}},{key:"brainDebug",get:function(){var t=this.pe.getCurrentSpeed?this.pe.getCurrentSpeed():null,n=this.sorcerer.getResponseSpeeds();return{currentSpeed:t,responseSpeeds:n=n?n.slice(-20):[]}}},{key:"isLowerProfileAvailable",get:function(){return this.sorcerer?this.sorcerer.video.activeStreamIndex>0:null}}]),n}(Xe),gr=[1,2,5],Er=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).ar=.4,i.cr=.6,i.hr=i.B.tests&&i.B.tests.live_volatility&&i.B.tests.live_volatility.group,i.consecutiveStreamIndex={},i.isNewPlayback=!0,i}K(n,t),W(n,[{key:"displayName",get:function(){return"Live"}}]);var i=n.prototype;return i.optimalStreamIndex=function(t,n){if(this.isNewPlayback&&this.scanner.sorcerer.getResponseSpeeds().length>=2&&(this.isNewPlayback=!1),1===t.length)return 0;if(this.isNewPlayback){for(var i=0,e=0,r=this.scanner.videoElement.clientHeight,o=[],u=0;u<t.length;u++){var s=t[u].height;o.push(s),s<r&&s>e&&(i=u,e=t[u].height)}return Math.max(0,i-1)}var a=this.scanner.sorcerer.getCurrentSpeed({type:"average",howMany:5,weights:gr}),c=this.scanner.sorcerer.getVolatilityScaler(5);c||(c=.3);var h=n,f=n;if(this.hr)for(var d=0;d<t.length;d++)a*this.ar*c>t[d].bandwidth&&(h=d),a*this.cr*c>t[d].bandwidth&&(f=d);else for(var v=0;v<t.length;v++)a*this.ar>t[v].bandwidth&&(h=v),a*this.cr>t[v].bandwidth&&(f=v);var l=n<h?h:f;this.dr(l),this.consecutiveStreamIndex[l]++;var p=1.5*this.scanner.segmentLength,w=this.scanner.videoElement,m=w.buffered;return m&&0!==m.length?m.end(m.length-1)-w.currentTime<p?0!==n?n-1:0:this.consecutiveStreamIndex[l]>2&&l!==n?l:n:0},i.dr=function(t){for(var n in this.consecutiveStreamIndex[t]||(this.consecutiveStreamIndex[t]=0),this.consecutiveStreamIndex)this.consecutiveStreamIndex.hasOwnProperty(n)&&parseInt(n,10)!==t&&(this.consecutiveStreamIndex[n]=0)},i.getSegmentsToLoad=function(t,n){var i=this.scanner.videoElement,e=this.scanner.sorcerer[t].sourceBuffer;if(function(t,n){if(!n||!n.length)return 0;if(1===n.length&&n.end(0)-n.start(0)<1e-6)return 0;for(var i=0,e=n.length-1;e>=0&&n.end(e)>t;--e)i+=n.end(e)-Math.max(n.start(e),t);return i}(i.currentTime,e&&e.buffered)>=this.scanner.bufferTarget)return[];var r=this.lr(),o=this.pr(),u=n.segments.sort((function(t,n){return t.index-n.index}));return!this.wr&&r<u[0].start?[]:(this.wr=!0,u.filter((function(t){return!(t.end<r||t.start>o)})))},i.lr=function(){var t=this.mr(),n=this.scanner.manifest.maxEndTime-t;return Math.max(0,n)},i.pr=function(){var t=this.mr(),n=this.scanner.bufferTarget,i=this.scanner.manifest.maxEndTime-Math.max(0,t-n);return Math.max(0,i)},i.mr=function(){return this.scanner.presentationDelay||this.scanner.manifest.presentationDelay},n}(wr),_r=["disabled","hidden","showing"],Tr=["subtitles","captions","descriptions","chapters","metadata"],kr=["ar","fa","he","iw","ku","ps","sd","ur","yi"],Ar=new U,Sr=new U,TelecineTextTrack=function(){function TelecineTextTrack(t,n){var i=t.kind,e=t.src,r=void 0===e?null:e,o=t.label,u=void 0===o?"":o,s=t.language,a=void 0===s?"":s,c=t.id,h=void 0===c?De():c;if(-1===Tr.indexOf(i))throw Be(12,"SYNTAX_ERR","Syntax Error");Wt(this),Object.defineProperties(this,{kind:{value:i,enumerable:!0},label:{value:u,enumerable:!0},language:{value:a,enumerable:!0},id:{value:"".concat(h),enumerable:!0},rtl:{value:-1!==kr.indexOf(a.substr(0,2)),enumerable:!0}}),this.video=n,this.src=r,this.et=!1,Ar.set(this,"disabled")}return TelecineTextTrack.prototype.dispatchEvent=function(t){this.fire(t,{target:this})},W(TelecineTextTrack,[{key:"mode",get:function(){return Ar.get(this)},set:function(t){if(_r.indexOf(t)>-1){if(this.et=!0,Ar.get(this)===t)return;Ar.set(this,t),this.video.currentScanner&&this.video.currentScanner.setModeForTrack(this,t),this.dispatchEvent("modechange")}}},{key:"src",get:function(){return Sr.get(this)},set:function(t){Sr.set(this,t),this.video.fire(Yi.TEXT_SRC_UPDATE,this)}},{key:"cues",get:function(){return this.video.currentScanner?this.video.currentScanner.getCuesForTrack(this):[]}},{key:"activeCues",get:function(){return this.video.currentScanner?this.video.currentScanner.getActiveCuesForTrack(this):[]}}]),TelecineTextTrack}();function Rr(t){var n=/^(?:(\d{2,}):)?(\d{2}):(\d{2})[,.](\d{3})$/.exec(t);if(!n)return-1;var i=parseInt(n[4],10)/1e3;return i+=parseInt(n[3],10),n[2]&&(i+=60*parseInt(n[2],10)),n[1]&&(i+=60*parseInt(n[1],10)*60),i}function Or(t,n,i){return i?n?n(t):t:(t&&t.then||(t=s.resolve(t)),n?t.then(n):t)}function Mr(t,n){try{var i=t()}catch(t){return n(t)}return i&&i.then?i.then(void 0,n):i}function Ir(t,n){return t&&t.then?t.then(n):n(t)}var Dr=fe.browser.ie||fe.browser.edge?.5:.2;function jr(){}function Nr(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return s.resolve(t.apply(this,n))}catch(t){return s.reject(t)}}}var Pr=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).yr=!1,i.br=!1,i.gr=2e3,i.Er=1e4,i.reset(),i.bufferTarget=e.bufferTarget||12,i.presentationDelay=e.presentationDelay||12,window.addEventListener("online",(function(){i.play()})),i}K(n,t),W(n,null,[{key:"displayName",get:function(){return"HLSLiveScanner"}},{key:"supported",get:function(){return"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported}},{key:"supportedVideoTypes",get:function(){return["application/x-mpegURL"]}},{key:"supportsPlaybackRate",get:function(){return!1}}]);var i=n.prototype;return i.deactivate=function(){t.prototype.deactivate.call(this),this.reset()},i.reset=function(){this.Wt&&this.Wt.destroy(),this._r&&this._r.stop(),this.Tr=new ht,this.Wt=null,this.Jt={},this.Jt.video=[],this.Jt.audio=[],this.ee=0,this.kr=!1,this.Ar=!1,this.Sr=!1,this.Rr=0,this.Or=0,this.Mr=0,this.Ir=new Er(this,this.B),this.ce=[],this.Dr={},this.jr=0,this.Nr=0},i.endLive=function(){this.kr=!1,this._r&&this._r.stop(),this.Wt&&(this.Wt.abortFetches(),this.Wt.endOfStream()),this.Ar=!0,t.prototype.deactivate.call(this),this.fire(Wi.ENDED)},i.Pr=function(){this.kr||(this.kr=!0,this.fire(Ki.STREAM_ONLINE))},i.Cr=function(){this.kr&&(this.kr=!1,this.fire(Ki.STREAM_OFFLINE))},i.xr=function(t){t?this.Pr():this.Cr()},i.Lr=function(t){try{var n=this;if(n.Ar)return;n._r&&(n._r.stop(),n._r.off());var i=[at("module/media-manifest.js")];return n.video.metadata.p2p&&i.push(at("module/streamroot.js")),Or(s.allSettled(i),(function(i){var e=nt(i,1)[0].value,r=e.M3U8Loader,o=e.PLAYLIST_UPDATE,u=e.PLAYLIST_ERROR;return n._r=new r,n._r.on(o,(function(){return n.Ur()})),n._r.on(u,(function(){return n.Cr()})),Ir(Mr((function(){var i=n.video.metadata.playlistRefreshUrl;return Or(n._r.start(t,i),(function(t){n.lt=t,n.Pr()}))}),(function(t){throw n.Cr(),n.endLive(),t})),(function(t){n.Fr(n.F),n.Jt.video=n.Hr(n.Be(n.lt.video)),n.Jt.video.forEach((function(t){n.Wt.addStream(xe(t.mimeType,t.codecs),t.initSegment)})),n.lt.audio&&(n.Jt.audio=n.Hr(n.Be(n.lt.audio)),n.Jt.audio.forEach((function(t){n.Wt.addStream(xe(t.mimeType,t.codecs),t.initSegment)}))),n.fire(Yi.STREAMS_LOADED,n.Jt),n.manifest.captions&&n.manifest.captions.length>0&&(n.manifest.captions.forEach(n.Vr.bind(n)),n.fire(Yi.TEXT_TRACKS_AVAILABLE)),n.Br(),n.$r(!0)}))}))}catch(t){return s.reject(t)}},i.Wr=function(){try{var t=this;return function(t){if(t&&t.then)return t.then(jr)}(Mr((function(){var n=t.Ui();return Or(t._r.update(n.uri),(function(){t.Pr()}))}),(function(){t.Cr()})))}catch(t){return s.reject(t)}},i.Fr=function(t){this.Wt&&this.Wt.destroy(),this.Wt=new lr(t,{fetcherRetryAbortErrors:!1})},i.Br=function(){this.Wt.video.on("streamchange",this.tr.bind(this)),this.Wt.on("downloadend",this.Ti.bind(this)),this.Wt.on("downloadtimeout",this.Qe.bind(this)),this.Wt.on("downloadabort",this.qr.bind(this))},i.Ti=function(t,n){t&&t.isInitSegmentRequest||this.fire(Yi.DOWNLOAD_END,{identifier:t,data:n})},i.Qe=function(t,n){if(!t||!t.isInitSegmentRequest){var i="".concat(t.type,"_").concat(t.segment);delete this.Dr[i],this.fire(Yi.DOWNLOAD_TIMEOUT,{identifier:t,data:n})}},i.qr=function(t,n){if(!t||!t.isInitSegmentRequest){var i="".concat(t.type,"_").concat(t.segment);delete this.Dr[i]}},i.tr=function(t){this.Sr=!1,this.fire(Yi.STREAM_CHANGE,{index:t,streams:this.Jt.video})},i.Ur=function(){this.ke(),this.br&&this.manifest.captions&&this.manifest.captions.length>0&&this.Gr(),this.xr(this.Yr()||!this.Kr()),this.zr()},i.Vr=function(t,n){var i=t.label,e=t.language;if(!this.Xr){var r=new TelecineTextTrack({label:i,id:n,kind:"captions",language:e},this.$);this.$.textTracks=Oe([r]),this.Xr=this.addTextTrack(r)}},i.Gr=function(){try{var t=this;return Or(t.Tr,(function(){if(t.manifest.captions){var n=t.manifest.captions[0].segments,i=n.slice(t.Mr);t.Mr=n.length,i.forEach(Nr((function(n){return Or(Pt(n.url).text(),(function(n){var i=function(t){var n=0,i=t.split(/(?:(?:\r\n|\n){2,})/),e=[],r=null;do{0===n&&/^\uFEFF?WEBVTT(?: .*)?/.test(i[n])&&n++,(r=/^(?:(.*)(?:\r\n|\n))?([\d:,.]+) --> ([\d:,.]+)(.*)?(?:\r\n|\n)([\s\S]*)/.exec(i[n]))&&e.push({startTime:Rr(r[2]),endTime:Rr(r[3]),text:r[5]}),n++}while(n<i.length);return e}(n),e=function(t){var n=t.match(/=MPEGTS:(\d+),/);return(n&&n[1]||0)/9e4}(n);i.forEach((function(n){n.startTime=e+n.startTime,n.endTime=e+n.endTime;var i=new(window.VTTCue||window.TextTrackCue)(n.startTime,n.endTime,n.text);t.Xr.addCue(i)}))}))})))}}))}catch(t){return s.reject(t)}},i.Yr=function(){return this.manifest.maxEndTime>0&&(this.manifest.maxEndTime===this.jr?this.Nr++:this.Nr=0,this.jr=this.manifest.maxEndTime),this.Nr<3},i.ke=function(){try{var t=this;return Or(t.Tr,(function(){for(var n in t.Jt)t.Jt[n].length>0&&t.ur(n)}))}catch(t){return s.reject(t)}},i.ur=function(t){var n=this,i=this.Wt[t].activeStreamIndex,e=this.Ui(t,i);this.Ir.getSegmentsToLoad(t,e).forEach((function(e){var r="".concat(t,"_").concat(e.index),o={stream:i,segment:e.index,type:t};n.Dr[r]||(n.sorcerer[t].streams[i].addSegment(e.url,{identifier:o}).catch((function(t){delete n.Dr[r]})),n.Dr[r]=!0)}))},i.Ui=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return void 0!==this.Wt&&(n=this.Wt[t].activeStreamIndex),this.Jt[t][n]},i.$r=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.Sr){var n=this.video&&this.video.metadata.percentShown?this.video.metadata.percentShown:null,i=this.Ir.filterStreams(this.Jt.video,this.F.clientWidth,this.F.clientHeight,n);if(0!==i.length){var e=this.Ir.optimalStreamIndex(i,this.ee),r=this.Jt.video.indexOf(i[e]);if(r>=0&&(t||r!==this.ee)){if(r-this.ee>0&&this.Or>0){if(Ie(this.Or)<this.Er)return}else this.Or=Me();var o={index:r,streams:this.Jt.video};this.fire(Yi.STREAM_TARGET_CHANGE,o),this.Sr=!0,this.Wt.video.switchTo(r,!0),this.ee=r,this.Wr()}}}},i.zr=function(){var t=this.buffered;if(t.length){var n=t.length,i=function(t,n){if(!t||!t.length)return null;if(1===t.length&&t.end(0)-t.start(0)<1e-6)return null;for(var i,e=0;e<t.length;e++)if(t.start(e)>n&&(0===e||t.end(e-1)-n<=.5)){i=e;break}return i>=0?i:null}(t,this.F.currentTime);if(null!==i&&0!==this.F.readyState&&!(this.F.paused||n<=i)){var e=t.start(i),r=t.end(n-1)-e;r>0&&r<=2*this.segmentLength||(this.F.currentTime=e+.1)}}},i.Kr=function(){var t=this.buffered;return!!(t&&t.length&&this.F.currentTime+Dr>t.end(t.length-1))},i.setVideoSrc=function(t){try{var n=this;return Or(n.ge(n.X),(function(){return Or(n.Lr(t),(function(){n.F.src=URL.createObjectURL(n.Wt.mediaSource),n.Tr.resolve()}))}))}catch(t){return s.reject(t)}},i.ge=function(t){try{return this.Jr=new ht,"none"===t&&this.paused||this.Jr.resolve(),this.Jr}catch(t){return s.reject(t)}},i.getBitrateAtTime=function(t,n){if(!this.Wt)return 0;var i=this.Wt.streamIndexAtTime(t,n);return this.Jt[n][i]?this.Jt[n][i].bandwidth:0},i.Be=function(t){var n=t.slice(0);return n.sort((function(t,n){var i=t.width*t.height*t.bitrate,e=n.width*n.height*n.bitrate;return t.width===n.width&&t.height===n.height?t.framerate-n.framerate:i-e})),n},i.Hr=function(t){return t.filter((function(n){return n.mimeType===t[0].mimeType}))},i.onprogress=function(){this.zr()},i.ondurationchange=function(){this.zr()},i.ontimeupdate=function(){if(this.Wt){t.prototype.ontimeupdate.call(this),this.fire(Yi.DROPPED_FRAMES,this.Wt.getDroppedFrameTotal());var n=this.Ui();if(n){var i={speed:this.Wt.getCurrentSpeed({type:"average",howMany:3,weights:[1,2,5]}),bitrate:n.bitrate,speeds:this.Wt.getResponseSpeeds()};this.fire(Yi.BANDWIDTH,i)}!this.kr&&this.Kr()&&this.fire(Ki.STREAM_OFFLINE),Ie(this.Rr)>this.gr&&(this.$r(),this.Rr=Me())}},i.seekToTime=function(){},i.onpause=function(){this._r&&this._r.stop()},i.pause=function(){t.prototype.pause.call(this),this._r&&this._r.stop(),this.Wt&&(this.Wt.abortFetches(),this.Dr={},this.Wt.removeBuffer().catch((function(){})))},i.play=function(){var n=this;return t.prototype.play.call(this,Nr((function(){var t=!1;return n.Jr.resolve(),function(i,e){var r=function(){if(n.yr)return Or(n.Wr(),(function(){return n.Dr={},Ir(Mr((function(){return function(t,n){return t&&t.then?t.then(jr):s.resolve()}(n.Wt.removeBuffer())}),(function(t){})),(function(){return Or(n.Tr,(function(){return n.ke(),Or(n.Qr(),(function(){n.currentTime=n.buffered.start(0)+.1,t=!0}))}))}))}))}();return r&&r.then?r.then(e):e(r)}(0,(function(i){return t?i:Or(n.Tr,(function(){n.ke(),n.yr=!0}))}))})))},i.Qr=function(){var t=this;return new s((function(n){t.Wt.once("appendbufferend",n)}))},i.setCaptionsState=function(t){this.br=t},W(n,[{key:"preload",get:function(){return this.X},set:function(t){this.X!==t&&"none"!==t&&this.Jr.resolve(),this.X=t}},{key:"restrictedStreamIndexes",get:function(){return this.ce},set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.ce.join(",")!==t.join(",")&&(this.ce=t,this.Ir.lock(this.ce))}},{key:"videoWidth",get:function(){return this.Zr?this.Zr.width:this.F.videoWidth}},{key:"videoHeight",get:function(){return this.Zr?this.Zr.height:this.F.videoHeight}},{key:"currentTime",get:function(){return this.F.currentTime},set:function(t){this.F.currentTime=t}},{key:"isLowerProfileAvailable",get:function(){return this.Wt?this.Wt.video.activeStreamIndex>0:null}},{key:"sorcerer",get:function(){return this.Wt}},{key:"segmentLength",get:function(){return this.lt.targetDuration}}]),n}(Xe),Cr=document.createElement("video"),xr={"application/x-mpegURL":"application/x-mpegURL"},Lr=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).to=null,i.reset(),window.addEventListener("online",(function(){i.play()})),i}K(n,t),W(n,null,[{key:"displayName",get:function(){return"NativeHLSLiveScanner"}},{key:"supported",get:function(){return n.supportedVideoTypes.length>0}},{key:"supportedVideoTypes",get:function(){var t=[];if("function"!=typeof Cr.canPlayType)return t;for(var n in xr){var i=xr[n];Cr.canPlayType(i).replace(/^no$/,"")&&t.push(n)}return t}},{key:"supportsPlaybackRate",get:function(){return!1}}]);var i=n.prototype;return i.deactivate=function(){t.prototype.deactivate.call(this),this.reset()},i.reset=function(){this.no&&clearTimeout(this.no),this.zi=null,this.no=null,this.kr=!1,this.Ar=!1,this.io=null,this.eo=0,this.no=null,this.Ir=new Er(this,this.B),this.ce=[]},i.endLive=function(){var n=this;this.kr=!1,this.Ar=!0,clearTimeout(this.no),this.F.pause(),setTimeout((function(){t.prototype.deactivate.call(n),n.fire(Wi.ENDED)}),0)},i.ro=function(){var t=this,n=dt(this.video.metadata.playlistRefreshUrl.split("?")[1]);n.expires&&(this.no=setTimeout((function(){t.oo()}),1e3*(n.expires-10)))},i.oo=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=this.video.metadata.playlistRefreshUrl;return Pt(i).json().then((function(e){if(!("url"in e))throw new Error("Error parsing 'url' key from player live API refresh endpoint: ".concat(i," ").concat(e));return t.uo(e.url.hls).then((function(){return t.play(),t.so(5e3),null})).catch((function(){return t.oo(++n)}))})).catch((function(){if(n>=3)throw new Error("Manifest failed to load after ".concat(n," attempts."));return++n,t.oo(n)}))},i.ao=function(){var t=this;this.on(Ki.STREAM_OFFLINE,(function(){t.kr=!1}))},i.co=function(t){return this.ao(),this.kr=!0,this.fire(Ki.STREAM_ONLINE),this.so(5e3),s.resolve(t)},i.uo=function(t){var n=this;return this.to=t,/json=1/.test(t)?Pt(t).json().then((function(t){if(!("url"in t))throw new Error("Error parsing 'url' key from Live API manifest endpoint: ".concat(n.to," ").concat(t));n.F.src=t.url,n.ro()})).catch((function(t){var i=n.video.metadata.playlistRefreshUrl;return Pt(i).json().then((function(t){if(!("url"in t))throw new Error("Error parsing 'url' key from player live API refresh endpoint: ".concat(i," ").concat(t));n.to=t.url.ios,n.F.src=t.url.ios,n.ro()}))})):(this.F.src=t,this.ro(),s.resolve())},i.so=function(t){var n=this;"number"==typeof fe.iOS&&fe.iOS<9||this.io||(this.io=setTimeout((function(){if(n.kr){var t=new XMLHttpRequest;t.onload=function(){410!==t.status?(200!==t.status&&n.fire(Ki.STREAM_OFFLINE),t.response.match(/^#EXTM3U\n#EXT-X-VERSION:3\n$/)&&n.fire(Ki.STREAM_OFFLINE)):n.oo()},t.onerror=function(){n.fire(Ki.STREAM_OFFLINE)},/json=1/.test(n.to)?Pt(n.to).json().then((function(i){"url"in i||n.fire(Ki.STREAM_OFFLINE),t.open("GET",i.url),t.send()})).catch((function(){t.open("GET",n.to),t.send()})):(t.open("GET",n.to),t.send())}}),t))},i.setVideoSrc=function(t){var n=this;this.zi=this.co(t).then((function(){return n.to=t,n.uo(t)}))},i.onprogress=function(){this.io&&(clearTimeout(this.io),this.io=null)},i.onstalled=function(){this.so(1e4)},i.onerror=function(){var n=this;return this.F.error.code===this.F.error.MEDIA_ERR_SRC_NOT_SUPPORTED?(Pt(this.to).then((function(){t.prototype.onerror.call(n)})).catch((function(i){i instanceof mt?n.fire(Wi.ERROR,new TelecineError("MediaNetworkError","A network error ocurred while fetching the media.")):t.prototype.onerror.call(n)})),!1):t.prototype.onerror.call(this)},i.onwaiting=function(){this.so(1e4)},i.seekToTime=function(){},i.play=function(){var n=this;return t.prototype.play.call(this,(function(){return n.zi}))},W(n,[{key:"currentTime",get:function(){return this.F.currentTime},set:function(t){this.F.currentTime=t}}]),n}(Xe),Ur=function(){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.ho=t,this.V=t.V,this.B=n}W(t,null,[{key:"displayName",get:function(){return"Effect"}},{key:"supported",get:function(){return!1}},{key:"supportedScanners",get:function(){return[]}}]);var n=t.prototype;return n.activate=function(){throw new TelecineError("NotImplemented","The effect must implement the activate method.")},n.deactivate=function(){throw new TelecineError("NotImplemented","The effect must implement the deactivate method.")},t}(),Fr=new U,Hr=new U,TelecineFile=function(){function TelecineFile(t,n){var i=t.src,e=t.mime,r=t.id,o=void 0===r?De():r,u=t.priority,s=void 0===u?0:u,a=t.metadata,c=void 0===a?{}:a;if(!i)throw new TypeError("Must provide a src for the file.");if(!e)throw new TypeError("Must provide a mime type for the file.");Object.defineProperties(this,{mime:{value:e,enumerable:!0},id:{value:"".concat(o),enumerable:!0},metadata:{value:c,enumerable:!0}}),this.video=n,this.priority=s,this.src=i}return W(TelecineFile,[{key:"priority",get:function(){return Fr.get(this)},set:function(t){if(!("number"==typeof(t=parseInt(t,10))&&isFinite(t)&&Math.floor(t)===t&&t>=0))throw new TypeError("The file priority must be an integer greater than or equal to 0.");Fr.set(this,t)}},{key:"src",get:function(){return Hr.get(this)},set:function(t){Hr.set(this,t),this.video.fire(Yi.FILE_SRC_UPDATE,this)}},{key:"restrictedStreamIndexes",get:function(){if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");return this.video.currentScanner.restrictedStreamIndexes},set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!Array.isArray(t))throw new TypeError("Indexes must be an array.");if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");this.video.currentScanner.restrictedStreamIndexes=t}}]),TelecineFile}();function Vr(){return!!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration||window.WebKitMediaKeys)}function Br(t,n,i){"string"==typeof n&&(n=function(t){for(var n=new ArrayBuffer(2*t.length),i=new Uint16Array(n),e=0,r=t.length;e<r;e++)i[e]=t.charCodeAt(e);return i}(n));var e=0,r=new ArrayBuffer(t.byteLength+4+n.byteLength+4+i.byteLength),o=new DataView(r);new Uint8Array(r,e,t.byteLength).set(t),e+=t.byteLength,o.setUint32(e,n.byteLength,!0),e+=4;var u=new Uint8Array(r,e,n.byteLength);return u.set(n),e+=u.byteLength,o.setUint32(e,i.byteLength,!0),e+=4,new Uint8Array(r,e,i.byteLength).set(i),new Uint8Array(r,0,r.byteLength)}function $r(t){for(var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=n?t.buffer:t,e=String.fromCharCode.apply(null,new Uint16Array(i)),r=(new DOMParser).parseFromString(e,"application/xml"),o={},u=r.getElementsByTagName("HttpHeader"),s=0;s<u.length;++s){var a=u[s].querySelector("name"),c=u[s].querySelector("value");o[a.textContent]=c.textContent}var h=r.querySelector("Challenge");return[o,t=je(h.textContent)]}function Wr(t,n,i,e){var r=e.audio||[],o=e.video||[],u=[{video:"HW_SECURE_ALL",audio:"SW_SECURE_CRYPTO"},{video:"HW_SECURE_DECODE",audio:"SW_SECURE_CRYPTO"},{video:"HW_SECURE_CRYPTO",audio:"SW_SECURE_CRYPTO"},{video:"SW_SECURE_DECODE",audio:"SW_SECURE_CRYPTO"},{video:"SW_SECURE_CRYPTO",audio:"SW_SECURE_CRYPTO"}].map((function(t){var n={persistentState:"optional",sessionTypes:["temporary"]};return o.length&&(n.videoCapabilities=o.map((function(n){return{contentType:n,robustness:t.video}}))),r.length&&(n.audioCapabilities=r.map((function(n){return{contentType:n,robustness:t.audio}}))),n})),a=Object.keys(t).map((function(e){var r=t[e].id;if(n||i){var o=null,a=n?window.WebKitMediaKeys:window.MSMediaKeys;try{o=new a(r)}catch(t){}return s.resolve({name:r,keySystem:o})}return navigator.requestMediaKeySystemAccess(r,u).then((function(t){return t.createMediaKeys()})).catch((function(t){})).then((function(t){return{name:r,keySystem:t}}))}));return s.all(a)}function qr(t,n){var i={},e="".concat(window.screen.availWidth,"x").concat(window.screen.availHeight),r=window.devicePixelRatio;return i.merchant="vimeo",i.sessionId=JSON.stringify({ua:navigator.userAgent,token:t,resolution:e,pixelRatio:r}),i.userId=n,i}function Gr(t,n){var i=null;return Object.keys(t).forEach((function(e){n.name===t[e].id&&(i=t[e])})),i}var Yr=function(){function t(t,n){this.fo=t.cdms,this.do=t.lr_token,this.vo=t.user,this.lo=t.asset,this.po=n,this.wo=null,this.mo=null,this.yo=null,this.bo=null,this.Eo=this._o.bind(this)}var n=t.prototype;return n.init=function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.F=t.F,this.To=t,Vr()?(this.ko=qr(this.do,this.vo),Wr(this.fo,this.po,!1,i).then((function(t){if(t.forEach((function(t){t.keySystem&&(n.yo=t)})),!n.yo)return n.To.fire(Yi.EME_UNSUPPORTED),!1;var i=Gr(n.fo,n.yo);return n.bo="encrypted",n.wo=i.license_url,n.po&&(n.Ao=i.certificate_url,n.bo="webkitneedkey"),n.F.addEventListener(n.bo,n.Eo),n.po?(n.F.webkitSetMediaKeys(n.yo.keySystem),!0):n.F.mediaKeys?(n.mo=n.F.mediaKeys.createSession(),n.mo.addEventListener("message",(function(t){return n.So(t)})),!0):(n.mo=n.yo.keySystem.createSession(),n.mo.addEventListener("message",(function(t){return n.So(t)})),n.F.setMediaKeys(n.yo.keySystem),!0)}))):(this.To.fire(Yi.EME_UNSUPPORTED),!1)},n.destroy=function(){this.mo&&this.mo.sessionId&&this.mo.close(),this.F.removeEventListener(this.bo,this.Eo)},n._o=function(t){var n=this;return"com.apple.fps.1_0"===this.yo.name?(this.Ro().then((function(i){n.Oo="assetId=".concat(n.lo);var e=Br(t.initData,n.Oo,i);return n.mo=n.yo.keySystem.createSession("video/mp4",e),n.mo.addEventListener("webkitkeymessage",(function(t){return n.So(t)})),i})).catch((function(t){n.To.fire(t.error,t.payload)})),!0):!this.mo.sessionId&&!this.Mo&&(this.Mo=this.mo.generateRequest(t.initDataType,t.initData).catch((function(){n.To.fire(Yi.DRM_FAILURE)})),!0)},n.So=function(t){var n=this;return new s((function(i,e){n.Mo=null;var r=new XMLHttpRequest;r.keySession=t.target,r.responseType="arraybuffer",r.open("POST",n.wo),r.setRequestHeader("dt-custom-data",window.btoa(JSON.stringify(n.ko)));var o=t.message;if("com.microsoft.playready"===n.yo.name){var u=$r(t.message,!1),s=u[0];Object.keys(s).forEach((function(t){r.setRequestHeader([t],s[t])})),o=u[1]}if("com.apple.fps.1_0"===n.yo.name){var a=btoa(String.fromCharCode.apply(null,o));a=encodeURIComponent(a),o="spc=".concat(a,"&").concat(n.Oo),r.setRequestHeader("Content-type","application/x-www-form-urlencoded")}r.onload=function(){if(403!==r.status)if(r.status>=400)e({error:Yi.DRM_FAILURE});else try{n.To.fire(Yi.DRM_AUTH_SUCCESS);var t=new Uint8Array(r.response),o=t.buffer;"com.apple.fps.1_0"===n.yo.name&&(o=function(t){var n=window.atob(t.trim());return"<ckc>"===n.substr(0,5)&&"</ckc>"===n.substr(-6)&&(n=n.slice(5,-6)),new Uint8Array(atob(n).split("").map((function(t){return t.charCodeAt(0)})))}(btoa(String.fromCharCode.apply(null,t)))),r.keySession.update(o),i()}catch(t){e("Error updating key session: ".concat(t))}else{var u=JSON.parse(r.getResponseHeader("x-dt-error-message"));e({error:Yi.DRM_AUTH_FAILURE,payload:{text:u.error,code:u.error_code}})}},r.onerror=e,r.send(o)})).catch((function(t){n.To.fire(t.error,t.payload)}))},n.Ro=function(){var t=this;return new s((function(n,i){var e=new XMLHttpRequest;e.responseType="arraybuffer",e.open("GET",t.Ao),e.setRequestHeader("dt-custom-data",window.btoa(JSON.stringify(t.ko))),e.onload=function(){if(403!==e.status)if(e.status>=400)i({error:Yi.DRM_FAILURE});else try{n(new Uint8Array(e.response))}catch(t){i(t)}else{var t=JSON.parse(e.getResponseHeader("x-dt-error-message"));i({error:Yi.DRM_AUTH_FAILURE,payload:{text:t.error,code:t.error_code}})}},e.onerror=i,e.send()}))},t}(),Kr=function(){function t(t,n){this.fo=t.cdms,this.lo=t.asset,this.po=n,this.Io=null,this.wo=null,this.mo=null,this.yo=null,this.bo=null,this.Eo=this._o.bind(this),this.Do=this.jo.bind(this)}var n=t.prototype;return n.init=function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.F=t.F,this.To=t,this.No=!!window.MSMediaKeys,Vr()||this.No?Wr(this.fo,this.po,this.No,i).then((function(t){n.yo=t.find((function(t){return t.keySystem}));var i=n.yo&&Gr(n.fo,n.yo);if(!i)throw n.To.fire(Yi.EME_UNSUPPORTED),new Error("No valid key system was found.");n.Io=i.license_url;var r=e&&e.inits&&e.inits[i.id];return r||n.Po(i),n.Co().then((function(){return r&&n._o(r.cenc)}))})):(this.To.fire(Yi.EME_UNSUPPORTED),s.reject())},n.destroy=function(){this.mo&&this.mo.sessionId&&this.mo.close(),this.F.removeEventListener(this.bo,this.Eo)},n.Po=function(t){this.bo="encrypted",this.wo=t.license_url,this.po?(this.Ao=t.certificate_url,this.bo="webkitneedkey"):this.No&&(this.bo="msneedkey"),this.F.addEventListener(this.bo,this.Eo)},n.Co=function(){var t=this;return new s((function(n){if(t.No){var i=function i(){t.F.msSetMediaKeys(t.yo.keySystem),t.F.removeEventListener("loadedmetadata",i),n()};t.F.readyState>=1?i():t.F.addEventListener("loadedmetadata",i)}else{if(t.po)t.F.webkitSetMediaKeys(t.yo.keySystem);else{var e=t.F.mediaKeys||t.yo.keySystem;t.mo=t.xo(e),t.mo.addEventListener("message",(function(n){return t.So(n)})),t.F.mediaKeys||t.F.setMediaKeys(t.yo.keySystem)}n()}}))},n.xo=function(t,n,i){var e=t.createSession(n,i);if(!e)throw new Error("Could not create key session");return e},n._o=function(t){var n=this,i=new Error("A decryption key error was encountered");return"com.apple.fps.1_0"===this.yo.name?(this.Ro(this.Ao).then((function(e){n.Oo=function(t){var n=function(t){var n=new Uint16Array(t.buffer);return String.fromCharCode.apply(null,n)}(t),i=document.createElement("a");return i.href=n,i.hostname}(t.initData);var r=Br(t.initData,n.Oo,e);return n.mo=n.xo(n.yo.keySystem,"video/mp4",r),n.mo.contentId=n.Oo,n.mo.addEventListener("webkitkeymessage",(function(t){return n.So(t)})),n.mo.addEventListener("webkitkeyerror",(function(t){throw i})),e})).catch((function(t){n.To.fire(t.error,t.payload)})),!0):"com.microsoft.playready"===this.yo.name?(this.mo=this.xo(this.F.msKeys,"video/mp4",t.initData),this.mo.addEventListener("mskeymessage",(function(t){return n.So(t)})),this.mo.addEventListener("mskeyerror",(function(t){throw i})),!0):!this.mo.sessionId&&!this.Mo&&(this.mo.addEventListener("keystatuseschange",this.Do),this.Mo=this.mo.generateRequest(t.initDataType,t.initData).catch((function(){n.To.fire(Yi.DRM_FAILURE)})),!0)},n.jo=function(){var t=!1,n=V(this.mo.keyStatuses.values());n.forEach((function(n,i){switch(n){case"expired":t=!0}})),n.every((function(t){return"output-restricted"===t}))&&this.To.fire(Yi.DRM_OUTPUT_RESTRICTED),t&&this.mo.close()},n.So=function(t){var n=this;return this.Lo(this.Io).then((function(i){return new s((function(e,r){n.wo=i,n.Mo=null;var o=new XMLHttpRequest;o.keySession=t.target,o.open("POST",n.wo),o.responseType="arraybuffer";var u=t.message;if("com.microsoft.playready"===n.yo.name){var s=$r(t.message),a=s[0];Object.keys(a).forEach((function(t){o.setRequestHeader(t,a[t])})),u=s[1]}"com.apple.fps.1_0"===n.yo.name&&(u=new Uint8Array(u),o.setRequestHeader("Content-type","application/octet-stream")),o.onload=function(){if(403!==o.status)if(o.status>=400)r(new TelecineError(Yi.DRM_FAILURE));else try{n.To.fire(Yi.DRM_AUTH_SUCCESS);var t=new Uint8Array(o.response);o.keySession.update(t),e()}catch(t){r(new TelecineError(Yi.DRM_FAILURE,"Error updating key session: ".concat(t)))}else r(new TelecineError(Yi.DRM_AUTH_FAILURE))},o.onerror=r,o.send(u)})).catch((function(t){n.To.fire(t.name,{text:t.message||"License request failed."})}))}))},n.Lo=function(t){return new s((function(n,i){var e=new XMLHttpRequest;e.open("GET",t),e.onload=function(){if(e.status>=400)i(new TelecineError(Yi.DRM_FAILURE));else try{try{var t=JSON.parse(e.response),r=t.licenseAcquisitionUrl,o=t.token;if(!r&&!o)throw new Error;n("".concat(r,"?ExpressPlayToken=").concat(o))}catch(t){n(e.response)}}catch(t){i(new TelecineError(Yi.DRM_FAILURE,"Error retrieving License Acquisition URL (LA_URL): ".concat(t)))}},e.onerror=i,e.send()}))},n.Ro=function(t){return new s((function(n,i){var e=new XMLHttpRequest;e.open("GET",t),e.responseType="arraybuffer",e.setRequestHeader("Pragma","Cache-Control: no-cache"),e.setRequestHeader("Cache-Control","max-age=0"),e.onload=function(){if(403!==e.status)if(e.status>=400)i({error:Yi.DRM_FAILURE});else try{n(new Uint8Array(e.response))}catch(t){i(t)}else i({error:Yi.DRM_AUTH_FAILURE})},e.onerror=i,e.send()}))},t}(),zr=new U,TelecineVideo=function(){function TelecineVideo(t){var n=this,i=t.files,e=t.id,r=void 0===e?De():e,o=t.title,u=void 0===o?null:o,s=t.subtitle,a=void 0===s?null:s,c=t.metadata,h=void 0===c?{}:c,f=t.textTracks,d=void 0===f?Oe():f,v=t.externalDisplayFiles,l=void 0===v?{}:v,p=t.chapters,w=void 0===p?[]:p,m=t.duration;if(!i||!Array.isArray(i))throw new TypeError("Must provide files for the video.");Wt(this);var y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.getFileById=Re,t}(i.map((function(t){return t instanceof TelecineFile?(t.video=n,t):new TelecineFile(t,n)}))),b=Oe(d.map((function(t){return t instanceof TelecineTextTrack?(t.video=n,t):new TelecineTextTrack(t,n)})));Object.keys(l).forEach((function(t){!l[t]||l[t]instanceof TelecineFile||(l[t]=new TelecineFile(l[t],n))})),Object.defineProperties(this,{id:{value:"".concat(r),enumerable:!0},title:{value:u,enumerable:!0},subtitle:{value:a,enumerable:!0},metadata:{value:h,enumerable:!0},files:{value:y,enumerable:!0},textTracks:{value:b,enumerable:!0,writable:!0},chapters:{value:w,enumerable:!0},duration:{value:m,enumerable:!0},externalDisplayFiles:{value:l,enumerable:!0}}),h.drm&&(h.drm.fastly?this.Uo=new Kr(h.drm,h.useHls):this.Uo=new Yr(h.drm,h.useHls))}return TelecineVideo.prototype.deactivate=function(){var t=this;this.Uo&&this.Uo.destroy(),this.textTracks.forEach((function(n){return t.currentScanner.removeTextTrack(n)}))},W(TelecineVideo,[{key:"drmHandler",get:function(){return this.Uo||null}},{key:"currentFile",get:function(){return this.currentScanner.currentFile},set:function(t){this.currentScanner.currentFile=t}},{key:"currentScanner",get:function(){return zr.get(this)},set:function(t){var n=this;this.currentScanner&&this.currentScanner.constructor.supportsTextTracks&&this.textTracks.forEach((function(t){return n.currentScanner.removeTextTrack(t)})),t.constructor.supportsTextTracks&&this.textTracks.forEach((function(n){return t.addTextTrack(n)})),zr.set(this,t)}},{key:"chapters",get:function(){return this.chapters}}]),TelecineVideo}(),Xr=function(){function t(t,n){this.ho=t,this.B=n,this.Fo=null,this.Ho=this.B.embedTime?this.B.embedTime:0,this.Vo=!1,this.Bo=!1,this.$o=!1,this.playInitiated=!1,this.Wo=!1,Wt(this),this.qo=this.Go.bind(this),this.Yo=this.Ko.bind(this),this.zo=this.Xo.bind(this),this.Jo=this.Qo.bind(this),this.Zo=this.tu.bind(this),this.nu=this.iu.bind(this),this.eu(this.ho.on),this.ru()}var n=t.prototype;return n.destroy=function(){clearInterval(this.Fo),this.eu(this.ho.off),this.Go()},n.eu=function(t){t(Wi.PAUSE,this.Yo),t(Wi.PLAYING,this.qo),t(Wi.SEEKING,this.zo),t(Wi.SEEKED,this.Jo),t(Ki.STREAM_ONLINE,this.Zo),t(Ki.STREAM_OFFLINE,this.nu)},n.Ko=function(){this.userPlayState=!1},n.Go=function(){this.Vo&&(this.Vo=!1,this.fire(Yi.BUFFER_ENDED))},n.Xo=function(){this.Bo=!0},n.Qo=function(){this.Bo=!1},n.tu=function(){this.Wo=!0},n.iu=function(){this.Wo=!1},n.ru=function(){var t=this;clearInterval(this.Fo),this.Fo=setInterval((function(){if(t.ho.video){var n=t.ho.video.currentScanner;if(n){var i=t.ho.isLive(),e=n.currentTime;if(t.playInitiated&&(!t.Bo||i)&&(!t.ho.paused||t.userPlayState)&&!t.Vo&&e<t.Ho+.125){if(i&&!t.Wo)return;for(var r=t.ho.buffered,o=0;o<r.length;o++)if(e>=r.start(o)&&e+.2<=r.end(o))return;if(e+.125>=t.ho.duration)return;t.Vo=!0,t.fire(Yi.BUFFER_STARTED)}(t.playInitiated&&t.Vo&&e>t.Ho+.125||i&&!t.Wo&&t.Vo)&&(t.Vo=!1,t.fire(Yi.BUFFER_ENDED)),t.Ho=e}}}),250)},W(t,[{key:"userPlayState",get:function(){return this.$o},set:function(t){this.$o=t,t||this.Go()}}]),t}();function Jr(){var t,n;function i(){t.src?document.createElement("video").load():t.load()}function e(){if(!n)return s.reject();t.preload="";var i=t.play();return void 0===i&&(i=new s((function(n){t.addEventListener("playing",n)}))),i}function r(){n&&(n.resolve(),n=null)}function o(t){n&&(n.reject(t),n=null)}return{set video(n){t=n},get active(){return!!n},start:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.resolve.bind(s);return n||(n=new ht),i(),t().then(e).then(r).catch(o),n},cancel:function(){n&&(n.reject(new TelecineError("PlayInterrupted","The play() request was interrupted by a call to pause()")),n=null)}}}var Qr=function(){function t(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.V=t,this.ou=n,this.B=i,this.F=null,this.it=Oe(),this.uu={},this.su=new Xe(t),this.B.playRequest=new Jr,this.au=[],this.cu=[],Wt(this)}var n=t.prototype;return n.supportsEffect=function(t){var n=this;return!!t.supported&&t.supportedScanners.some((function(t){return n.hu(n.su)===t.displayName}))},n.getEffectByName=function(t){var n=this,i=null;return this.cu.forEach((function(e){t===n.fu(e)&&(i=e)})),i},n.activateEffect=function(t,n){var i=new t(this,n);return i.activate(),this.cu.push(i),i},n.deactivateEffect=function(t){var n=this;return this.cu.some((function(i,e){return i.constructor===t&&(i.deactivate(),n.cu.splice(e,1),!0)}))},n.deactivateEffects=function(){var t=this;this.cu.forEach((function(n){return t.deactivateEffect(n.constructor)}))},n.play=function(){if(!this.F||this.F.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");this.du.playInitiated||(this.du.playInitiated=!0),this.du.userPlayState=!0;var t=this.su.play();return this.uu.paused=!1,t},n.pause=function(){if(!this.F||this.F.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");return this.du.userPlayState=!1,this.su.pause(),this.uu.paused=!0,this},n.isLive=function(){return this.currentScannerName.includes("Live")},n.endLive=function(){this.su.endLive()},n.getBitrateAtTime=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video";return"MediaSourceScanner"!==this.hu(this.su)&&"HLSLiveScanner"!==this.hu(this.su)?0:"audio"===n&&this.su.Jt[n].length<=1?0:this.su.getBitrateAtTime(t,n)},n.showExternalDisplayPicker=function(t){this.su.showExternalDisplayPicker(t)},n.supportsPresentationMode=function(t){return-1!==this.supportedPresentationModes.indexOf(t)},n.addChapter=function(t,n){this.su.addChapter(t,n)},n.removeChapter=function(t){this.su.removeChapter(t)},n.addCuePoint=function(t,n){return this.su.addCuePoint(t,n)},n.removeCuePoint=function(t){return this.su.removeCuePoint(t)},n.removeAllCuePoints=function(){return this.su.removeAllCuePoints()},n.addVideoEventListeners=function(){return this.su.addVideoEventListeners()},n.removeVideoEventListeners=function(){return this.su.removeVideoEventListeners()},n.vu=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.textTrackSupport,e=void 0!==i&&i,r=this.F.files.sort((function(t,n){return t.priority-n.priority})),o=this.ou,u=function(n){var i=r[n];for(var u in o){var s=o[u];if(s.supported&&(!e||s.supportsTextTracks)&&-1===t.au.indexOf(t.hu(s))&&s.supportedVideoTypes.some((function(t){return i.mime===t})))return{v:s}}};for(var s in r){var a=u(s);if("object"===B(a))return a.v}return e?(this.at("TextTracksNotSupported","None of the scanners support text tracks in this browser."),this.au=[],this.vu()):null},n.lu=function(t,n){var i=this;if(this.su.constructor!==t||this.su.video!==n){this.su.deactivate();var e=new t(this.V,this.B);Object.keys(Qi).forEach((function(t){var n=Qi[t];e.on(n,(function(t){return i.pu(n,t,e)}))})),this.su=e,n.currentScanner=e,this.su.video=n;for(var r=Object.keys(this.uu),o=0;o<r.length;o++){var u=r[o];"paused"!==u?"currentTime"!==u&&(this.su[u]=this.uu[u]):!1===this.uu.paused&&this.su.play()}this.su.addChapters(n.chapters,n.duration),this.fire(Yi.SCANNER_CHANGE,this.hu(this.su))}},n.wu=function(){if(null!==this.F){var t=this.vu({textTrackSupport:this.F.textTracks.length>0});t?this.lu(t,this.F):this.at("FilesNotPlayable","None of the files could be played in this browser.")}},n.mu=function(){this.su.deactivate(),this.su=new Xe(this.V)},n.pu=function(t,n,i){if(i===this.su){switch(t){case Wi.ERROR:return void(n instanceof TelecineError&&this.fire(Wi.ERROR,n));case Yi.SCANNER_ERROR:this.at("ScannerError","The current scanner can no longer be used because ".concat(n.reason)),this.au.push(this.hu(this.su)),this.wu([]);break;case Yi.FILE_ERROR:this.at("FileError","The current file can no longer be used because ".concat(n.reason)),this.su.ct();break;case Yi.DOWNLOAD_ERROR:this.at("DownloadError",n),this.su.ct();break;case Yi.EME_UNSUPPORTED:this.at("DRMFailure",{text:null,code:"emeunsupported"});break;case Yi.DRM_FAILURE:case Yi.DRM_AUTH_FAILURE:this.at("DRMFailure",{text:n.text,code:n.code});break;case Yi.DRM_OUTPUT_RESTRICTED:this.at("DRMFailure",{text:null,code:"outputrestricted"});break;case Yi.DRM_AUTH_SUCCESS:this.fire(Yi.DRM_AUTH_SUCCESS);break;case Wi.TIME_UPDATE:this.uu.currentTime=this.su.currentTime;break;case Yi.MEDIA_URL_EXPIRED:this.at("MediaUrlExpired",n);break;case Yi.MEDIA_URL_BAD_REQUEST:this.at("MediaUrlBadRequest",n);break;case Ji.BRAIN_ML_MODEL_ERR:this.at("MimirError",n);break;case Ji.BRAIN_ML_MODEL_NET_ERR:this.at("MimirNetworkError",n);break;case Ji.BRAIN_ML_MODEL_TIMEOUT:this.at("MimirNetworkTimeout",n);break;case zi.SPATIAL_UNSUPPORTED:this.getEffectByName("ThreeSixtyEffect").deactivate();break;case Wi.ENDED:this.uu.paused=!0;break;case Wi.WAITING:this.fire(Wi.WAITING)}this.cu.forEach((function(n){"function"==typeof n["on".concat(t)]&&n["on".concat(t)]()})),this.fire(t,n)}},n.at=function(t,n){this.fire(Wi.ERROR,new TelecineError(t,n))},n.hu=function(t){return t instanceof Xe?t.constructor.displayName:t.prototype.constructor.displayName},n.ru=function(){var t=this;this.du&&this.du.destroy(),this.du=new Xr(this,this.B),this.du.on(Yi.BUFFER_STARTED,(function(){t.fire(Yi.BUFFER_STARTED)})),this.du.on(Yi.BUFFER_ENDED,(function(){t.fire(Yi.BUFFER_ENDED)}))},n.fu=function(t){return t instanceof Ur?t.constructor.displayName:t.prototype.constructor.displayName},n.yu=function(t){"HLSLiveScanner"===this.hu(this.su)&&this.su.setCaptionsState(t)},W(t,[{key:"element",get:function(){return this.V}},{key:"videoElement",get:function(){return this.su.videoElement}},{key:"manifest",get:function(){return this.su.manifest||{video:[]}}},{key:"supportsSettingVolume",get:function(){return this.ou.some((function(t){return t.supported&&t.supportsSettingVolume}))}},{key:"supportsPlaybackRate",get:function(){return this.su.constructor.supportsPlaybackRate}},{key:"supportsTextTracks",get:function(){return this.ou.some((function(t){return t.supported&&t.supportsTextTracks}))}},{key:"activeEffects",get:function(){return this.cu}},{key:"isLowerProfileAvailable",get:function(){return this.su.isLowerProfileAvailable}},{key:"buffered",get:function(){return this.su.buffered}},{key:"bufferTarget",get:function(){return this.su.bufferTarget},set:function(t){this.uu.bufferTarget=t,this.su.bufferTarget=t}},{key:"presentationDelay",get:function(){return this.su.presentationDelay},set:function(t){this.uu.presentationDelay=t,this.su.presentationDelay=t}},{key:"manifestLoadDurations",get:function(){return this.su.manifestLoadDurations?this.su.manifestLoadDurations:[]}},{key:"successfulSegments",get:function(){return this.su.successfulSegments?this.su.successfulSegments:[]}},{key:"failedSegments",get:function(){return this.su.failedSegments?this.su.failedSegments:[]}},{key:"cuePoints",get:function(){return this.su.cuePoints}},{key:"currentChapterID",get:function(){return this.su&&this.su.chaptersTrack&&this.su.chaptersTrack.activeCues.length?this.su.chaptersTrack.activeCues[0].id:null}},{key:"chapters",get:function(){return this.su.chaptersTrack?this.su.chaptersTrack.cues:[]}},{key:"chaptersTrack",get:function(){return this.su.chaptersTrack}},{key:"currentFile",get:function(){return this.su.currentFile},set:function(t){if("string"==typeof t&&(t=this.dt.filter((function(n){return n.id===t}))[0]),!t)throw new TelecineError("FileNotValid","The file is not valid.");this.su.currentFile=t}},{key:"currentScannerName",get:function(){return this.hu(this.su)}},{key:"currentTime",get:function(){return this.su.currentTime},set:function(t){this.uu.currentTime=t,this.su.currentTime=t}},{key:"duration",get:function(){return this.su.duration}},{key:"ended",get:function(){return this.su.ended}},{key:"externalDisplayAvailable",get:function(){return this.su.externalDisplayAvailable}},{key:"externalDisplayActive",get:function(){return this.su.externalDisplayActive}},{key:"loop",get:function(){return this.su.loop},set:function(t){this.uu.loop=t,this.su.loop=t}},{key:"muted",get:function(){return this.su.muted},set:function(t){this.uu.muted=!!t,this.su.muted=!!t}},{key:"playsinline",get:function(){return this.su.playsinline},set:function(t){this.uu.playsinline=!!t,this.su.playsinline=!!t}},{key:"paused",get:function(){return this.su.paused}},{key:"played",get:function(){return this.su.played}},{key:"seekable",get:function(){return this.su.seekable}},{key:"seeking",get:function(){return this.su.seeking}},{key:"defaultPlaybackRate",get:function(){return this.su.defaultPlaybackRate},set:function(t){this.uu.defaultPlaybackRate=t,this.su.defaultPlaybackRate=t}},{key:"playbackRate",get:function(){return this.su.playbackRate},set:function(t){this.uu.playbackRate=t,this.su.playbackRate=t}},{key:"preload",get:function(){return this.su.preload},set:function(t){this.uu.preload=t,this.su.preload=t}},{key:"presentationMode",get:function(){return this.su.presentationMode},set:function(t){this.su.presentationMode=t}},{key:"supportedPresentationModes",get:function(){return this.su.supportedPresentationModes}},{key:"video",get:function(){return this.F},set:function(t){this.F&&this.F.deactivate(),this.au=[],this.ru(),null===t?(this.F=null,this.mu()):(this.F=new TelecineVideo(t),this.wu())}},{key:"videoWidth",get:function(){return this.su.videoWidth}},{key:"videoHeight",get:function(){return this.su.videoHeight}},{key:"volume",get:function(){return this.su.volume},set:function(t){if(t<0||t>1)throw new TelecineError("IndexSizeError","Failed to set the 'volume' property: The volume provided (".concat(t,") is outside of the range [0, 1]."));this.uu.volume=t,this.su.volume=t}},{key:"brainDebug",get:function(){return this.su.brainDebug}}]),t}(),Zr=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).bu=!1,i.F=i.ho.su.F,i}K(n,t),W(n,null,[{key:"displayName",get:function(){return"CanvasEffect"}},{key:"supported",get:function(){return!0}},{key:"supportedScanners",get:function(){return[Xe,br]}}]);var i=n.prototype;return i.activate=function(){this.bu=!0,this.gu=document.createElement("canvas"),this.gu.className="vp-canvas-effect",this.gu.style.cssText="\n            position: absolute;\n            top:0;\n            left:0;\n            bottom:0;\n            right:0;\n        ",this.Eu=this.gu.getContext("2d",{alpha:!1}),this.V.appendChild(this.gu),this._u()},i.deactivate=function(){this.gu&&this.V.removeChild(this.gu),this.Tu(),this.bu=!1},i._u=function(){this.ku()},i.ku=function(){this.Au=window.requestAnimationFrame(this.Su.bind(this))},i.Su=function(){var t=this.F,n=this.gu;n.width=t.clientWidth,n.height=t.clientHeight;var i=Math.floor(this.Ru()),e=Math.floor(this.Ou()),r=Math.floor((t.clientWidth-i)/2),o=Math.floor((t.clientHeight-e)/2);this.Eu.fillStyle="#000",this.Eu.fillRect(0,0,n.width,n.height),this.Eu.drawImage(t,r,o,i,e),this.ku()},i.Mu=function(){return this.F.videoHeight/this.F.videoWidth},i.Ru=function(){return Math.min(this.F.clientHeight/this.Mu(),this.F.clientWidth)},i.Ou=function(){return Math.min(this.F.clientWidth*this.Mu(),this.F.clientHeight)},i.Tu=function(){this.Au&&(window.cancelAnimationFrame(this.Au),this.Au=null)},n}(Ur),to=function(){function t(){}return W(t,null,[{key:"Equirect",get:function(){return"equirectangular"}}]),t}(),no=function(){function t(){}return W(t,null,[{key:"Mono",get:function(){return"mono"}},{key:"TopBottom",get:function(){return"top-bottom"}}]),t}(),io=function(){function t(t,n,i){switch(this.isStereo=n!==no.Mono,this.Iu=null,this.Du=null,t){case to.Equirect:this.createEquirectProjection(i,n);break;default:this.createEquirectProjection(i,no.Mono)}}var n=t.prototype;return n.createEquirectProjection=function(t,n){switch(n){case no.Mono:this.Iu=this.ju(t);break;case no.TopBottom:this.Iu=this.ju(t),this.Du=this.ju(t),this.Iu.layers.set(1),this.Du.layers.set(2),this.Nu(this.Iu.geometry,.5,0),this.Nu(this.Du.geometry,.5,.5)}},n.ju=function(n,i,e,r){var o=new THREE.SphereBufferGeometry(i||t.SPHERE_RADIUS,e||t.TESSELATION_WIDTH,r||t.TESSELATION_HEIGHT);o.scale(-1,1,1);var u=new THREE.MeshBasicMaterial({map:n});return new THREE.Mesh(o,u)},n.Nu=function(t,n,i){for(var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=0;r<t.attributes.uv.array.length;r+=2)t.attributes.uv.array[r+e]*=n,t.attributes.uv.array[r+e]+=i},W(t,[{key:"left",get:function(){return this.Iu}},{key:"right",get:function(){return this.Du}}],[{key:"TESSELATION_WIDTH",get:function(){return 120}},{key:"TESSELATION_HEIGHT",get:function(){return 80}},{key:"SPHERE_RADIUS",get:function(){return 500}}]),t}(),eo=function(){function t(t){this.Pu=t}var n=t.prototype;return n.hasVRHeadset=function(){var t=this;return fe.webvr?navigator.getVRDisplays().then((function(n){return n.length>0?(t.Pu.vr.setDevice(n[0]),n[0]):null})):null},n.enter=function(){return this.Pu.vr.getDevice()&&this.Pu.vr.getDevice().requestPresent([{source:this.Pu.domElement}])},n.exit=function(){return this.Pu.vr.getDevice()&&this.Pu.vr.getDevice().exitPresent()},W(t,[{key:"supported",get:function(){return fe.webvr}},{key:"device",get:function(){return this.Pu&&this.Pu.vr.getDevice()?this.Pu.vr.getDevice():null}},{key:"isPresenting",get:function(){return!(!this.Pu||!this.Pu.vr.getDevice())&&this.Pu.vr.getDevice().isPresenting}}]),t}(),ro=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).bu=!1,i.Cu=null,i.xu=null,i.Pu=null,i.isUserInteracting=!1,i.Lu=0,i.Uu=0,i._coordinates={lat:0,long:0},i.Fu={lat:0,long:0},i.Hu={lat:0,long:0},i.Vu=0,i.Bu=0,i.$u=0,i.F=i.ho.su.F,i.Wu=null,i.qu={x:0,y:0},i.Gu={lat:0,long:0},i.Yu={videoFps:i.B.fps,motionRenderSpeed:60},i.Ku=1e3/i.Yu.videoFps,i.zu=[],i.Xu=!1,i.Ju=!1,i.Qu=!1,i.Zu={up:!1,down:!1,left:!1,right:!1},i}K(n,t),W(n,[{key:"isUserInteracting",set:function(t){t!==this.ts&&(this.ts=t,t?this.B.isMobile||this.ho.fire(zi.MOTION_START):this.B.isMobile||this.ho.fire(zi.MOTION_END))},get:function(){return this.ts}}],[{key:"displayName",get:function(){return"ThreeSixtyEffect"}},{key:"supported",get:function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(t){return this.ho.su.fire(zi.SPATIAL_UNSUPPORTED),!1}}},{key:"supportedScanners",get:function(){return[Xe,br]}}]),n.frustumSurfaceArea=function(t,n,i){var e=2*io.SPHERE_RADIUS*2*Math.sin(Math.PI/180*(t/2));return e*(e*n/i)/(4*Math.PI*Math.pow(io.SPHERE_RADIUS,2))};var i=n.prototype;return i.activate=function(){var t=this;return new s((function(n,i){if(window.THREE)n();else{var e=document.createElement("script");e.src=t.B.threeUrl,document.body.appendChild(e),e.onload=function(){n()}}})).then((function(){return t.Rt()}))},i.Rt=function(){var t=this;this.bu=!0,this.Cu=new THREE.PerspectiveCamera(this.B.fieldOfView,this.F.clientWidth/this.F.clientHeight,1,2*io.SPHERE_RADIUS),this.Cu.target=new THREE.Vector3(0,0,0),this.Cu.layers.enable(1),this.ns(this.B.directorTimeline),this.xu=new THREE.Scene,this.es=new THREE.VideoTexture(this.F),this.es.generateMipmaps=!1,this.es.minFilter=THREE.NearestFilter,this.es.maxFilter=THREE.NearestFilter,this.es.format=THREE.RGBFormat,this.rs=new io(this.B.projection,this.B.stereoMode,this.es),this.rs.isStereo&&this.xu.add(this.rs.right),this.xu.add(this.rs.left),this.Pu=new THREE.WebGLRenderer,this.Pu.vr.enabled=!0,this.Pu.setPixelRatio(window.devicePixelRatio),this.os=document.createElement("div"),this.os.appendChild(this.Pu.domElement),this.V.appendChild(this.os),this.us(),this.ho.su.F.setAttribute("crossorigin","anonymous"),this._u(),this.ho.su.paused||this.ss(),this.as=new eo(this.Pu),this.as.supported&&this.as.hasVRHeadset().then((function(n){setTimeout((function(){t.ho.fire(zi.WEBVR_HARDWARE_AVAILABLE,t.as.device)}),100)})).catch((function(t){}))},i.toggleVR=function(){var t=this;if(this.as.isPresenting)this.as.exit().then((function(){t.adjustRenderSize()})).catch((function(t){}));else{if(this.ho.su.paused)return;this.as.enter().then((function(){t.adjustRenderSize()})).catch((function(t){}))}},i.onplay=function(){this.bu&&(this.ss(),this.adjustRenderSize())},i.deactivate=function(){this.os&&this.V.removeChild(this.os),this.Tu(),this.bu=!1},i.snapToCenter=function(){var t=this;this.zu.forEach((function(t){return clearTimeout(t)}));var n=((this._coordinates.long>=180?360:0)-this._coordinates.long)/11,i=(0-this._coordinates.lat)/11;this.$u=0;for(var e=function(e){t.zu.push(setTimeout((function(){0===e&&(t.Xu=!0,t.B.isMobile||(t.Ku=1e3/t.Yu.motionRenderSpeed)),49===e&&(t.Xu=!1,t.B.isMobile||(t.Ku=1e3/t.Yu.videoFps)),t.cs(t._coordinates.lat+i/Math.pow(1.1,e),t._coordinates.long+n/Math.pow(1.1,e)),t.Gu.lat=THREE.Math.radToDeg(t.qu.x)+t._coordinates.lat+i/Math.pow(1.1,e),t.Gu.long=THREE.Math.radToDeg(t.qu.y)+t._coordinates.long+i/Math.pow(1.1,e)}),e*t.Ku))},r=0;r<50;r++)e(r)},i.isStereo=function(){return!!this.rs&&this.rs.isStereo},i.ns=function(t){t&&t[0]&&void 0!==t[0].p&&"undefined"!==t[0].y&&this.cs(t[0].p,t[0].y)},i.cs=function(t,n){this.Fu.long=this._coordinates.long,this.Fu.lat=this._coordinates.lat,t%=360,this._coordinates.lat=Math.max(-85,Math.min(85,t)),n=(n%=360)>=0?n:360+n,this._coordinates.long=n},i.makeContact=function(t){this.isUserInteracting=!0,this.zu.forEach((function(t){return clearTimeout(t)})),this.Xu=!1,this.hs={x:t.x,y:t.y},this.Hu.long=this._coordinates.long,this.Hu.lat=this._coordinates.lat,this.fs={long:this._coordinates.long,lat:this._coordinates.lat},this.B.isMobile||(this.Ku=1e3/this.Yu.motionRenderSpeed)},i.move=function(t){this.Gu.lat=THREE.Math.radToDeg(this.qu.x)+this.Fu.lat,this.Gu.long=THREE.Math.radToDeg(this.qu.y)+this.Fu.long;var n=this.fs.lat-.2*(this.hs.y-t.y),i=.2*(this.hs.x-t.x)+this.fs.long;this.cs(n,i)},i.moveWheel=function(t){this.Gu.lat=THREE.Math.radToDeg(this.qu.x)+this.Fu.lat,this.Gu.long=THREE.Math.radToDeg(this.qu.y)+this.Fu.long;var n=this._coordinates.lat-.1*t.y,i=this._coordinates.long+.1*t.x;this.cs(n,i)},i.moveDevice=function(t,n,i,e){this.Qu=!0;var r=new THREE.Quaternion,o=window.orientation;null===o&&(o=this.F.clientWidth>this.F.clientHeight?90:0),t=t?THREE.Math.degToRad(t):0,n=n?THREE.Math.degToRad(n):0,i=i?THREE.Math.degToRad(i):0;var u=o?THREE.Math.degToRad(o):0,s=new THREE.Vector3(0,0,1),a=new THREE.Euler,c=new THREE.Quaternion,h=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));a.set(n,t,-i,"YXZ"),r.setFromEuler(a),r.multiply(h),r.multiply(c.setFromAxisAngle(s,-u)),this.qu=(new THREE.Euler).setFromQuaternion(r,"YXZ"),this.$u=this.qu.z,this.isUserInteracting||this.Xu||this.cs(THREE.Math.radToDeg(this.qu.x)-this.Gu.lat,-THREE.Math.radToDeg(this.qu.y)+this.Gu.long),this.Ju||(this.snapToCenter(),this.ho.fire(zi.MOTION_START),this.Ju=!0)},i.releaseContact=function(t){if(this.Gu.lat=THREE.Math.radToDeg(this.qu.x)-this._coordinates.lat,this.Gu.long=THREE.Math.radToDeg(this.qu.y)+this._coordinates.long,this.isUserInteracting=!1,this.fs&&!t){var n=Math.hypot(this._coordinates.long-this.fs.long,this._coordinates.lat-this.fs.lat);this.ds(n)}},i.abandonMotion=function(){this.isUserInteracting=!1,this.fs=null},i.keyPress=function(t){this.vs()||(this.isUserInteracting=!0,this.zu&&this.zu.forEach((function(t){return clearTimeout(t)}))),this.Zu[t]||(this.Zu[t]=!0)},i.keyUp=function(t){this.Zu[t]=!1,this.vs()||(this.isUserInteracting=!1,this.ds(1/0))},i.ls=function(){var t=this;Object.keys(this.Zu).forEach((function(n){if(t.Zu[n])switch(n){case"up":t.cs(t._coordinates.lat+2,t._coordinates.long);break;case"down":t.cs(t._coordinates.lat-2,t._coordinates.long);break;case"left":t.cs(t._coordinates.lat,t._coordinates.long-2);break;case"right":t.cs(t._coordinates.lat,t._coordinates.long+2)}}))},i.vs=function(){var t=this;return Object.keys(this.Zu).map((function(n){return t.Zu[n]})).some((function(t){return t}))},i.ds=function(t){var n=this;t>=20&&function(){var i={long:n._coordinates.long-n.Fu.long,lat:n._coordinates.lat-n.Fu.lat};t===1/0&&(i.long/=2,i.lat/=2);for(var e=function(t){n.zu.push(setTimeout((function(){1===t&&(n.Xu=!0),49===t&&(n.Xu=!1,n.Ku=1e3/n.Yu.videoFps);var e=2/Math.pow(t,1.5);n.Gu.lat=THREE.Math.radToDeg(n.qu.x)+n._coordinates.lat+i.lat,n.Gu.long=THREE.Math.radToDeg(n.qu.y)+n._coordinates.long+i.long,n.cs(n._coordinates.lat+i.lat*e,n._coordinates.long+i.long*e)}),t*n.Ku))},r=1;r<50;r++)e(r)}()},i.onseeked=function(){this.bu&&this.ps()},i.onresize=function(){this.adjustRenderSize(),this.isUserInteracting=!1},i.ps=function(){this.isVRPresenting||(this.Vu=THREE.Math.degToRad(90+this._coordinates.lat),this.Bu=THREE.Math.degToRad(this._coordinates.long),this.Cu.position.set(Math.sin(this.Vu)*Math.cos(this.Bu),Math.cos(this.Vu),Math.sin(this.Vu)*Math.sin(this.Bu)),this.Cu.lookAt(this.Cu.target),this.Cu.rotation.z+=this.$u,this.ho.fire(zi.CAMERA_UPDATE,{lon:this._coordinates.long,lat:this._coordinates.lat})),this.Pu.render(this.xu,this.Cu)},i.adjustRenderSize=function(){if(this.isVRPresenting)this.Cu.aspect=this.F.clientWidth/this.F.clientHeight,this.Cu.updateProjectionMatrix(),this.Pu.setSize(this.F.clientWidth,this.F.clientHeight);else{this.F.clientWidth>this.F.clientHeight?this.Cu.aspect=Math.max(1,Math.min(2,this.F.clientWidth/this.F.clientHeight)):this.Cu.aspect=Math.max(1/3,Math.min(3,this.F.clientWidth/this.F.clientHeight)),this.Cu.updateProjectionMatrix();var t=Pe(this.F.clientWidth,this.F.clientHeight,this.Cu.aspect,1);this.Pu.setSize(t.width,t.height),this.os.style.paddingTop="".concat(t.top,"px")}},i._u=function(){var t=this;this.Pu.setAnimationLoop((function(){t.vs()&&t.ls(),t.ps()}))},i.Tu=function(){this.Pu.setAnimationLoop(null)},i.ss=function(){this.ws({backgroundColor:"#000",display:"block"})},i.us=function(){this.ws({backgroundColor:"#000",display:"none"})},i.ws=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.backgroundColor,i=t.display;this.os.style.cssText="position:absolute;left:0;top:0;margin-left:auto;margin-right:auto;padding:0;background:".concat(n,";width:100%;height:100%;text-align:center;display:").concat(i)},W(n,[{key:"currentCoordinates",get:function(){return this._coordinates},set:function(t){var n=nt(t,2),i=n[0],e=n[1];if(i>90||i<-90)throw new RangeError("Latitude should be a float between -90 and 90.");if(e<0||e>360)throw new RangeError("Longitude should be a float between 0 and 360.");this.cs(i,e),this.ps()}},{key:"isVRPresenting",get:function(){return this.as&&this.as.isPresenting}},{key:"fieldOfView",get:function(){return this.Cu.fov},set:function(t){this.Cu.fov=t,this.Cu.updateProjectionMatrix(),this.Pu.render(this.xu,this.Cu)}},{key:"hasVRHeadset",get:function(){return this.as&&!!this.as.device}}]),n}(Ur);function oo(t){return"symbol"==B(t)||ii(t)&&"[object Symbol]"==un(t)}var uo=/^\s+|\s+$/g,so=/^[-+]0x[0-9a-f]+$/i,ao=/^0b[01]+$/i,co=/^0o[0-7]+$/i,ho=parseInt;function fo(t){if("number"==typeof t)return t;if(oo(t))return NaN;if(sn(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=sn(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(uo,"");var i=ao.test(t);return i||co.test(t)?ho(t.slice(2),i?2:8):so.test(t)?NaN:+t}var vo=Qt?Qt.prototype:void 0,lo=vo?vo.toString:void 0;function po(t){if("string"==typeof t)return t;if(ai(t))return function(t,n){for(var i=-1,e=null==t?0:t.length,r=Array(e);++i<e;)r[i]=n(t[i],i,t);return r}(t,po)+"";if(oo(t))return lo?lo.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}function wo(t){return null==t?"":po(t)}var mo=Jt.isFinite,yo=Math.min,bo=function(t){var n=Math.round;return function(t,i){if(t=fo(t),(i=null==i?0:yo(function(t){var n=function(t){return t?(t=fo(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}(t),i=n%1;return n==n?i?n-i:n:0}(i),292))&&mo(t)){var e=(wo(t)+"e").split("e");return+((e=(wo(n(e[0]+"e"+(+e[1]+i)))+"e").split("e"))[0]+"e"+(+e[1]-i))}return n(t)}}();function go(t){return!isNaN(t)}function Eo(t){return bo(t,3)}var _o=0;function To(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"b",n=++_o;return"".concat(t).concat(n)}To(),To();var ko=To(),Ao=To(),So=To(),Ro=To(),Oo=To(),Mo=To(),Io=To(),Do=To(),jo=To(),No=To(),Po=To(),Co=To(),xo=To(),Lo=To(),Uo=To(),Fo=To(),Ho=To(),Vo=To(),Bo=To(),$o=To(),Wo=To(),qo=Object.freeze({__proto__:null,CONFIG_CHANGED:jo,TELECINE_READY:No,TELECINE_VIDEO_INIT:Po,PLAY_INITIATED:Co,QUALITY_CHANGED:xo,FORCED_QUALITY:Lo,CUE_CHANGED:Uo,CAPTIONS_CHANGED:Fo,SPATIAL_PLAYBACK_TOGGLED:Ho,PICTURE_IN_PICTURE_AVAILABLE:Vo,PICTURE_IN_PICTURE_NOT_AVAILABLE:Bo,PICTURE_IN_PICTURE_ACTIVATED:$o,PICTURE_IN_PICTURE_DEACTIVATED:Wo}),Go=Object.freeze({__proto__:null,EVENT_PENDING:"liveeventpending",EVENT_ACTIVE:"liveeventactive",EVENT_STARTING:"liveeventstarting",EVENT_STARTED:"liveeventstarted",EVENT_ENDED:"liveeventended",ARCHIVE_STARTED:"livearchivestarted",ARCHIVE_DONE:"livearchivedone",ARCHIVE_ERROR:"livearchiveerror"}),Yo={h264:"video/mp4",hls:"application/vnd.apple.mpegurl",hlsLive:"application/x-mpegURL",dash:"application/vnd.vimeo.dash+json",dashMpd:"video/vnd.mpeg.dash.mpd",vp6:"video/x-flv",vp8:"video/webm",webm:"video/webm",hds:"application/f4m"},Ko={"application/vnd.apple.mpegurl":"hls","application/vnd.vimeo.dash+json":"dash","video/vnd.mpeg.dash.mpd":"dash","video/mp4":"progressive","video/webm":"progressive","video/x-flv":"progressive","application/x-mpegURL":"hlslive"},zo=(Y({},Wi,{},Yi,{},Ki,{},Go,{},zi,{},qi,{},Xi,{},Ji,{},qo),Y({},Ki,{},Go));function Xo(t){var n;return"done"===(null==t?void 0:null==(n=t.archive)?void 0:n.status)}function Jo(t){return"pending"===(null==t?void 0:t.status)}function Qo(t){return"started"===(null==t?void 0:t.status)}function Zo(t){return"ended"===(null==t?void 0:t.status)}function tu(t){return nu(t,"/playlist/refresh")}function nu(t,n){var i,e=null==(i=t.request.files.hls)?void 0:i.default_cdn,r=t.request,o=r.signature,u=r.timestamp,s=r.expires,a="https://".concat(t.player_url,"/live/").concat(t.video.id),c="?signature=".concat(o,"&time=").concat(u,"&expires=").concat(s,"&cdn=").concat(e);return"".concat(a).concat(n).concat(c)}var iu=Jn(Object.keys,Object),eu=Object.prototype.hasOwnProperty;function ru(t){if(!ti(t))return iu(t);var n=[];for(var i in Object(t))eu.call(t,i)&&"constructor"!=i&&n.push(i);return n}var ou=bn(Jt,"DataView"),uu=bn(Jt,"Promise"),su=bn(Jt,"Set"),au=bn(Jt,"WeakMap"),cu=dn(ou),hu=dn(Mn),fu=dn(uu),du=dn(su),vu=dn(au),lu=un;(ou&&"[object DataView]"!=lu(new ou(new ArrayBuffer(1)))||Mn&&"[object Map]"!=lu(new Mn)||uu&&"[object Promise]"!=lu(uu.resolve())||su&&"[object Set]"!=lu(new su)||au&&"[object WeakMap]"!=lu(new au))&&(lu=function(t){var n=un(t),i="[object Object]"==n?t.constructor:void 0,e=i?dn(i):"";if(e)switch(e){case cu:return"[object DataView]";case hu:return"[object Map]";case fu:return"[object Promise]";case du:return"[object Set]";case vu:return"[object WeakMap]"}return n});var pu=lu,wu=Object.prototype.hasOwnProperty;function mu(t){if(null==t)return!0;if(hi(t)&&(ai(t)||"string"==typeof t||"function"==typeof t.splice||li(t)||Ri(t)||si(t)))return!t.length;var n=pu(t);if("[object Map]"==n||"[object Set]"==n)return!t.size;if(ti(t))return!ru(t).length;for(var i in t)if(wu.call(t,i))return!1;return!0}function yu(t){return hi(t)?Ci(t):ru(t)}function bu(){return[]}var gu=Object.prototype.propertyIsEnumerable,Eu=Object.getOwnPropertySymbols,_u=Eu?function(t){return null==t?[]:(t=Object(t),function(t,n){for(var i=-1,e=null==t?0:t.length,r=0,o=[];++i<e;){var u=t[i];n(u)&&(o[r++]=u)}return o}(Eu(t),(function(n){return gu.call(t,n)})))}:bu;function Tu(t,n){for(var i=-1,e=n.length,r=t.length;++i<e;)t[r+i]=n[i];return t}var ku=Object.getOwnPropertySymbols?function(t){for(var n=[];t;)Tu(n,_u(t)),t=Qn(t);return n}:bu;function Au(t,n,i){var e=n(t);return ai(t)?e:Tu(e,i(t))}function Su(t){return Au(t,yu,_u)}function Ru(t){return Au(t,Li,ku)}var Ou=Object.prototype.hasOwnProperty,Mu=/\w*$/,Iu=Qt?Qt.prototype:void 0,Du=Iu?Iu.valueOf:void 0;var ju=Ai&&Ai.isMap,Nu=ju?Ei(ju):function(t){return ii(t)&&"[object Map]"==pu(t)},Pu=Ai&&Ai.isSet,Cu=Pu?Ei(Pu):function(t){return ii(t)&&"[object Set]"==pu(t)},xu={};function Lu(t,n,i,e,r,o){var u,s=1&n,a=2&n,c=4&n;if(i&&(u=r?i(t,e,r,o):i(t)),void 0!==u)return u;if(!sn(t))return t;var h=ai(t);if(h){if(u=function(t){var n=t.length,i=new t.constructor(n);return n&&"string"==typeof t[0]&&Ou.call(t,"index")&&(i.index=t.index,i.input=t.input),i}(t),!s)return Kn(t,u)}else{var f=pu(t),d="[object Function]"==f||"[object GeneratorFunction]"==f;if(li(t))return Wn(t,s);if("[object Object]"==f||"[object Arguments]"==f||d&&!r){if(u=a||d?{}:ni(t),!s)return a?function(t,n){return Di(t,ku(t),n)}(t,function(t,n){return t&&Di(n,Li(n),t)}(u,t)):function(t,n){return Di(t,_u(t),n)}(t,function(t,n){return t&&Di(n,yu(n),t)}(u,t))}else{if(!xu[f])return r?t:{};u=function(t,n,i){var e=t.constructor;switch(n){case"[object ArrayBuffer]":return Gn(t);case"[object Boolean]":case"[object Date]":return new e(+t);case"[object DataView]":return function(t,n){var i=n?Gn(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}(t,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Yn(t,i);case"[object Map]":return new e;case"[object Number]":case"[object String]":return new e(t);case"[object RegExp]":return function(t){var n=new t.constructor(t.source,Mu.exec(t));return n.lastIndex=t.lastIndex,n}(t);case"[object Set]":return new e;case"[object Symbol]":return function(t){return Du?Object(Du.call(t)):{}}(t)}}(t,f,s)}}o||(o=new xn);var v=o.get(t);if(v)return v;o.set(t,u),Cu(t)?t.forEach((function(e){u.add(Lu(e,n,i,e,t,o))})):Nu(t)&&t.forEach((function(e,r){u.set(r,Lu(e,n,i,r,t,o))}));var l=c?a?Ru:Su:a?keysIn:yu,p=h?void 0:l(t);return function(t,n){for(var i=-1,e=null==t?0:t.length;++i<e&&!1!==n(t[i],i););}(p||t,(function(e,r){p&&(e=t[r=e]),Ii(u,r,Lu(e,n,i,r,t,o))})),u}function Uu(t){return Lu(t,5)}function Fu(t){var n=this,i={},e={get attributes(){return Object.assign({},n)},get previousAttributes(){return i},clear:function(){r();var t=n.attributes;for(var i in t)delete n[i]},set:function(t){for(var i in r(),t=Uu(t))n[i]=t[i]},clone:function(){return new Fu(n.attributes)},toJSON:function(){return Uu(n.attributes)}};function r(){mu(n.attributes)||(i=Uu(n.attributes))}return e.set(t),rt(n,e)}function Hu(t,n){var i=new Fu(Bi(t,n)),e=!1;return ot(i,{reset:function(t){return i.clear(),function(t){e=!0,i.set(t),Bi(i,n)}(t),i},isNewVideo:function(){var t=i.previousAttributes;return!e||t.video.id!==i.video.id||t.video.version.current!==i.video.version.current||t.video.live_event&&!Xo(t.video.live_event)&&Xo(i.video.live_event)}})}xu["[object Arguments]"]=xu["[object Array]"]=xu["[object ArrayBuffer]"]=xu["[object DataView]"]=xu["[object Boolean]"]=xu["[object Date]"]=xu["[object Float32Array]"]=xu["[object Float64Array]"]=xu["[object Int8Array]"]=xu["[object Int16Array]"]=xu["[object Int32Array]"]=xu["[object Map]"]=xu["[object Number]"]=xu["[object Object]"]=xu["[object RegExp]"]=xu["[object Set]"]=xu["[object String]"]=xu["[object Symbol]"]=xu["[object Uint8Array]"]=xu["[object Uint8ClampedArray]"]=xu["[object Uint16Array]"]=xu["[object Uint32Array]"]=!0,xu["[object Error]"]=xu["[object Function]"]=xu["[object WeakMap]"]=!1;var Vu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Bu=/^\w*$/;function $u(t,n){if("function"!=typeof t||null!=n&&"function"!=typeof n)throw new TypeError("Expected a function");var i=function i(){var e=arguments,r=n?n.apply(this,e):e[0],o=i.cache;if(o.has(r))return o.get(r);var u=t.apply(this,e);return i.cache=o.set(r,u)||o,u};return i.cache=new($u.Cache||Cn),i}$u.Cache=Cn;var Wu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,qu=/\\(\\)?/g,Gu=function(t){var n=$u((function(t){var n=[];return 46===t.charCodeAt(0)&&n.push(""),t.replace(Wu,(function(t,i,e,r){n.push(e?r.replace(qu,"$1"):i||t)})),n}),(function(t){return 500===i.size&&i.clear(),t})),i=n.cache;return n}();function Yu(t){if("string"==typeof t||oo(t))return t;var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}function Ku(t,n,i){var e=null==t?void 0:function(t,n){for(var i=0,e=(n=function(t,n){return ai(t)?t:function(t,n){if(ai(t))return!1;var i=B(t);return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!oo(t))||Bu.test(t)||!Vu.test(t)||null!=n&&t in Object(n)}(t,n)?[t]:Gu(wo(t))}(n,t)).length;null!=t&&i<e;)t=t[Yu(n[i++])];return i&&i==e?t:void 0}(t,n);return void 0===e?i:e}var zu=navigator.userAgent.toLowerCase();function Xu(t){t=t.toLowerCase();var n=new RegExp(t).test(zu);return"safari"===t?n&&new RegExp("version").test(zu):n}function Ju(t){var n=document.createElement("div"),i=t.charAt(0).toUpperCase()+t.slice(1),e=(t+" "+["Webkit","Moz","O","ms"].join(i+" ")+i).split(" ");for(var r in e){var o=e[r];if(void 0!==n.style[o])return o}return t}var Qu=!!Xu("android")&&(parseFloat(zu.replace(/^.* android (\d+)\.(\d+).*$/,"$1.$2"))||!0),Zu=window.devicePixelRatio||1,ts=!(!Xu("windows phone")&&!Xu("iemobile"))&&(parseFloat(zu.replace(/^.* windows phone (os )?(\d+)\.(\d+).*$/,"$2.$3"))||!0),ns=!!Xu("msie")&&parseFloat(zu.replace(/^.*msie (\d+).*$/,"$1")),is=!!Xu("trident")&&parseFloat(zu.replace(/^.*trident\/(\d+)\.(\d+).*$/,"$1.$2"))+4,es=!!(Xu("ipad;")||Xu("iphone;")||Xu("ipod touch;"))&&parseFloat(zu.replace(/^.* os (\d+)_(\d+).*$/,"$1.$2")),rs=Xu("opera")||Xu("opr");function os(){if(!Xu("safari"))return[];var t=zu.split(" ").find((function(t){return/version\//.test(t)}));return t?t.replace("version/","").split(".").map((function(t){return parseInt(t,10)})):[]}var us=Xu("safari")&&Xu("apple")&&!Xu("chrome")&&!Xu("android")&&os()[0]>=11,ss={airPlay:"WebKitPlaybackTargetAvailabilityEvent"in window,android:Qu,hasAutoplayPolicy:Qu||es||us||function(){if(!Xu("chrome"))return[];var t=zu.split(" ").find((function(t){return es?/CriOS\//.test(t):/chrome\//.test(t)}));return t?t.replace("chrome/","").split(".").map((function(t){return parseInt(t,10)})):[]}()[0]>=66,iOS:es,mobileAndroid:Qu&&Xu("mobile"),browser:{bb10:Xu("bb10"),chrome:Xu("chrome"),firefox:Xu("firefox"),ie:ns||is,edge:Xu("edge"),opera:rs,safari:Xu("safari")&&Xu("apple")&&!Xu("chrome")&&!Xu("android")},devicePixelRatio:Zu,iPhone:Xu("iphone;")||Xu("ipod touch;")||Xu("ipod;"),iPad:Xu("ipad;"),iPadNonRetina:Xu("ipad;")&&Zu<2,mac:Xu("mac os"),pointerEvents:window.navigator.pointerEnabled||window.navigator.msPointerEnabled||!1,svg:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||Xu("windows phone")||window.navigator.maxTouchPoints>1||window.navigator.msMaxTouchPoints||!1,transformProperty:Ju("transform"),transitionProperty:Ju("transition"),webp:function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))&&0===t.toDataURL("image/webp").indexOf("data:image/webp")}(),windowsPhone:ts},as=/mac os x 10_13/.test(zu),cs=ss.iOS&&ss.iOS>=11,hs=ss.iPhone&&812===window.screen.availHeight&&375===window.screen.availWidth,fs=ss.iPhone&&896===window.screen.availHeight&&414===window.screen.availWidth,ds=ss.iPad&&1112===window.screen.availWidth&&834===window.screen.availHeight,vs=ss.iPad&&834===window.screen.availWidth&&1194===window.screen.availHeight,ls=ss.iPad&&1024===window.screen.availWidth&&1366===window.screen.availHeight,ps=hs||fs||ds||vs||ls;function ws(){return!!(us&&as||us&&cs)||"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported('video/mp4; codecs="hvc1"')}function ms(){return!(ss.iOS||ss.iPad||ss.browser.ie)&&(!Xu("safari")||os()[0]>11||11===os()[0]&&(os()[2]>1||os()[1]>0))}function ys(t,n,i){return void 0===i&&(i=n,n=void 0),void 0!==i&&(i=(i=fo(i))==i?i:0),void 0!==n&&(n=(n=fo(n))==n?n:0),function(t,n,i){return t==t&&(void 0!==i&&(t=t<=i?t:i),void 0!==n&&(t=t>=n?t:n)),t}(fo(t),n,i)}function bs(t){return t.quality||t.metadata.quality}function gs(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],e=t.url;if("avc_url"in t&&(e=t.avc_url),i)return e;var r=n?ss.spatialHEVC&&ss.hevc:ss.hevc,o=n?ss.spatialHEVC&&ss.hdr:ss.hdr;return o&&"hevc_hdr_url"in t?e=t.hevc_hdr_url:r&&"hevc_sdr_url"in t?e=t.hevc_sdr_url:ss.av1&&"av1_url"in t&&(e=t.av1_url),e}function Es(t){if(mu(t.progressive))return[];var n=t.progressive;return"progressive_avc"in t&&(n=t.progressive_avc),n.filter(Ts(n))}function _s(t){if("number"==typeof t)return t;var n=t.split("-");return 5===n.length?n[0]:parseInt(n[0],10)}function Ts(t){var n=t.filter(ks).map(bs);return function(t){return-1===n.indexOf(bs(t))||ks(t)}}function ks(t){var n=t.fps;return"metadata"in t&&(n=t.metadata.fps),n>30}function As(t){return Ss(t)>=720}function Ss(t){return"string"!=typeof t&&(t=bs(t)),parseInt(t,10)}function Rs(t){var n=Es(t.request.files).map((function(t){return t.quality}));return Os(t,t.embed.quality,n)}function Os(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return t.embed.on_site||ss.android||ss.iOS||ss.windowsPhone||!n?null:i.length&&-1===i.indexOf(n)?null:n}function Ms(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"desc";return function(n,i){var e=Ss(n),r=Is(n),o=Ss(i),u=Is(i);return"asc"===t?e-o||r-u:o-e||u-r}}function Is(t){return"object"!==B(t)?0:"fps"in t?t.fps:"metadata"in t&&"fps"in t.metadata?t.metadata.fps:0}function Ds(t){var n=t.video.live_event,i=t.request.files;if(!mu(i.hls)){var e,r=i.hls.default_cdn,o=i.hls.cdns[r].json_url||(null==(e=n.playback)?void 0:e.hls_noredirect),u=t.request.flags.live_dash?2:1;return{id:"hls-".concat(r,"-").concat(t.video.id),src:o,mime:Yo.hlsLive,priority:u,metadata:{cdn:r,origin:i.hls.cdns[r].origin,quality:"sd"}}}return null}function js(t,n){var i=[];if(n.video){var e=n.video.currentFile.mime;if(e===Yo.hlsLive)return n.manifest.video.map((function(t){return Y({},t,{quality:"".concat(t.height,"p")})}));i=[Yo.dash,Yo.dashMpd].includes(e)?function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return[];var i=t.streams;"streams_avc"in t&&(i=t.streams_avc);var e=n?ss.spatialHEVC&&ss.hevc:ss.hevc,r=n?ss.spatialHEVC&&ss.hdr:ss.hdr;return r&&"streams_hevc_hdr"in t?i=t.streams_hevc_hdr:e&&"streams_hevc_sdr"in t?i=t.streams_hevc_sdr:ss.av1&&"streams_av1"in t&&(i=t.streams_av1),i}(t.request.files.dash,t.video.spatial):n.video.files.filter((function(t){return"progressive"===Ko[t.mime]}))}return i.filter(Ts(i)).sort(Ms())}function Ns(t){return ss.spatialPlayback&&t.video.spatial?35:50}ss.hevc=ws(),ss.hdr=us&&cs&&ps,ss.vp9hdr=(window.matchMedia("(color-gamut: p3)").matches||window.matchMedia("(color-gamut: rec2020)").matches)&&screen.colorDepth>=48&&(MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.01"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.01"')),ss.av1="undefined"!=typeof MediaSource&&MediaSource.isTypeSupported('video/mp4; codecs="av01.0.31M.08.0.110.01.01.01.0"'),ss.webvr=!!(window.navigator&&"getVRDisplays"in window.navigator),ss.webxr=!!(window.navigator&&"xr"in window.navigator&&"supportsSession"in window.navigator.xr),ss.spatialPlayback=ms(),ss.spatialHEVC=!ss.browser.safari&&ms()&&ws(),ss.stereoscopic=ss.spatialPlayback&&ss.mobileAndroid;var Ps={captureException:function(t){},captureMessage:function(t){},captureBreadcrumb:function(){}},Cs=Ps,xs=function(t){Cs=Object.assign({},Ps,t)},Ls=function(t,n){return Cs.captureException(t,n)},Us=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"backbone",e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"info";return Cs.captureBreadcrumb(t,n,i,e)};function Fs(t,n,i){var e=t.embed.playsinline&&(ss.mobileAndroid||ss.iOS>=10),r=!1,o=!1,u=!1,s=!0;function a(t){if(!s&&i.buffered&&i.buffered.length>0){t=t||i.currentTime;var e=function(t,n){var i=t.length-1;if(t.length>1)for(var e=0,r=t.length;e<r;e++)if(t.start(e)<=n&&t.end(e)>=n){i=e;break}return i}(i.buffered,t),o=i.buffered.end(e),a=o/i.duration,c=i.duration;if(n.fire(Wi.PROGRESS,{loaded:o,duration:c,loadProgress:a}),u&&r&&o===i.duration)return void(r&&i.paused&&i.play().catch(Ls))}}function c(n){if("auto"!==n){var e=js(t,i).reverse().map((function(t){return t.quality})).indexOf(n);-1!==e&&(Us("Switched to ".concat(n),{},"video"),i.video.currentFile.restrictedStreamIndexes=[e])}else i.video.currentFile.restrictedStreamIndexes=[]}function h(e){var r=js(t,i).map((function(t){return t.quality})),o=Os(t,t.embed.quality,r);o&&n.fire(Lo,o),c(o||"auto")}return n.on(Po,(function(){i.playsinline=e,i.muted=t.embed.muted})),n.on(Ao,(function(){s=!0,i.paused||i.pause(),o=!1,r=!1,setTimeout((function(){i.currentTime=0}),300)})),i.on(Wi.PLAY,(function(){s=!1,n.fire(Wi.PLAY,i.currentTime)})),i.on(Wi.PAUSE,(function(){r=!1,n.fire(Wi.PAUSE,i.currentTime,i.ended)})),i.on(Wi.PLAYING,(function(t){a()})),i.on(Wi.TIME_UPDATE,(function(t){var e=i.currentTime;if(!s){var r=i.duration,o=e/r,u=i.playbackRate;n.fire(Wi.TIME_UPDATE,{currentTime:e,duration:r,timeProgress:o,playbackRate:u})}})),i.on(Wi.ENDED,(function(t){i.loop?i.play().catch(Ls):(r=!1,n.fire(Wi.ENDED,t))})),i.on(Wi.LOADED_METADATA,(function(n){var e=i.duration;if(isFinite(e)&&e>0){if(e<t.video.duration-1||e>t.video.duration+1)return;t.video.duration=e}t.video.video_width=i.videoWidth,t.video.video_height=i.videoHeight})),i.on(Wi.DURATION_CHANGE,(function(n){var e=i.duration;isFinite(e)&&(t.video.duration>0&&(e<t.video.duration-1||e>t.video.duration+1)||(t.video.duration=e))})),i.on(Wi.PROGRESS,a),i.on(Yi.BUFFER_STARTED,(function(){u=!0})),i.on(Yi.BUFFER_ENDED,(function(){u=!1})),n.on(ko,(function(n,e){e||(e=(i.duration||t.video.duration)*ys(n,0,1)),e=ys(e,0,i.duration||t.video.duration),i.currentTime=e})),i.on(Wi.SEEKING,(function(){var t=i.currentTime,e=i.duration,r=t/e;n.fire(Wi.SEEKING,{currentTime:t,duration:e,timeProgress:r})})),i.on(Wi.SEEKED,(function(){a();var t=i.currentTime,e=i.duration,r=t/e;n.fire(Wi.SEEKED,{currentTime:t,duration:e,timeProgress:r})})),n.on(Ro,(function(e){var r=i.video.currentFile.mime;if([Yo.dash,Yo.dashMpd,Yo.hlsLive].includes(r))c(e);else{var o=js(t,i).filter((function(t){return t.metadata.quality===e}));o.length>0&&(s=!0,i.video.currentFile=o[0])}n.fire(xo,e)})),i.on(Yi.CURRENT_FILE_CHANGE,(function(e){Us("Current file changed",{id:e.id,mime:e.mime,src:e.src,metadata:e.metadata},"video");var r=e.metadata.quality;[Yo.dash,Yo.dashMpd].includes(e.mime)&&h(),[Yo.hlsLive].includes(e.mime)?i.once(Yi.STREAMS_LOADED,(function(){h()})):function(i){var e=Rs(t);e&&n.fire(Lo,e)}(),n.fire(xo,r)})),{play:function(){return r=!0,o||(n.fire(Co),o=!0),i.play()},pause:function(){r=!1,i.pause()}}}function Hs(t,n,i){var e=!1,r=i.presentationMode;function o(){!i.supportsPresentationMode("picture-in-picture")||ss.spatialPlayback&&t.video.spatial?n.fire(Bo):n.fire(Vo)}i.on(Wi.LOADED_METADATA,(function(){e=!0})),i.on(Wi.PLAY,(function(){e?o():i.once(Wi.LOADED_METADATA,o)})),i.on(Yi.PRESENTATION_MODE_CHANGE,(function(t){"inline"===r&&"picture-in-picture"===t&&n.fire($o),"picture-in-picture"===r&&"inline"===t&&n.fire(Wo),r=t,i.video.textTracks.forEach((function(n){"picture-in-picture"===t&&"hidden"===n.mode&&(n.mode="showing"),"inline"===t&&"showing"===n.mode&&(n.mode="hidden")}))})),n.on(Io,(function(){i.supportsPresentationMode("picture-in-picture")&&(i.presentationMode="picture-in-picture")})),n.on(Do,(function(){i.supportsPresentationMode("picture-in-picture")&&(i.presentationMode="inline")}))}function Vs(t,n,i){var e=null;ss.spatialPlayback&&(n.on(Po,(function(){e&&(i.deactivateEffect(ro),e=null,n.fire(Ho,e));var r=t.video.spatial;r&&(t.request.drm||i.supportsEffect(ro)&&(e=i.activateEffect(ro,{threeUrl:t.request.urls.three_js,fps:t.video.fps,fieldOfView:r.fov,directorTimeline:r.director_timeline,projection:r.projection,stereoMode:r.stereo_mode,initialView:r.initial_view,isMobile:ss.android,dimensions:t.embed.on_site?{width:1080,height:540}:{width:640,height:360}}),n.fire(Ho,e)))})),i.on(zi.SPATIAL_UNSUPPORTED,(function(){e&&(i.deactivateEffect(ro),e=null,n.fire(Ho,e))})))}function Bs(t,n,i){var e=null;n.on(Po,(function(){e&&(i.deactivateEffect(Zr),e=null),t.video.canvas&&(t.request.drm||i.supportsEffect(Zr)&&(e=i.activateEffect(Zr)))}))}var $s=Hi((function(t,n,i){Ui(t,n,i)}));function Ws(t,n,i){return i?n?n(t):t:(t&&t.then||(t=s.resolve(t)),n?t.then(n):t)}var qs=function(){function t(t,n,i){Wt(this),this.ms=Uu(t),this.ys=t.session_url||t.sessionUrl,this.bs=n,this.Es=i,this._s=!1,this.Ts=!1,this.ks()}var n=t.prototype;return n.disable=function(){this.Ts=!0},n.forcePolling=function(){this.isForcePolling||(this._s=!0,this.ks())},n.unforcePolling=function(){this._s=!1},n.ks=function(){!1!==this.ms.polling&&(this.As()?this.Ss():this.Rs()&&this.Os())},n.Rs=function(){var t;return!(Zo(this.ms)&&"started"!==(null==(t=this.ms.archive)?void 0:t.status)||!this.isForcePolling&&Qo(this.ms))},n.As=function(){return!this.ys||!(!Jo(this.ms)||null!==this.ms.id)},n.Ms=function(){try{var t=this;return Ws(Pt(t.bs).json(),(function(n){return t.ys=n.url,n.url}))}catch(t){return s.reject(t)}},n.Os=function(){try{var t=this;if(t.Ts)return;var n,i={};return ss.browser.ie&&(i={Pragma:"no-cache","Cache-Control":"no-cache"}),function(t,n){return t&&t.then?t.then(n):n()}(function(r,o){try{var u=Ws(Pt({url:t.ys,retry:3,retryStatus:function(t){return[410].includes(t)||e.retryStatus(t)},hooks:{beforeRetry:[t.xt.bind(t)]},headers:i}).json(),(function(t){n=t}))}catch(t){return o()}return u&&u.then?u.then(void 0,o):u}(0,(function(){throw new Error("Hit max retries polling ".concat(t.ys))})),(function(i){if(n.status!==t.ms.status){var e;if(Zo(n)&&"provision_expire"===n.terminate_reason)return;var r=(q(e={},"active",zo.EVENT_ACTIVE),q(e,"pending",zo.EVENT_PENDING),q(e,"started",zo.EVENT_STARTED),q(e,"ended",zo.EVENT_ENDED),e)[n.status];try{t.fire(r,n)}catch(t){throw new Error("Error firing live event status change ".concat(t))}}if(n.archive&&(!t.ms.archive||n.archive.status!==t.ms.archive.status)){var o,u=(q(o={},"started",zo.ARCHIVE_STARTED),q(o,"done",zo.ARCHIVE_DONE),q(o,"error",zo.ARCHIVE_ERROR),o)[n.archive.status];t.fire(u,n)}t.ms=$s(t.ms,n),t.Rs()&&setTimeout(t.Os.bind(t),5e3)}))}catch(t){return s.reject(t)}},n.xt=function(t,n){try{return Ws(this.Ms(),(function(n){t.url=n}))}catch(t){return s.reject(t)}},n.Ss=function(){try{var t=this;if(t.Ts)return;return Ws(Pt(t.Es).json(),(function(n){var i=!1;return function(e,r){var o=function(){if(null!==n.ingest.session_id)return t.ms.id=n.ingest.session_id,Ws(t.Ms(),(function(){t.Os(),i=!0}))}();return o&&o.then?o.then(r):r(o)}(0,(function(n){if(i)return n;setTimeout(t.Ss.bind(t),5e3)}))}))}catch(t){return s.reject(t)}},W(t,[{key:"isForcePolling",get:function(){return this._s}}]),t}();function Gs(){}function Ys(t,n,i){var e,r,o=function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return s.resolve(t.apply(this,n))}catch(t){return s.reject(t)}}}((function(t){return function(t){if(t&&t.then)return t.then(Gs)}(function(n,e){try{var o=function(t,n,i){return t&&t.then||(t=s.resolve(t)),n?t.then(n):t}(at("module/streamroot.js"),(function(n){r=n(i,{TelecineEvents:Yi,VideoEvents:Wi},t)}))}catch(t){return}return o&&o.then?o.then(void 0,e):o}(0,(function(t){})))}));function u(){i.endLive()}n.on(jo,(function(){r&&r.destroy(),t.video.p2p&&(o(t.video.p2p),i.bufferTarget=30,i.presentationDelay=30),e&&(e.disable(),e=null),t.video.live_event&&!Xo(t.video.live_event)&&function(i){(e=new qs(i,function(t){return nu(t,"/session/refresh")}(t),function(t){return"https://".concat(t.vimeo_url,"/live_event/status?clip_id=").concat(t.video.id)}(t))).on(zo.EVENT_ENDED,u),Object.keys(zo).forEach((function(t){var i=zo[t];e.on(i,(function(t){n.fire(i,t)}))}))}(t.video.live_event)})),n.on(So,(function(){e&&e.disable()})),i.on(zo.STREAM_ONLINE,(function(){e.isForcePolling&&e.unforcePolling()})),i.on(zo.STREAM_OFFLINE,(function(){e.isForcePolling||e.forcePolling()}))}function Ks(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t||"null"===t||0===n.length)return{track:null};var i=t.split("."),e=nt(i,2),r=e[0],o=e[1],u=r.split(/[-_]/),s=nt(u,1),a=s[0],c=r!==a,h=n.filter((function(t){return c&&t.language===r||t.language===a})).sort((function(t,n){var i=2*(t.language===a&&t.kind===o)+2*(t.language===r)+1*(t.kind===o);return 2*(n.language===a&&n.kind===o)+2*(n.language===r)+1*(n.kind===o)-i}));return h.length>0?{track:h[0],exactMatch:h[0].language===r&&h[0].kind===o}:{track:null}}function zs(t,n,i){var e;function r(){if(0!==n.video.textTracks.length){if(n.video.textTracks.forEach((function(t){t.on("cuechange",o),t.on("modechange",u)})),n.video.textTracks.language&&nt(n.video.textTracks.language.split(/[-_]/),1)[0]!=nt(n.video.textTracks.language.split(/[-_]/),1)[0]){var i="".concat(n.video.textTracks.language,".subtitles");if(Ks(i,n.video.textTracks).track)return void t.fire(Oo,i)}t.fire(Mo)}else t.fire(Mo)}function o(n){for(var i,e=n.target,r=e.activeCues,o=[],u=0,s=r.length;u<s;u++)""!==r[u].text.replace(/^\s+|\s+$/gm,"")&&((i=document.createElement("span")).appendChild(r[u].getCueAsHTML()),o.push({html:i.innerHTML.replace("\n","<br>"),text:r[u].text}));t.fire(Uo,e,o)}function u(n){var e=n.target,r=i.querySelector("video");ss.iOS&&function(t){var n=[document.fullscreenElement,document.webkitFullscreenElement,document.webkitCurrentFullScreenElement,document.mozFullScreenElement,document.msFullscreenElement].find((function(t){return void 0!==t}));return void 0!==n?!!n:t.webkitDisplayingFullscreen}(r)&&"showing"===e.mode&&t.fire(Fo,e)}t.on(Po,r),t.on(Oo,(function(i){if(!e||e.id!==i){var r=n.video.textTracks.getTrackById(i),o=!0;if(!r){var u=Ks(i,n.video.textTracks);r=u.track,o=u.exactMatch}r!==e&&setTimeout((function(){n.video&&n.video.textTracks.forEach((function(t){t.mode=t===r?"hidden":"disabled"})),t.fire(Fo,r,!o),e=r}),0)}})),t.on(Mo,(function(){setTimeout((function(){n.video&&n.video.textTracks.forEach((function(t){t.mode="disabled"})),t.fire(Uo),e&&(e=null,t.fire(Fo,null))}),0)})),t.on(Yi.TEXT_TRACKS_AVAILABLE,r)}function Xs(t,n,i){var e,r;return e=new Qr(i,[br,Pr,Lr,Xe],{externalDisplays:[AirPlayExternalDisplay],mediaSourceScanner:{droppedFrameSwitchPercent:Ns(t)},tests:t.request.ab_tests,fileCodecs:t.request.file_codecs,bufferTarget:t.video.buffer_target,presentationDelay:t.video.presentation_delay}),Object.values(Wi).filter((function(t){return![Wi.TIME_UPDATE,Wi.PROGRESS,Wi.SUSPEND,Wi.ERROR].includes(t)})).forEach((function(t){e.on(t,(function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Us(t,n,"video event")}))})),e.on(Yi.STREAMS_LOADED,(function(n){n.video.forEach((function(n){var i=function(t,n){return n.find((function(n){return _s(n.id)===String(t)||_s(n.id)===_s(t)}))}(n.id,js(t,e));i?(n.profile=i.profile,n.quality=i.quality,n.fps=i.fps):(n.profile=null,n.quality="".concat(n.height,"p"),n.fps=n.framerate)}))})),e.on(Yi.STREAM_CHANGE,(function(t){var i=t.index,e=t.streams,r=e[i];Us("Stream changed",r,"video"),n.fire(Yi.STREAM_CHANGE,r,i,e)})),e.on(Yi.STREAM_TARGET_CHANGE,(function(t){var i=t.index,e=t.streams,r=e[i];n.fire(Yi.STREAM_TARGET_CHANGE,r,i,e)})),function(t,n,i){i.forEach((function(i){t(i,(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];n.apply(void 0,[i].concat(e))}))}))}(e.on,n.fire,[qi.ACTIVATED,qi.AVAILABLE,qi.DEACTIVATED,qi.UNAVAILABLE,Ki.STREAM_OFFLINE,Ki.STREAM_ONLINE,Xi.MEDIASESSION_PAUSE,Xi.MEDIASESSION_PLAY,Xi.MEDIASESSION_SEEK_BACKWARD,Xi.MEDIASESSION_SEEK_FORWARD,Yi.AV_DURATION_MISMATCH,Yi.BANDWIDTH,Yi.BUFFER_ENDED,Yi.BUFFER_OCCUPANCY,Yi.BUFFER_STARTED,Yi.CHAPTER_CUES_UPDATED,Yi.CUE_POINT,Yi.CURRENT_FILE_CHANGE,Yi.DOWNLOAD_END,Yi.DOWNLOAD_TIMEOUT,Yi.DRM_AUTH_SUCCESS,Yi.DROPPED_FRAMES,Yi.MANIFEST_LOADED,Yi.MANIFEST_TIMEOUT,Yi.QUOTA_EXCEEDED_ERROR,Yi.SCANNER_CHANGE,Yi.STREAM_CHANGE_START,Yi.STREAM_BUFFER_END,Yi.STREAM_BUFFER_START,Yi.TEXT_TRACKS_AVAILABLE,zi.CAMERA_UPDATE,zi.MOTION_END,zi.MOTION_START,zi.SPATIAL_UNSUPPORTED,zi.WEBVR_ENTER,zi.WEBVR_EXIT,zi.WEBVR_HARDWARE_AVAILABLE,Ji.BRAIN_ML_SWITCH_TO_SKYFIRE,Ji.BRAIN_ML_MODEL_INPUTS,Wi.DURATION_CHANGE,Wi.ERROR,Wi.LOAD_START,Wi.LOADED_DATA,Wi.LOADED_METADATA,Wi.PLAYING,Wi.RATE_CHANGE,Wi.STALLED,Wi.VOLUME_CHANGE,Wi.WAITING]),n.fire(No),new zs(n,e,i),new Hs(t,n,e),new Vs(t,n,e),new Bs(t,n,e),new Ys(t,n,e),r=new Fs(t,n,e),n.on(jo,(function(){var r=t.video.live_event;if(Jo(r)||function(t){return"active"===(null==t?void 0:t.status)}(r)||Zo(r)&&!Xo(r))e.video=null;else if(!Qo(r)||!e.video||t.isNewVideo()){var o=Qo(r)?function(t){var n=[],i=Ds(t);i&&n.push(i);var e=function(t){var n,i=t.video.live_event,e=t.request.files;if(mu(e.dash))return null;var r=e.dash.default_cdn,o=e.dash.cdns[r].url||(null==(n=i.playback)?void 0:n.dash_noredirect),u=t.request.flags.live_dash?2:1;return{id:"dash-".concat(r,"-").concat(t.video.id),src:o,mime:Yo.dashMpd,priority:u,metadata:{cdn:r,origin:e.dash.cdns[r].origin,quality:"sd"}}}(t);return e&&n.push(e),n}(t):function(t){var n=t.request.files,i=Es(n),e=Rs(t),r=t.request.cookie.quality||e||function(t){var n=Es(t.request.files),i=n.some(As);ss.mobileAndroid&&(i=!1);var e="720p";if(i){var r=n.map(bs);-1!==r.indexOf("1080p")&&-1===r.indexOf("720p")&&(e="1080p")}return t.request.cookie.hd||t.video.default_to_hd?e:"360p"}(t),o=function(t){var n=t.files,i=void 0===n?[]:n,e=t.preference,r=void 0===e?"360p":e,o=t.priorityOffset,u=void 0===o?0:o;(i=V(i)).sort(Ms());var s=i.map(bs);if(r){-1===s.indexOf(r)&&(s.push(r),s.sort((function(t,n){return Ss(n)-Ss(t)})));var a=s.indexOf(r),c=s.splice(0,a);c.reverse(),s.push.apply(s,it(c))}return i.map((function(t){return{id:t.id,src:t.url,mime:t.mime,priority:s.indexOf(t.quality)+1+u,metadata:{profile:t.profile,cdn:t.cdn,origin:t.origin,quality:t.quality,fps:t.fps}}}))}({files:i,preference:r,priorityOffset:2}),u=t.request.drm&&ss.browser.safari;return(n.hls&&(ss.iPhone||ss.iPad)||u)&&(o=o.concat(function(t){var n=t.request.files,i=n.hls.default_cdn,e=t.request.drm,r=gs(n.hls.cdns[i],t.video.spatial,e);return{id:"hls-".concat(i,"-").concat(t.video.id),src:r,mime:Yo.hls,priority:2,metadata:{cdn:i,origin:n.hls.cdns[i].origin,quality:"sd"}}}(t))),n.dash&&!u&&(o=o.concat(function(t){var n=t.request.files;return mu(n.dash)?[]:Object.keys(n.dash.cdns).map((function(i){var e=gs(n.dash.cdns[i],t.video.spatial);return{id:"dash-".concat(i,"-").concat(t.video.id),src:e,mime:t.request.drm?Yo.dashMpd:Yo.dash,priority:i===n.dash.default_cdn?1:2,metadata:{cdn:i,origin:n.dash.cdns[i].origin,quality:"sd"}}}))}(t))),o}(t),u=function(t){return t.request.text_tracks.map((function(t){return{id:t.id,src:t.url,kind:t.kind,label:t.label,language:t.lang}}))}(t);!e.video||t.isNewVideo()?function(r,o){var u=t.video.live_event,s=i.getBoundingClientRect(),a=Qo(u)?Ds(t):function(t){var n=t.request.files;if(!mu(n.hls)){var i=n.hls.default_cdn,e=n.hls.cdns[i],r=e.captions||e.avc_url;return r?{src:r,mime:Yo.hls,metadata:{cdn:i,origin:e.origin,quality:"sd"}}:null}return null}(t);e.video={id:t.video.id,title:t.video.title,subtitle:"from ".concat(t.video.owner.name),files:r,textTracks:o,chapters:Ku(t,"embed.chapters",[]),duration:t.video.duration,externalDisplayFiles:{AirPlay:a},metadata:{playlistRefreshUrl:tu(t),thumbnail:t.video.thumbs[640],useHls:t.request.drm&&ss.browser.safari,drm:t.request.drm,p2p:t.video.p2p,percentShown:ro.frustumSurfaceArea(t.video.spatial.fov,s.width,s.height)}},n.fire(Po)}(o,u):function(t,n){t.forEach((function(t){var n=e.video.files.getFileById(t.id);n&&n.src!==t.src&&(n.src=t.src)})),n.forEach((function(t){var n=e.video.textTracks.getTrackById(t.id);n&&n.src!==t.src&&(n.src=t.src)}))}(o,u)}})),{telecine:e,play:function(){return r.play()},pause:function(){return r.pause()}}}function Js(t,n,i){this.constructorName="BackboneError",this.message=t,this.name=n,this.source=i}Js.prototype=new Error;var Qs={embed:{},request:{cookie:{},files:{},flags:{},urls:{},text_tracks:[],file_codecs:{}},video:{owner:{},thumbs:{},version:{}},user:{}};function Zs(t,n){var i,e,r,o=Wt(),u=null,s=new Hu(n,Qs);function a(t){return o.fire(jo,t),t}var c={play:function(){return e.play()},pause:function(){return e.pause()},get currentTime(){return r.currentTime>.1?Eo(r.currentTime):0},set currentTime(t){if(t=parseFloat(t),isNaN(t)||t<0)throw new Js("Seconds must be a positive number less than the duration of the video.","RangeError","setCurrentTime");o.fire(ko,null,t)},get duration(){return Eo(s.video.duration)},get enabledTextTrack(){return u},loadVideo:function(t){return s.reset(t),s=a(s),this},unload:function(){return o.fire(Ao),this},destroy:function(){return o.fire(So),this},on:function(t,n){return o.on(t,n),this},once:function(t,n){return o.once(t,n),this},off:function(t,n){return o.off(t,n),this},hasTextTrack:function(t){var n,i,e=this.textTracks;if(go(t))i=e.getTrackById(t);else{var r=t.split(".")[0];n=e.some((function(t){return t.language.toLowerCase()===r.toLowerCase()}))}return!(!i&&!n)},enableTextTrack:function(t){var n,i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.textTracks;if(go(t))u=s.getTrackById(t);else{var a=t.split("."),c=nt(a,2);n=c[0];var h=c[1];if(i=void 0===h?e:h,!this.hasTextTrack(t))throw new Js("There are no tracks for “".concat(n.toUpperCase(),"”."),"InvalidTrackLanguageError","enableTextTrack");var f=i?"".concat(n,".").concat(i):n;u=Ks(f,s).track}if(!u||i&&u.kind!==i)throw new Js("There are no ".concat(i," tracks for “").concat(n.toUpperCase(),"”."),"InvalidTrackError","enableTextTrack");r.yu(!0),o.fire(Oo,u.id)},disableTextTrack:function(){u=null,r.yu(!1),o.fire(Mo)},set quality(t){o.fire(Ro,t)},get playbackRate(){return r?r.playbackRate:1},set playbackRate(t){r.playbackRate=t,r.defaultPlaybackRate=t},get presentationMode(){return r.presentationMode},set presentationMode(t){"picture-in-picture"===t?o.fire(Io):o.fire(Do)},get textTracks(){return r.video?r.video.textTracks:[]},get representations(){return js(s,r)},get volume(){return r?r.volume:Eo(s.request.cookie.volume)},set volume(t){if(t=parseFloat(t),isNaN(t)||t<0||t>1)throw new Js("Volume should be a number between 0 and 1.","RangeError","setVolume");r.volume=t},get videoId(){return s.video.id},get videoWidth(){return r.videoWidth||s.video.width},get videoHeight(){return r.videoHeight||s.video.height},get readyState(){return r.videoElement.readyState},get brainDebug(){return r.brainDebug}};return s=a(s),e=new Xs(s,o,t),r=e.telecine,i=Object.create(r),ut(i,c)}var ta={};function na(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((null==(t=ta.en)?void 0:t[n])&&(n=ta.en[n]),Object.keys(i).forEach((function(t){n=n.replace(new RegExp("{".concat(t,"}"),"g"),i[t])})),n.match(/\{\w+}/))throw new Error("Missing token definition.");return n}function ia(t){return function(t){return/^(https?:)?\/\/(.+)\.vimeo(ws)?\.(com|dev)(?=$|\/)/.test(t)}(t)?function(t){try{return new URL(t).origin}catch(t){}var n=document.createElement("a");return n.href=t,n.origin?n.origin:"".concat(n.protocol.replace(":",""),"://").concat(n.host)}(t):""}function ea(t,n,i){if(function(t){return/^(https?:)?\/\/(.+)\.vimeo(ws)?\.(com|dev)\/video\/\d+\/config(?=$|\?)/.test(t)}(n))return n;var e=function(t){if(function(t){return!isNaN(t)&&parseInt(Number(t),10)==t&&!isNaN(parseInt(t,10))}(t))return parseInt(t,10);var n=t.match(/(video|\.com|\.dev)\/(\d+)/);if(!n||n.length<3)throw new Error("Please provide a Vimeo URL with a valid clip id.");return parseInt(n[2],10)}(n),r=dt(window.location.search),o=dt("".concat(n).split("?")[1]),u=Object.assign(r,o,i);return vt("".concat(t,"/video/").concat(e,"/config"),u)}function ra(t,n){return-1!==V(n).indexOf(t)}function oa(t,n){return n&&0===n.indexOf(t)}!function(t){for(var n=this,i=function i(e){return e.length>=t.length?t.apply(n,e):function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i([].concat(it(e),n))}},e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];i(r)}((function(t,n){return Object.keys(t).every((function(i){return t[i]===n[i]}))})),function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];n.reduce((function(t,n){return function(){return t(n.apply(void 0,arguments))}}))}((function(t){return t?V(t.parentNode.children).indexOf(t):-1}),(function(t,n){for(;(null==(i=t)?void 0:i.parentElement)&&!ra(t,n);){var i;t=t.parentElement}return ra(t,n)?t:null}));var ua=0;function sa(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"p",n=++ua;return"".concat(t).concat(n)}function aa(t){var n=t;return!t||t instanceof Error||(n=new Error(t.message||t),t.name&&(n.name=t.name)),n}sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa(),sa();var ca={Is:sa(),Ds:sa(),Ns:sa(),Ps:sa(),Ie:sa(),Cs:sa(),xs:sa(),Ls:sa(),Us:sa(),Fs:sa(),Hs:sa(),Vs:sa(),Bs:sa(),$s:sa(),Ws:sa(),qs:sa(),Gs:sa(),Ys:sa(),Ks:sa(),zs:sa(),Xs:sa(),Js:sa(),Qs:sa(),Zs:sa(),ta:sa(),na:sa(),ia:sa(),ea:sa(),ra:sa(),oa:sa(),sa:sa(),aa:sa(),ca:sa(),ha:sa(),fa:sa(),da:sa(),va:sa(),la:sa(),pa:sa(),wa:sa(),ma:sa(),ya:sa(),ba:sa(),ga:sa(),Ea:sa(),_a:sa(),Ta:sa(),ka:sa(),Aa:sa(),Sa:sa(),Ra:sa(),Oa:sa(),Ma:sa(),Ia:sa(),Da:sa(),ja:sa(),Na:sa(),Pa:sa(),Ca:sa(),xa:sa(),La:sa(),Ua:sa(),Fa:sa(),Ha:sa(),Va:sa(),Ba:sa(),$a:sa(),Wa:sa(),qa:sa(),Ga:sa(),Ya:sa(),Ka:sa(),za:sa(),Xa:sa(),Ja:sa(),Qa:sa(),Za:sa(),tc:sa(),nc:sa(),ic:sa(),ec:sa(),rc:sa(),oc:sa(),uc:sa(),sc:sa(),ac:sa(),cc:sa(),hc:sa(),fc:sa(),dc:sa(),vc:sa(),lc:sa(),pc:sa(),wc:sa(),mc:sa(),yc:sa(),bc:sa(),gc:sa(),Ec:sa(),_c:sa(),Tc:sa(),_loadVideo:sa(),kc:sa(),Ac:sa(),Sc:sa(),Rc:sa(),Oc:sa(),Mc:sa(),Ic:sa(),Dc:sa(),jc:sa(),Nc:sa(),Pc:sa(),Cc:sa(),xc:sa(),Lc:sa(),Uc:sa(),Fc:sa(),Hc:sa(),Vc:sa(),Bc:sa(),$c:sa(),Yi:sa(),Wc:sa(),qc:sa(),Gc:sa(),Yc:sa(),Kc:sa(),zc:sa(),Xc:sa(),Jc:sa(),Qc:sa(),Zc:sa(),th:sa(),nh:sa(),ih:sa(),eh:sa(),rh:sa(),oh:sa(),uh:sa()},ha=(sa(),sa(),sa(),sa(),7),fa=navigator.userAgent.toLowerCase();function da(t){t=t.toLowerCase();var n=new RegExp(t).test(fa);return"safari"===t?n&&new RegExp("version").test(fa):n}function va(t){var n=document.createElement("div"),i=t.charAt(0).toUpperCase()+t.slice(1),e=(t+" "+["Webkit","Moz","O","ms"].join(i+" ")+i).split(" ");for(var r in e){var o=e[r];if(void 0!==n.style[o])return o}return t}var la=!!da("android")&&(parseFloat(fa.replace(/^.* android (\d+)\.(\d+).*$/,"$1.$2"))||!0),pa=window.devicePixelRatio||1,wa=!(!da("windows phone")&&!da("iemobile"))&&(parseFloat(fa.replace(/^.* windows phone (os )?(\d+)\.(\d+).*$/,"$2.$3"))||!0),ma=!!da("msie")&&parseFloat(fa.replace(/^.*msie (\d+).*$/,"$1")),ya=!!da("trident")&&parseFloat(fa.replace(/^.*trident\/(\d+)\.(\d+).*$/,"$1.$2"))+4,ba=!!(da("ipad;")||da("iphone;")||da("ipod touch;"))&&parseFloat(fa.replace(/^.* os (\d+)_(\d+).*$/,"$1.$2")),ga=da("opera")||da("opr"),Ea=/^Mozilla\/5\.0 \(.* Mac OS X.*\(KHTML, like Gecko\)(?: Mobile\/[\S]*|)$/i.test(fa);function _a(){if(!da("safari"))return[];var t=fa.split(" ").find((function(t){return/version\//.test(t)}));return t?t.replace("version/","").split(".").map((function(t){return parseInt(t,10)})):[]}var Ta=da("safari")&&da("apple")&&!da("chrome")&&!da("android")&&_a()[0]>=11,ka={airPlay:"WebKitPlaybackTargetAvailabilityEvent"in window,android:la,appleMail:Ea,hasAutoplayPolicy:la||ba||Ta||function(){if(!da("chrome"))return[];var t=fa.split(" ").find((function(t){return ba?/CriOS\//.test(t):/chrome\//.test(t)}));return t?t.replace("chrome/","").split(".").map((function(t){return parseInt(t,10)})):[]}()[0]>=66,iOS:ba,mobileAndroid:la&&da("mobile"),browser:{bb10:da("bb10"),chrome:da("chrome"),firefox:da("firefox"),ie:ma||ya,edge:da("edge"),opera:ga,safari:da("safari")&&da("apple")&&!da("chrome")&&!da("android")},devicePixelRatio:pa,iPhone:da("iphone;")||da("ipod touch;")||da("ipod;"),iPad:da("ipad;"),iPadNonRetina:da("ipad;")&&pa<2,mac:da("mac os"),pointerEvents:window.navigator.pointerEnabled||window.navigator.msPointerEnabled||!1,svg:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||da("windows phone")||window.navigator.maxTouchPoints>1||window.navigator.msMaxTouchPoints||!1,transformProperty:va("transform"),transitionProperty:va("transition"),webp:function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))&&0===t.toDataURL("image/webp").indexOf("data:image/webp")}(),windowsPhone:wa},Aa=/mac os x 10_13/.test(fa),Sa=ka.iOS&&ka.iOS>=11,Ra=ka.iPhone&&812===window.screen.availHeight&&375===window.screen.availWidth,Oa=ka.iPhone&&896===window.screen.availHeight&&414===window.screen.availWidth,Ma=ka.iPad&&1112===window.screen.availWidth&&834===window.screen.availHeight,Ia=ka.iPad&&834===window.screen.availWidth&&1194===window.screen.availHeight,Da=ka.iPad&&1024===window.screen.availWidth&&1366===window.screen.availHeight,ja=Ra||Oa||Ma||Ia||Da;function Na(){return!!(Ta&&Aa||Ta&&Sa)||"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported('video/mp4; codecs="hvc1"')}function Pa(){return!(ka.iOS||ka.iPad||ka.browser.ie)&&(!da("safari")||_a()[0]>11||11===_a()[0]&&(_a()[2]>1||_a()[1]>0))}function Ca(t){return"dev"===t.request.build.js?"dev":"3.20.13"}ka.hevc=Na(),ka.hdr=Ta&&Sa&&ja,ka.vp9hdr=(window.matchMedia("(color-gamut: p3)").matches||window.matchMedia("(color-gamut: rec2020)").matches)&&screen.colorDepth>=48&&(MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.01"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.01"')),ka.av1="undefined"!=typeof MediaSource&&MediaSource.isTypeSupported('video/mp4; codecs="av01.0.31M.08.0.110.01.01.01.0"'),ka.webvr=!!(window.navigator&&"getVRDisplays"in window.navigator),ka.webxr=!!(window.navigator&&"xr"in window.navigator&&"supportsSession"in window.navigator.xr),ka.spatialPlayback=Pa(),ka.spatialHEVC=!ka.browser.safari&&Pa()&&Na(),ka.stereoscopic=ka.spatialPlayback&&ka.mobileAndroid,Y({},{VIDEO_BUFFER_END:"video-buffer-end",VIDEO_BUFFER_START:"video-buffer-start",VIDEO_ENDED:"video-ended",VIDEO_EXIT:"video-exit",VIDEO_LOAD_FAILURE:"video-load-failure",VIDEO_MINUTE_WATCHED:"video-minute-watched",VIDEO_PAUSED:"video-paused",VIDEO_PLAYED:"video-played",VIDEO_PLAYBACK_ERROR:"video-playback-error",VIDEO_READY:"video-ready",VIDEO_START_ATTEMPT:"video-start-attempt",VIDEO_START_FAILURE:"video-start-failure",VIDEO_START_TIME:"video-start-time",VIDEO_SEEK:"video-seek",VIDEO_SEEKED:"video-seeked",CHUNK_DOWNLOADED:"chunk_downloaded"},{ALERT_DISPLAYED:"alert-displayed",ALERT_HIDDEN:"alert-hidden",CAPTIONS_ENABLED:"captions-enabled",CAPTIONS_DISABLED:"captions-disabled",CHROMECAST_CONNECTED:"chromecast-connected",CHROMECAST_DISCONNECTED:"chromecast-disconnected",ERROR_LINK_PRESSED:"error-link-pressed",MEDIASESSION_PLAY:"mediasession-play",MEDIASESSION_PAUSE:"mediasession-pause",MEDIASESSION_SEEK_FORWARD:"mediasession-seekforward",MEDIASESSION_SEEK_BACKWARD:"mediasession-seekbackward",SLATE_DISPLAYED:"slate-displayed",CLICK:"click",VIDEO_DURATION_MISMATCH:"video-duration-mismatch",VIDEO_FULLSCREEN_CHANGE:"video-fullscreen-change",VIDEO_MANIFEST_LOADED:"video-manifest-loaded",VIDEO_MANIFEST_TIMEOUT:"video-manifest-timeout",VIDEO_PLAYBACK_RATE_CHANGED:"video-playback-rate-changed",VIDEO_STREAM_CHANGE:"video-stream-change",VIDEO_SWITCH_BACK_TO_AUTO:"video-switch-back-to-auto",VIDEO_SWITCH_FROM_AUTO:"video-switch-from-auto",DOWNLOAD_TIMEOUT:"video-download-timeout",AD_BUFFERING:"ad-buffering",AD_COMPLETE:"ad-complete",AD_CLICKED:"ad-clicked",AD_ERROR:"ad-error",AD_PAUSED:"ad-paused",AD_RESUMED:"ad-resumed",AD_STARTED:"ad-started",AD_SKIPPED:"ad-skipped",OUTRO_VIDEO_SELECTED:"outro-video-selected",WEBVR_HARDWARE_AVAILABLE:"webvr-hardware-available",ENTER_WEBVR:"enter-webvr",EXIT_WEBVR:"exit-webvr"});var xa,La=new s((function(t){xa=t}));function Ua(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return La.then((function(e){return i/=.1,Math.random()<=i&&e.captureException(aa(t),n),e.lastEventId()}))}window.addEventListener("unhandledrejection",(function(t){t.preventDefault(),t.reason&&Ua(t.reason).catch((function(t){}))}));var Fa={setUp:function(t){t.config.request.sentry.enabled&&at("module/sentry.js").then((function(n){var i="dev"===t.config.request.build.js?"dev":"production",e=[new n.Integrations.Dedupe,new n.Integrations.ExtraErrorData,new n.Integrations.Breadcrumbs({console:!1}),new n.Integrations.GlobalHandlers({onunhandledrejection:!1})];return n.init({dsn:t.config.request.sentry.url,release:Ca(t.config),environment:i,integrations:e,ignoreErrors:["NotAllowedError","AbortError","PlayInterrupted","Failed to load image"],blacklistUrls:[/^moz-extension/i,/^chrome-extension/i],beforeSend:function(i,e){var r;if(!t.config.request)return null;if(ka.appleMail)return null;if(oa("ReportingObserver",i.message)&&Math.random()>.01)return null;var o=null==(r=e.originalException)?void 0:r.error;return oa("Non-Error exception captured",i.message)&&o?(n.withScope((function(t){t.setExtra("nonErrorException",!0),n.captureException(o)})),null):(i.tags["document.visibilityState"]=document.visibilityState,t.config.request.sentry.enabled?i:null)}}),n.configureScope((function(n){if(n.setTag("session",t.config.request.session),n.setTag("locale",t.config.request.lang),n.setTag("debug_intent",t.config.request.sentry.debug_intent?1:0),n.setTag("product",function(t){return t.config.video.p2p?"vimeo-live-ecdn":t.config.request.flags.ott?"vimeo-ott-vod":t.config.video.live_event?"vimeo-live":t.config.embed.context&&-1!==t.config.embed.context.indexOf("Stock")?"vimeo-stock-vod":t.config.video.vod?"vimeo-ondemand":"vimeo-vod"}(t)),n.setTag("backend",t.config.request.build.backend),n.setTag("video_embed_permission",t.config.video.embed_permission),n.setTag("video_privacy",t.config.video.privacy),t.config.user.logged_in&&n.setUser({id:t.config.user.id}),t.config.request.ab_tests)for(var i in t.config.request.ab_tests){var e=t.config.request.ab_tests[i];for(var r in n.setTag("".concat(i,"_test"),1),n.setTag("".concat(i,"_group"),e.group),e.data)n.setTag("".concat(i,"_data_").concat(r),e.data[r])}})),t.config.request.sentry.debug_intent&&window.addEventListener("unload",(function(){n.captureMessage("Session debug",{level:"info"})}),!1),n})).then(xa).catch((function(t){}))},captureException:Ua,captureMessage:function(t,n){return La.then((function(i){return i.captureMessage(t,n),i.lastEventId()}))},captureBreadcrumb:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"player",e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"info";return La.then((function(r){return r.addBreadcrumb({message:t,data:n,category:i,level:e})}))}};function Ha(t){var n=t.events,i=null,e=null,r=null,o=null,u=null,a={video:{},request:{},embed:{}};function c(){return e&&e-6e4<=Date.now()}function h(t){var n=Date.now()+1e3*t;return u=setTimeout((function(){"onLine"in navigator&&!navigator.onLine||o||(o=d().catch(Fa.captureException))}),1e3*t-6e4-5e3),n}function f(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};clearTimeout(u);var o=i;if(isNaN(t)&&"string"!=typeof t)return e=h((i=t).request.expires),s.resolve({old:o,loaded:i});Date.now();var c=(a=$s(a,i)).request.referrer;c&&(r.referrer=c);var f=(null==(n=i)?void 0:n.player_url)?"https://".concat(i.player_url):"",d=ia(t)||f,v=ea(d,t,r);return Pt(v,{withCredentials:!0,throwHttpErrors:!1}).json().then((function(t){return(i=t).view!==ha&&(e=h(i.request.expires),a.request.session&&i.video.id===a.video.id&&(i.request.session=a.request.session),c&&(i.request.referrer=c),a.embed.player_id&&(i.embed.player_id=a.embed.player_id),a.embed.on_site&&(i.embed.on_site=1,i.embed.context=a.embed.context)),Date.now(),{old:o,loaded:i}})).catch((function(t){Fa.captureException(t)}))}function d(){var t;clearTimeout(u),Date.now();var r=null==(t=i)?void 0:t.request.referrer,s=i.request,a=s.signature,c=s.session,f=s.timestamp,d=s.expires,v=i.request.ott_chromecast_token,l="https://".concat(i.player_url,"/video/").concat(i.video.id,"/config/request?session=").concat(c,"&signature=").concat(a,"&time=").concat(f,"&expires=").concat(d);return v&&(l="".concat(l,"&ott_chromecast_token=").concat(v)),r&&(l+="".concat(-1===l.indexOf("?")?"?":"&","referrer=").concat(encodeURIComponent(r))),Pt(l,{withCredentials:!0,retry:3}).json().then((function(t){return i.request=t,r&&(i.request.referrer=r),e=h(i.request.expires),Date.now(),o=null,n.fire(ca.lc),i.request})).catch((function(t){var i={id:"network",title:na("Network error"),message:na("A network hiccup interrupted playback. Please {linkStart}reload the player{linkEnd} and try again.",{linkStart:'<a href="javascript:window.location.reload()" rel="noopener">',linkEnd:"</a>"}),final:!0};throw n.fire(ca.Ds,i.id,i),t}))}return window.addEventListener("online",(function(){c()&&(o=d().catch(Fa.captureException))})),n.on(ca.Ds,(function(t){o||"media-url-expired"!==t||(o=d().catch(Fa.captureException))})),{get isExpired(){return c()},load:function(t,n){return f(t,n)},reload:function(){var t;return(null==(t=i)?void 0:t.video.id)?f(i.video.id):s.reject(new Error("No config loaded."))},toJSON:function(){return i},get config(){return i},set config(t){i=t},verify:function(){return c()?(o||(o=d()),o):s.resolve(i.request)},get F(){return r},set F(t){r=t}}}t.BarebonePlayer=function(t,n){xs(Fa);var i=null,e=document.createElement("style");e.setAttribute("type","text/css"),e.textContent="\n    .vp-telecine video {\n        width: 100%;\n        height: auto;\n    }\n",t.appendChild(e);var r=document.createElement("div");r.className="vp-video-wrapper";var o=document.createElement("div");o.className="vp-video";var u=document.createElement("div");u.className="vp-telecine",o.appendChild(u),r.appendChild(o),t.appendChild(r);var s=new Ha({events:Wt()});return s.load(n).then((function(){return(i=new Zs(u,s.config)).loadVideo(s.config),i}))},t.requestModule=$t}(this.window=this.window||{});

